=== GPU Information ===
Sun Sep 14 18:27:10 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 575.57.08              Driver Version: 575.57.08      CUDA Version: 12.9     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA A10                     Off |   00000000:07:00.0 Off |                    0 |
|  0%   29C    P8             15W /  150W |       0MiB /  23028MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI              PID   Type   Process name                        GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+
=== Memory Information ===
               total        used        free      shared  buff/cache   available
Mem:           503Gi        30Gi       468Gi        14Gi        22Gi       472Gi
Swap:             0B          0B          0B
=== Current Directory ===
/u/nalint2/scratch/Bayesian-LORA
=== Python Version ===
Python 3.9.18
=== Setting up environment ===
=== Upgrading pip to fix version issues ===
Requirement already satisfied: pip in ./.venv/lib/python3.9/site-packages (25.2)
=== Installing dependencies ===
Installing package in editable mode...
Obtaining file:///scratch/nalint2/Bayesian-LORA
  Installing build dependencies: started
  Installing build dependencies: finished with status 'done'
  Checking if build backend supports build_editable: started
  Checking if build backend supports build_editable: finished with status 'done'
  Getting requirements to build editable: started
  Getting requirements to build editable: finished with status 'done'
  Preparing editable metadata (pyproject.toml): started
  Preparing editable metadata (pyproject.toml): finished with status 'done'
Requirement already satisfied: torch>=2.0.0 in ./.venv/lib/python3.9/site-packages (from Bayesian-LORA==0.1.0) (2.8.0)
Requirement already satisfied: torchvision in ./.venv/lib/python3.9/site-packages (from Bayesian-LORA==0.1.0) (0.23.0)
Requirement already satisfied: numpy in ./.venv/lib/python3.9/site-packages (from Bayesian-LORA==0.1.0) (2.0.2)
Requirement already satisfied: tqdm in ./.venv/lib/python3.9/site-packages (from Bayesian-LORA==0.1.0) (4.67.1)
Requirement already satisfied: pyyaml in ./.venv/lib/python3.9/site-packages (from Bayesian-LORA==0.1.0) (6.0.2)
Requirement already satisfied: scikit-learn in ./.venv/lib/python3.9/site-packages (from Bayesian-LORA==0.1.0) (1.6.1)
Requirement already satisfied: scipy in ./.venv/lib/python3.9/site-packages (from Bayesian-LORA==0.1.0) (1.13.1)
Requirement already satisfied: matplotlib in ./.venv/lib/python3.9/site-packages (from Bayesian-LORA==0.1.0) (3.9.4)
Requirement already satisfied: transformers>=4.30.0 in ./.venv/lib/python3.9/site-packages (from Bayesian-LORA==0.1.0) (4.56.0)
Requirement already satisfied: datasets>=2.12.0 in ./.venv/lib/python3.9/site-packages (from Bayesian-LORA==0.1.0) (4.0.0)
Requirement already satisfied: tokenizers>=0.13.0 in ./.venv/lib/python3.9/site-packages (from Bayesian-LORA==0.1.0) (0.22.0)
Requirement already satisfied: peft>=0.4.0 in ./.venv/lib/python3.9/site-packages (from Bayesian-LORA==0.1.0) (0.17.1)
Requirement already satisfied: accelerate>=0.20.0 in ./.venv/lib/python3.9/site-packages (from Bayesian-LORA==0.1.0) (1.10.1)
Requirement already satisfied: sentencepiece in ./.venv/lib/python3.9/site-packages (from Bayesian-LORA==0.1.0) (0.2.1)
Requirement already satisfied: protobuf in ./.venv/lib/python3.9/site-packages (from Bayesian-LORA==0.1.0) (6.32.0)
Requirement already satisfied: packaging>=20.0 in ./.venv/lib/python3.9/site-packages (from accelerate>=0.20.0->Bayesian-LORA==0.1.0) (25.0)
Requirement already satisfied: psutil in ./.venv/lib/python3.9/site-packages (from accelerate>=0.20.0->Bayesian-LORA==0.1.0) (7.0.0)
Requirement already satisfied: huggingface_hub>=0.21.0 in ./.venv/lib/python3.9/site-packages (from accelerate>=0.20.0->Bayesian-LORA==0.1.0) (0.34.4)
Requirement already satisfied: safetensors>=0.4.3 in ./.venv/lib/python3.9/site-packages (from accelerate>=0.20.0->Bayesian-LORA==0.1.0) (0.6.2)
Requirement already satisfied: filelock in ./.venv/lib/python3.9/site-packages (from datasets>=2.12.0->Bayesian-LORA==0.1.0) (3.19.1)
Requirement already satisfied: pyarrow>=15.0.0 in ./.venv/lib/python3.9/site-packages (from datasets>=2.12.0->Bayesian-LORA==0.1.0) (21.0.0)
Requirement already satisfied: dill<0.3.9,>=0.3.0 in ./.venv/lib/python3.9/site-packages (from datasets>=2.12.0->Bayesian-LORA==0.1.0) (0.3.8)
Requirement already satisfied: pandas in ./.venv/lib/python3.9/site-packages (from datasets>=2.12.0->Bayesian-LORA==0.1.0) (2.3.2)
Requirement already satisfied: requests>=2.32.2 in ./.venv/lib/python3.9/site-packages (from datasets>=2.12.0->Bayesian-LORA==0.1.0) (2.32.5)
Requirement already satisfied: xxhash in ./.venv/lib/python3.9/site-packages (from datasets>=2.12.0->Bayesian-LORA==0.1.0) (3.5.0)
Requirement already satisfied: multiprocess<0.70.17 in ./.venv/lib/python3.9/site-packages (from datasets>=2.12.0->Bayesian-LORA==0.1.0) (0.70.16)
Requirement already satisfied: fsspec<=2025.3.0,>=2023.1.0 in ./.venv/lib/python3.9/site-packages (from fsspec[http]<=2025.3.0,>=2023.1.0->datasets>=2.12.0->Bayesian-LORA==0.1.0) (2025.3.0)
Requirement already satisfied: aiohttp!=4.0.0a0,!=4.0.0a1 in ./.venv/lib/python3.9/site-packages (from fsspec[http]<=2025.3.0,>=2023.1.0->datasets>=2.12.0->Bayesian-LORA==0.1.0) (3.12.15)
Requirement already satisfied: aiohappyeyeballs>=2.5.0 in ./.venv/lib/python3.9/site-packages (from aiohttp!=4.0.0a0,!=4.0.0a1->fsspec[http]<=2025.3.0,>=2023.1.0->datasets>=2.12.0->Bayesian-LORA==0.1.0) (2.6.1)
Requirement already satisfied: aiosignal>=1.4.0 in ./.venv/lib/python3.9/site-packages (from aiohttp!=4.0.0a0,!=4.0.0a1->fsspec[http]<=2025.3.0,>=2023.1.0->datasets>=2.12.0->Bayesian-LORA==0.1.0) (1.4.0)
Requirement already satisfied: async-timeout<6.0,>=4.0 in ./.venv/lib/python3.9/site-packages (from aiohttp!=4.0.0a0,!=4.0.0a1->fsspec[http]<=2025.3.0,>=2023.1.0->datasets>=2.12.0->Bayesian-LORA==0.1.0) (5.0.1)
Requirement already satisfied: attrs>=17.3.0 in ./.venv/lib/python3.9/site-packages (from aiohttp!=4.0.0a0,!=4.0.0a1->fsspec[http]<=2025.3.0,>=2023.1.0->datasets>=2.12.0->Bayesian-LORA==0.1.0) (25.3.0)
Requirement already satisfied: frozenlist>=1.1.1 in ./.venv/lib/python3.9/site-packages (from aiohttp!=4.0.0a0,!=4.0.0a1->fsspec[http]<=2025.3.0,>=2023.1.0->datasets>=2.12.0->Bayesian-LORA==0.1.0) (1.7.0)
Requirement already satisfied: multidict<7.0,>=4.5 in ./.venv/lib/python3.9/site-packages (from aiohttp!=4.0.0a0,!=4.0.0a1->fsspec[http]<=2025.3.0,>=2023.1.0->datasets>=2.12.0->Bayesian-LORA==0.1.0) (6.6.4)
Requirement already satisfied: propcache>=0.2.0 in ./.venv/lib/python3.9/site-packages (from aiohttp!=4.0.0a0,!=4.0.0a1->fsspec[http]<=2025.3.0,>=2023.1.0->datasets>=2.12.0->Bayesian-LORA==0.1.0) (0.3.2)
Requirement already satisfied: yarl<2.0,>=1.17.0 in ./.venv/lib/python3.9/site-packages (from aiohttp!=4.0.0a0,!=4.0.0a1->fsspec[http]<=2025.3.0,>=2023.1.0->datasets>=2.12.0->Bayesian-LORA==0.1.0) (1.20.1)
Requirement already satisfied: typing-extensions>=4.1.0 in ./.venv/lib/python3.9/site-packages (from multidict<7.0,>=4.5->aiohttp!=4.0.0a0,!=4.0.0a1->fsspec[http]<=2025.3.0,>=2023.1.0->datasets>=2.12.0->Bayesian-LORA==0.1.0) (4.15.0)
Requirement already satisfied: idna>=2.0 in ./.venv/lib/python3.9/site-packages (from yarl<2.0,>=1.17.0->aiohttp!=4.0.0a0,!=4.0.0a1->fsspec[http]<=2025.3.0,>=2023.1.0->datasets>=2.12.0->Bayesian-LORA==0.1.0) (3.10)
Requirement already satisfied: hf-xet<2.0.0,>=1.1.3 in ./.venv/lib/python3.9/site-packages (from huggingface_hub>=0.21.0->accelerate>=0.20.0->Bayesian-LORA==0.1.0) (1.1.9)
Requirement already satisfied: charset_normalizer<4,>=2 in ./.venv/lib/python3.9/site-packages (from requests>=2.32.2->datasets>=2.12.0->Bayesian-LORA==0.1.0) (3.4.3)
Requirement already satisfied: urllib3<3,>=1.21.1 in ./.venv/lib/python3.9/site-packages (from requests>=2.32.2->datasets>=2.12.0->Bayesian-LORA==0.1.0) (2.5.0)
Requirement already satisfied: certifi>=2017.4.17 in ./.venv/lib/python3.9/site-packages (from requests>=2.32.2->datasets>=2.12.0->Bayesian-LORA==0.1.0) (2025.8.3)
Requirement already satisfied: sympy>=1.13.3 in ./.venv/lib/python3.9/site-packages (from torch>=2.0.0->Bayesian-LORA==0.1.0) (1.14.0)
Requirement already satisfied: networkx in ./.venv/lib/python3.9/site-packages (from torch>=2.0.0->Bayesian-LORA==0.1.0) (3.2.1)
Requirement already satisfied: jinja2 in ./.venv/lib/python3.9/site-packages (from torch>=2.0.0->Bayesian-LORA==0.1.0) (3.1.6)
Requirement already satisfied: nvidia-cuda-nvrtc-cu12==12.8.93 in ./.venv/lib/python3.9/site-packages (from torch>=2.0.0->Bayesian-LORA==0.1.0) (12.8.93)
Requirement already satisfied: nvidia-cuda-runtime-cu12==12.8.90 in ./.venv/lib/python3.9/site-packages (from torch>=2.0.0->Bayesian-LORA==0.1.0) (12.8.90)
Requirement already satisfied: nvidia-cuda-cupti-cu12==12.8.90 in ./.venv/lib/python3.9/site-packages (from torch>=2.0.0->Bayesian-LORA==0.1.0) (12.8.90)
Requirement already satisfied: nvidia-cudnn-cu12==9.10.2.21 in ./.venv/lib/python3.9/site-packages (from torch>=2.0.0->Bayesian-LORA==0.1.0) (9.10.2.21)
Requirement already satisfied: nvidia-cublas-cu12==12.8.4.1 in ./.venv/lib/python3.9/site-packages (from torch>=2.0.0->Bayesian-LORA==0.1.0) (12.8.4.1)
Requirement already satisfied: nvidia-cufft-cu12==11.3.3.83 in ./.venv/lib/python3.9/site-packages (from torch>=2.0.0->Bayesian-LORA==0.1.0) (11.3.3.83)
Requirement already satisfied: nvidia-curand-cu12==10.3.9.90 in ./.venv/lib/python3.9/site-packages (from torch>=2.0.0->Bayesian-LORA==0.1.0) (10.3.9.90)
Requirement already satisfied: nvidia-cusolver-cu12==11.7.3.90 in ./.venv/lib/python3.9/site-packages (from torch>=2.0.0->Bayesian-LORA==0.1.0) (11.7.3.90)
Requirement already satisfied: nvidia-cusparse-cu12==12.5.8.93 in ./.venv/lib/python3.9/site-packages (from torch>=2.0.0->Bayesian-LORA==0.1.0) (12.5.8.93)
Requirement already satisfied: nvidia-cusparselt-cu12==0.7.1 in ./.venv/lib/python3.9/site-packages (from torch>=2.0.0->Bayesian-LORA==0.1.0) (0.7.1)
Requirement already satisfied: nvidia-nccl-cu12==2.27.3 in ./.venv/lib/python3.9/site-packages (from torch>=2.0.0->Bayesian-LORA==0.1.0) (2.27.3)
Requirement already satisfied: nvidia-nvtx-cu12==12.8.90 in ./.venv/lib/python3.9/site-packages (from torch>=2.0.0->Bayesian-LORA==0.1.0) (12.8.90)
Requirement already satisfied: nvidia-nvjitlink-cu12==12.8.93 in ./.venv/lib/python3.9/site-packages (from torch>=2.0.0->Bayesian-LORA==0.1.0) (12.8.93)
Requirement already satisfied: nvidia-cufile-cu12==1.13.1.3 in ./.venv/lib/python3.9/site-packages (from torch>=2.0.0->Bayesian-LORA==0.1.0) (1.13.1.3)
Requirement already satisfied: triton==3.4.0 in ./.venv/lib/python3.9/site-packages (from torch>=2.0.0->Bayesian-LORA==0.1.0) (3.4.0)
Requirement already satisfied: setuptools>=40.8.0 in ./.venv/lib/python3.9/site-packages (from triton==3.4.0->torch>=2.0.0->Bayesian-LORA==0.1.0) (53.0.0)
Requirement already satisfied: importlib-metadata in ./.venv/lib/python3.9/site-packages (from triton==3.4.0->torch>=2.0.0->Bayesian-LORA==0.1.0) (8.7.0)
Requirement already satisfied: mpmath<1.4,>=1.1.0 in ./.venv/lib/python3.9/site-packages (from sympy>=1.13.3->torch>=2.0.0->Bayesian-LORA==0.1.0) (1.3.0)
Requirement already satisfied: regex!=2019.12.17 in ./.venv/lib/python3.9/site-packages (from transformers>=4.30.0->Bayesian-LORA==0.1.0) (2025.9.1)
Requirement already satisfied: zipp>=3.20 in ./.venv/lib/python3.9/site-packages (from importlib-metadata->triton==3.4.0->torch>=2.0.0->Bayesian-LORA==0.1.0) (3.23.0)
Requirement already satisfied: MarkupSafe>=2.0 in ./.venv/lib/python3.9/site-packages (from jinja2->torch>=2.0.0->Bayesian-LORA==0.1.0) (3.0.2)
Requirement already satisfied: contourpy>=1.0.1 in ./.venv/lib/python3.9/site-packages (from matplotlib->Bayesian-LORA==0.1.0) (1.3.0)
Requirement already satisfied: cycler>=0.10 in ./.venv/lib/python3.9/site-packages (from matplotlib->Bayesian-LORA==0.1.0) (0.12.1)
Requirement already satisfied: fonttools>=4.22.0 in ./.venv/lib/python3.9/site-packages (from matplotlib->Bayesian-LORA==0.1.0) (4.59.2)
Requirement already satisfied: kiwisolver>=1.3.1 in ./.venv/lib/python3.9/site-packages (from matplotlib->Bayesian-LORA==0.1.0) (1.4.7)
Requirement already satisfied: pillow>=8 in ./.venv/lib/python3.9/site-packages (from matplotlib->Bayesian-LORA==0.1.0) (11.3.0)
Requirement already satisfied: pyparsing>=2.3.1 in ./.venv/lib/python3.9/site-packages (from matplotlib->Bayesian-LORA==0.1.0) (3.2.3)
Requirement already satisfied: python-dateutil>=2.7 in ./.venv/lib/python3.9/site-packages (from matplotlib->Bayesian-LORA==0.1.0) (2.9.0.post0)
Requirement already satisfied: importlib-resources>=3.2.0 in ./.venv/lib/python3.9/site-packages (from matplotlib->Bayesian-LORA==0.1.0) (6.5.2)
Requirement already satisfied: six>=1.5 in ./.venv/lib/python3.9/site-packages (from python-dateutil>=2.7->matplotlib->Bayesian-LORA==0.1.0) (1.17.0)
Requirement already satisfied: pytz>=2020.1 in ./.venv/lib/python3.9/site-packages (from pandas->datasets>=2.12.0->Bayesian-LORA==0.1.0) (2025.2)
Requirement already satisfied: tzdata>=2022.7 in ./.venv/lib/python3.9/site-packages (from pandas->datasets>=2.12.0->Bayesian-LORA==0.1.0) (2025.2)
Requirement already satisfied: joblib>=1.2.0 in ./.venv/lib/python3.9/site-packages (from scikit-learn->Bayesian-LORA==0.1.0) (1.5.2)
Requirement already satisfied: threadpoolctl>=3.1.0 in ./.venv/lib/python3.9/site-packages (from scikit-learn->Bayesian-LORA==0.1.0) (3.6.0)
Building wheels for collected packages: Bayesian-LORA
  Building editable for Bayesian-LORA (pyproject.toml): started
  Building editable for Bayesian-LORA (pyproject.toml): finished with status 'done'
  Created wheel for Bayesian-LORA: filename=bayesian_lora-0.1.0-0.editable-py3-none-any.whl size=1457 sha256=e18c467223f328c920d459c45252e48a729bb8e1a6c4d50ed303bfc32ca7b198
  Stored in directory: /tmp/pip-ephem-wheel-cache-rx1sx2t3/wheels/e6/8c/54/9ced548b41650fdd37110b7a4079fec5aecbe008507cf13c8d
Successfully built Bayesian-LORA
Installing collected packages: Bayesian-LORA
  Attempting uninstall: Bayesian-LORA
    Found existing installation: Bayesian-LORA 0.1.0
    Uninstalling Bayesian-LORA-0.1.0:
      Successfully uninstalled Bayesian-LORA-0.1.0
Successfully installed Bayesian-LORA-0.1.0
=== Verifying pip installation ===
Name: Bayesian-LORA
Version: 0.1.0
Summary: Bayesian inference for Low-Rank Adaptation of Large Language Models
Home-page: 
Author: Bayesian LoRA Team
Author-email: 
License: 
Location: /scratch/nalint2/Bayesian-LORA/.venv/lib/python3.9/site-packages
Editable project location: /scratch/nalint2/Bayesian-LORA
Requires: accelerate, datasets, matplotlib, numpy, peft, protobuf, pyyaml, scikit-learn, scipy, sentencepiece, tokenizers, torch, torchvision, tqdm, transformers
Required-by: 
=== Verifying installation ===
Testing package installation status...
=== Testing bayesian_lora import ===
Python path: ['', '/usr/lib64/python39.zip', '/usr/lib64/python3.9']...
✅ bayesian_lora module imported successfully!
Version: 0.1.0
Author: Bayesian LoRA Team
Module location: /scratch/nalint2/Bayesian-LORA/src/bayesian_lora/__init__.py
✅ Package installation verified successfully!
=== Installing additional requirements ===
Requirement already satisfied: torch>=2.0.0 in ./.venv/lib/python3.9/site-packages (from -r requirements_lora.txt (line 2)) (2.8.0)
Requirement already satisfied: torchvision in ./.venv/lib/python3.9/site-packages (from -r requirements_lora.txt (line 3)) (0.23.0)
Requirement already satisfied: numpy in ./.venv/lib/python3.9/site-packages (from -r requirements_lora.txt (line 4)) (2.0.2)
Requirement already satisfied: tqdm in ./.venv/lib/python3.9/site-packages (from -r requirements_lora.txt (line 5)) (4.67.1)
Requirement already satisfied: pyyaml in ./.venv/lib/python3.9/site-packages (from -r requirements_lora.txt (line 6)) (6.0.2)
Requirement already satisfied: scikit-learn in ./.venv/lib/python3.9/site-packages (from -r requirements_lora.txt (line 7)) (1.6.1)
Requirement already satisfied: scipy in ./.venv/lib/python3.9/site-packages (from -r requirements_lora.txt (line 8)) (1.13.1)
Requirement already satisfied: matplotlib in ./.venv/lib/python3.9/site-packages (from -r requirements_lora.txt (line 9)) (3.9.4)
Requirement already satisfied: transformers>=4.30.0 in ./.venv/lib/python3.9/site-packages (from -r requirements_lora.txt (line 12)) (4.56.0)
Requirement already satisfied: datasets>=2.12.0 in ./.venv/lib/python3.9/site-packages (from -r requirements_lora.txt (line 13)) (4.0.0)
Requirement already satisfied: tokenizers>=0.13.0 in ./.venv/lib/python3.9/site-packages (from -r requirements_lora.txt (line 14)) (0.22.0)
Requirement already satisfied: peft>=0.4.0 in ./.venv/lib/python3.9/site-packages (from -r requirements_lora.txt (line 15)) (0.17.1)
Requirement already satisfied: accelerate>=0.20.0 in ./.venv/lib/python3.9/site-packages (from -r requirements_lora.txt (line 18)) (1.10.1)
Requirement already satisfied: sentencepiece in ./.venv/lib/python3.9/site-packages (from -r requirements_lora.txt (line 19)) (0.2.1)
Requirement already satisfied: protobuf in ./.venv/lib/python3.9/site-packages (from -r requirements_lora.txt (line 20)) (6.32.0)
Requirement already satisfied: filelock in ./.venv/lib/python3.9/site-packages (from torch>=2.0.0->-r requirements_lora.txt (line 2)) (3.19.1)
Requirement already satisfied: typing-extensions>=4.10.0 in ./.venv/lib/python3.9/site-packages (from torch>=2.0.0->-r requirements_lora.txt (line 2)) (4.15.0)
Requirement already satisfied: sympy>=1.13.3 in ./.venv/lib/python3.9/site-packages (from torch>=2.0.0->-r requirements_lora.txt (line 2)) (1.14.0)
Requirement already satisfied: networkx in ./.venv/lib/python3.9/site-packages (from torch>=2.0.0->-r requirements_lora.txt (line 2)) (3.2.1)
Requirement already satisfied: jinja2 in ./.venv/lib/python3.9/site-packages (from torch>=2.0.0->-r requirements_lora.txt (line 2)) (3.1.6)
Requirement already satisfied: fsspec in ./.venv/lib/python3.9/site-packages (from torch>=2.0.0->-r requirements_lora.txt (line 2)) (2025.3.0)
Requirement already satisfied: nvidia-cuda-nvrtc-cu12==12.8.93 in ./.venv/lib/python3.9/site-packages (from torch>=2.0.0->-r requirements_lora.txt (line 2)) (12.8.93)
Requirement already satisfied: nvidia-cuda-runtime-cu12==12.8.90 in ./.venv/lib/python3.9/site-packages (from torch>=2.0.0->-r requirements_lora.txt (line 2)) (12.8.90)
Requirement already satisfied: nvidia-cuda-cupti-cu12==12.8.90 in ./.venv/lib/python3.9/site-packages (from torch>=2.0.0->-r requirements_lora.txt (line 2)) (12.8.90)
Requirement already satisfied: nvidia-cudnn-cu12==9.10.2.21 in ./.venv/lib/python3.9/site-packages (from torch>=2.0.0->-r requirements_lora.txt (line 2)) (9.10.2.21)
Requirement already satisfied: nvidia-cublas-cu12==12.8.4.1 in ./.venv/lib/python3.9/site-packages (from torch>=2.0.0->-r requirements_lora.txt (line 2)) (12.8.4.1)
Requirement already satisfied: nvidia-cufft-cu12==11.3.3.83 in ./.venv/lib/python3.9/site-packages (from torch>=2.0.0->-r requirements_lora.txt (line 2)) (11.3.3.83)
Requirement already satisfied: nvidia-curand-cu12==10.3.9.90 in ./.venv/lib/python3.9/site-packages (from torch>=2.0.0->-r requirements_lora.txt (line 2)) (10.3.9.90)
Requirement already satisfied: nvidia-cusolver-cu12==11.7.3.90 in ./.venv/lib/python3.9/site-packages (from torch>=2.0.0->-r requirements_lora.txt (line 2)) (11.7.3.90)
Requirement already satisfied: nvidia-cusparse-cu12==12.5.8.93 in ./.venv/lib/python3.9/site-packages (from torch>=2.0.0->-r requirements_lora.txt (line 2)) (12.5.8.93)
Requirement already satisfied: nvidia-cusparselt-cu12==0.7.1 in ./.venv/lib/python3.9/site-packages (from torch>=2.0.0->-r requirements_lora.txt (line 2)) (0.7.1)
Requirement already satisfied: nvidia-nccl-cu12==2.27.3 in ./.venv/lib/python3.9/site-packages (from torch>=2.0.0->-r requirements_lora.txt (line 2)) (2.27.3)
Requirement already satisfied: nvidia-nvtx-cu12==12.8.90 in ./.venv/lib/python3.9/site-packages (from torch>=2.0.0->-r requirements_lora.txt (line 2)) (12.8.90)
Requirement already satisfied: nvidia-nvjitlink-cu12==12.8.93 in ./.venv/lib/python3.9/site-packages (from torch>=2.0.0->-r requirements_lora.txt (line 2)) (12.8.93)
Requirement already satisfied: nvidia-cufile-cu12==1.13.1.3 in ./.venv/lib/python3.9/site-packages (from torch>=2.0.0->-r requirements_lora.txt (line 2)) (1.13.1.3)
Requirement already satisfied: triton==3.4.0 in ./.venv/lib/python3.9/site-packages (from torch>=2.0.0->-r requirements_lora.txt (line 2)) (3.4.0)
Requirement already satisfied: setuptools>=40.8.0 in ./.venv/lib/python3.9/site-packages (from triton==3.4.0->torch>=2.0.0->-r requirements_lora.txt (line 2)) (53.0.0)
Requirement already satisfied: importlib-metadata in ./.venv/lib/python3.9/site-packages (from triton==3.4.0->torch>=2.0.0->-r requirements_lora.txt (line 2)) (8.7.0)
Requirement already satisfied: pillow!=8.3.*,>=5.3.0 in ./.venv/lib/python3.9/site-packages (from torchvision->-r requirements_lora.txt (line 3)) (11.3.0)
Requirement already satisfied: joblib>=1.2.0 in ./.venv/lib/python3.9/site-packages (from scikit-learn->-r requirements_lora.txt (line 7)) (1.5.2)
Requirement already satisfied: threadpoolctl>=3.1.0 in ./.venv/lib/python3.9/site-packages (from scikit-learn->-r requirements_lora.txt (line 7)) (3.6.0)
Requirement already satisfied: contourpy>=1.0.1 in ./.venv/lib/python3.9/site-packages (from matplotlib->-r requirements_lora.txt (line 9)) (1.3.0)
Requirement already satisfied: cycler>=0.10 in ./.venv/lib/python3.9/site-packages (from matplotlib->-r requirements_lora.txt (line 9)) (0.12.1)
Requirement already satisfied: fonttools>=4.22.0 in ./.venv/lib/python3.9/site-packages (from matplotlib->-r requirements_lora.txt (line 9)) (4.59.2)
Requirement already satisfied: kiwisolver>=1.3.1 in ./.venv/lib/python3.9/site-packages (from matplotlib->-r requirements_lora.txt (line 9)) (1.4.7)
Requirement already satisfied: packaging>=20.0 in ./.venv/lib/python3.9/site-packages (from matplotlib->-r requirements_lora.txt (line 9)) (25.0)
Requirement already satisfied: pyparsing>=2.3.1 in ./.venv/lib/python3.9/site-packages (from matplotlib->-r requirements_lora.txt (line 9)) (3.2.3)
Requirement already satisfied: python-dateutil>=2.7 in ./.venv/lib/python3.9/site-packages (from matplotlib->-r requirements_lora.txt (line 9)) (2.9.0.post0)
Requirement already satisfied: importlib-resources>=3.2.0 in ./.venv/lib/python3.9/site-packages (from matplotlib->-r requirements_lora.txt (line 9)) (6.5.2)
Requirement already satisfied: huggingface-hub<1.0,>=0.34.0 in ./.venv/lib/python3.9/site-packages (from transformers>=4.30.0->-r requirements_lora.txt (line 12)) (0.34.4)
Requirement already satisfied: regex!=2019.12.17 in ./.venv/lib/python3.9/site-packages (from transformers>=4.30.0->-r requirements_lora.txt (line 12)) (2025.9.1)
Requirement already satisfied: requests in ./.venv/lib/python3.9/site-packages (from transformers>=4.30.0->-r requirements_lora.txt (line 12)) (2.32.5)
Requirement already satisfied: safetensors>=0.4.3 in ./.venv/lib/python3.9/site-packages (from transformers>=4.30.0->-r requirements_lora.txt (line 12)) (0.6.2)
Requirement already satisfied: hf-xet<2.0.0,>=1.1.3 in ./.venv/lib/python3.9/site-packages (from huggingface-hub<1.0,>=0.34.0->transformers>=4.30.0->-r requirements_lora.txt (line 12)) (1.1.9)
Requirement already satisfied: pyarrow>=15.0.0 in ./.venv/lib/python3.9/site-packages (from datasets>=2.12.0->-r requirements_lora.txt (line 13)) (21.0.0)
Requirement already satisfied: dill<0.3.9,>=0.3.0 in ./.venv/lib/python3.9/site-packages (from datasets>=2.12.0->-r requirements_lora.txt (line 13)) (0.3.8)
Requirement already satisfied: pandas in ./.venv/lib/python3.9/site-packages (from datasets>=2.12.0->-r requirements_lora.txt (line 13)) (2.3.2)
Requirement already satisfied: xxhash in ./.venv/lib/python3.9/site-packages (from datasets>=2.12.0->-r requirements_lora.txt (line 13)) (3.5.0)
Requirement already satisfied: multiprocess<0.70.17 in ./.venv/lib/python3.9/site-packages (from datasets>=2.12.0->-r requirements_lora.txt (line 13)) (0.70.16)
Requirement already satisfied: aiohttp!=4.0.0a0,!=4.0.0a1 in ./.venv/lib/python3.9/site-packages (from fsspec[http]<=2025.3.0,>=2023.1.0->datasets>=2.12.0->-r requirements_lora.txt (line 13)) (3.12.15)
Requirement already satisfied: psutil in ./.venv/lib/python3.9/site-packages (from peft>=0.4.0->-r requirements_lora.txt (line 15)) (7.0.0)
Requirement already satisfied: aiohappyeyeballs>=2.5.0 in ./.venv/lib/python3.9/site-packages (from aiohttp!=4.0.0a0,!=4.0.0a1->fsspec[http]<=2025.3.0,>=2023.1.0->datasets>=2.12.0->-r requirements_lora.txt (line 13)) (2.6.1)
Requirement already satisfied: aiosignal>=1.4.0 in ./.venv/lib/python3.9/site-packages (from aiohttp!=4.0.0a0,!=4.0.0a1->fsspec[http]<=2025.3.0,>=2023.1.0->datasets>=2.12.0->-r requirements_lora.txt (line 13)) (1.4.0)
Requirement already satisfied: async-timeout<6.0,>=4.0 in ./.venv/lib/python3.9/site-packages (from aiohttp!=4.0.0a0,!=4.0.0a1->fsspec[http]<=2025.3.0,>=2023.1.0->datasets>=2.12.0->-r requirements_lora.txt (line 13)) (5.0.1)
Requirement already satisfied: attrs>=17.3.0 in ./.venv/lib/python3.9/site-packages (from aiohttp!=4.0.0a0,!=4.0.0a1->fsspec[http]<=2025.3.0,>=2023.1.0->datasets>=2.12.0->-r requirements_lora.txt (line 13)) (25.3.0)
Requirement already satisfied: frozenlist>=1.1.1 in ./.venv/lib/python3.9/site-packages (from aiohttp!=4.0.0a0,!=4.0.0a1->fsspec[http]<=2025.3.0,>=2023.1.0->datasets>=2.12.0->-r requirements_lora.txt (line 13)) (1.7.0)
Requirement already satisfied: multidict<7.0,>=4.5 in ./.venv/lib/python3.9/site-packages (from aiohttp!=4.0.0a0,!=4.0.0a1->fsspec[http]<=2025.3.0,>=2023.1.0->datasets>=2.12.0->-r requirements_lora.txt (line 13)) (6.6.4)
Requirement already satisfied: propcache>=0.2.0 in ./.venv/lib/python3.9/site-packages (from aiohttp!=4.0.0a0,!=4.0.0a1->fsspec[http]<=2025.3.0,>=2023.1.0->datasets>=2.12.0->-r requirements_lora.txt (line 13)) (0.3.2)
Requirement already satisfied: yarl<2.0,>=1.17.0 in ./.venv/lib/python3.9/site-packages (from aiohttp!=4.0.0a0,!=4.0.0a1->fsspec[http]<=2025.3.0,>=2023.1.0->datasets>=2.12.0->-r requirements_lora.txt (line 13)) (1.20.1)
Requirement already satisfied: idna>=2.0 in ./.venv/lib/python3.9/site-packages (from yarl<2.0,>=1.17.0->aiohttp!=4.0.0a0,!=4.0.0a1->fsspec[http]<=2025.3.0,>=2023.1.0->datasets>=2.12.0->-r requirements_lora.txt (line 13)) (3.10)
Requirement already satisfied: zipp>=3.1.0 in ./.venv/lib/python3.9/site-packages (from importlib-resources>=3.2.0->matplotlib->-r requirements_lora.txt (line 9)) (3.23.0)
Requirement already satisfied: six>=1.5 in ./.venv/lib/python3.9/site-packages (from python-dateutil>=2.7->matplotlib->-r requirements_lora.txt (line 9)) (1.17.0)
Requirement already satisfied: charset_normalizer<4,>=2 in ./.venv/lib/python3.9/site-packages (from requests->transformers>=4.30.0->-r requirements_lora.txt (line 12)) (3.4.3)
Requirement already satisfied: urllib3<3,>=1.21.1 in ./.venv/lib/python3.9/site-packages (from requests->transformers>=4.30.0->-r requirements_lora.txt (line 12)) (2.5.0)
Requirement already satisfied: certifi>=2017.4.17 in ./.venv/lib/python3.9/site-packages (from requests->transformers>=4.30.0->-r requirements_lora.txt (line 12)) (2025.8.3)
Requirement already satisfied: mpmath<1.4,>=1.1.0 in ./.venv/lib/python3.9/site-packages (from sympy>=1.13.3->torch>=2.0.0->-r requirements_lora.txt (line 2)) (1.3.0)
Requirement already satisfied: MarkupSafe>=2.0 in ./.venv/lib/python3.9/site-packages (from jinja2->torch>=2.0.0->-r requirements_lora.txt (line 2)) (3.0.2)
Requirement already satisfied: pytz>=2020.1 in ./.venv/lib/python3.9/site-packages (from pandas->datasets>=2.12.0->-r requirements_lora.txt (line 13)) (2025.2)
Requirement already satisfied: tzdata>=2022.7 in ./.venv/lib/python3.9/site-packages (from pandas->datasets>=2.12.0->-r requirements_lora.txt (line 13)) (2025.2)
=== Environment setup complete ===
Python executable: /scratch/nalint2/Bayesian-LORA/.venv/bin/python3
Pip executable: /scratch/nalint2/Bayesian-LORA/.venv/bin/pip3
Virtual environment: /scratch/nalint2/Bayesian-LORA/.venv
=== Starting SAM-SGLD LoRA Experiment ===
Configuration: configs/mrpc_roberta_lora_samsgld_rank1.yaml
Output directory: runs/mrpc_roberta_lora_samsgld_rank1
=== Phase 1: Training MAP LoRA and SAM-SGLD Sampling ===
2025-09-14 18:27:42,506 - root - INFO - Using device: cuda
Some weights of RobertaForSequenceClassification were not initialized from the model checkpoint at roberta-base and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2025-09-14 18:27:45,309 - root - INFO - Starting MAP LoRA training...
2025-09-14 18:28:31,402 - root - INFO - Epoch 1: Train Loss: 0.5831, Val Loss: 0.4465, Val Acc: 0.7696
2025-09-14 18:29:17,369 - root - INFO - Epoch 2: Train Loss: 0.4535, Val Loss: 0.3868, Val Acc: 0.8260
2025-09-14 18:30:04,167 - root - INFO - Epoch 3: Train Loss: 0.3930, Val Loss: 0.3186, Val Acc: 0.8627
2025-09-14 18:30:51,671 - root - INFO - Epoch 4: Train Loss: 0.3472, Val Loss: 0.3133, Val Acc: 0.8725
2025-09-14 18:31:39,769 - root - INFO - Epoch 5: Train Loss: 0.3016, Val Loss: 0.3242, Val Acc: 0.8848
2025-09-14 18:32:27,980 - root - INFO - Epoch 6: Train Loss: 0.2711, Val Loss: 0.2964, Val Acc: 0.8652
2025-09-14 18:33:15,856 - root - INFO - Epoch 7: Train Loss: 0.2396, Val Loss: 0.3133, Val Acc: 0.8775
2025-09-14 18:34:03,941 - root - INFO - Epoch 8: Train Loss: 0.2217, Val Loss: 0.3062, Val Acc: 0.8701
2025-09-14 18:34:52,168 - root - INFO - Epoch 9: Train Loss: 0.1832, Val Loss: 0.3498, Val Acc: 0.8652
2025-09-14 18:35:40,398 - root - INFO - Epoch 10: Train Loss: 0.1558, Val Loss: 0.3834, Val Acc: 0.8676
2025-09-14 18:36:28,626 - root - INFO - Epoch 11: Train Loss: 0.1351, Val Loss: 0.3991, Val Acc: 0.8848
2025-09-14 18:37:17,405 - root - INFO - Epoch 12: Train Loss: 0.1183, Val Loss: 0.3689, Val Acc: 0.8750
2025-09-14 18:38:05,739 - root - INFO - Epoch 13: Train Loss: 0.1007, Val Loss: 0.3839, Val Acc: 0.8799
2025-09-14 18:38:54,101 - root - INFO - Epoch 14: Train Loss: 0.0855, Val Loss: 0.4078, Val Acc: 0.8775
2025-09-14 18:39:42,460 - root - INFO - Epoch 15: Train Loss: 0.0843, Val Loss: 0.3846, Val Acc: 0.8897
2025-09-14 18:40:30,847 - root - INFO - Epoch 16: Train Loss: 0.0814, Val Loss: 0.4051, Val Acc: 0.8848
2025-09-14 18:41:19,236 - root - INFO - Epoch 17: Train Loss: 0.0638, Val Loss: 0.4504, Val Acc: 0.8701
2025-09-14 18:42:07,969 - root - INFO - Epoch 18: Train Loss: 0.0703, Val Loss: 0.5252, Val Acc: 0.8676
2025-09-14 18:42:56,458 - root - INFO - Epoch 19: Train Loss: 0.0456, Val Loss: 0.4740, Val Acc: 0.8676
2025-09-14 18:43:44,853 - root - INFO - Epoch 20: Train Loss: 0.0548, Val Loss: 0.5030, Val Acc: 0.8603
2025-09-14 18:43:45,650 - root - INFO - MAP model saved to runs/mrpc_roberta_lora_samsgld_rank1/map_model.pth
2025-09-14 18:43:45,770 - root - INFO - Starting SAM-SGLD Rank-1 LoRA training...
2025-09-14 18:43:45,770 - root - INFO - Running chain 1/1
2025-09-14 18:43:46,091 - root - INFO - Chain 1: MAP model loaded - LoRA param norms: [2.429481267929077, 1.4358419179916382, 2.4619674682617188]
2025-09-14 18:43:46,311 - root - INFO - Chain 1: MAP model test - Loss: 0.2944, Acc: 0.9062
2025-09-14 18:43:46,311 - root - INFO - Chain 1: Initial configuration:
2025-09-14 18:43:46,311 - root - INFO -   Initial step size: 2.00e-03
2025-09-14 18:43:46,311 - root - INFO -   Temperature: 2.0
2025-09-14 18:43:46,311 - root - INFO -   Noise scale: 5.00e-05
2025-09-14 18:43:46,311 - root - INFO -   Prior std: 17.000
2025-09-14 18:43:46,311 - root - INFO -   SAM rho: 0.050
2025-09-14 18:43:46,311 - root - INFO -   Decay rate: 0.300
2025-09-14 18:43:46,311 - root - INFO - Chain 1: Burn-in phase (8000 steps)
2025-09-14 18:43:47,550 - root - INFO - Burn-in step 0/8000:
2025-09-14 18:43:47,550 - root - INFO -   Actual drift norm: 1.00e-02
2025-09-14 18:43:47,550 - root - INFO -   Actual noise norm: 1.72e-03
2025-09-14 18:43:47,550 - root - INFO -   Actual drift/noise ratio: 5.810
2025-09-14 18:43:47,550 - root - INFO -   Theoretical step/noise ratio: 216.930
2025-09-14 18:43:47,550 - root - INFO -   Prior/Likelihood ratio: 2.368
2025-09-14 18:43:47,551 - root - INFO -   SAM perturbation norm: 4.90e-01
2025-09-14 18:43:47,551 - root - INFO -   SAM gradient norm: 1.68e+01
2025-09-14 18:43:47,551 - root - INFO -   SAM perturbation/gradient ratio: 0.029
2025-09-14 18:43:47,551 - root - INFO -   Rank-1 noise contribution: 0.049
2025-09-14 18:43:47,551 - root - INFO -   Loss change after SAM perturbation: 1.6081
2025-09-14 18:50:50,479 - root - INFO - Burn-in step 500/8000:
2025-09-14 18:50:50,482 - root - INFO -   Actual drift norm: 8.74e-03
2025-09-14 18:50:50,482 - root - INFO -   Actual noise norm: 1.69e-03
2025-09-14 18:50:50,482 - root - INFO -   Actual drift/noise ratio: 5.166
2025-09-14 18:50:50,482 - root - INFO -   Theoretical step/noise ratio: 213.132
2025-09-14 18:50:50,482 - root - INFO -   Prior/Likelihood ratio: 8.469
2025-09-14 18:50:50,482 - root - INFO -   SAM perturbation norm: 4.90e-01
2025-09-14 18:50:50,482 - root - INFO -   SAM gradient norm: 4.53e+00
2025-09-14 18:50:50,482 - root - INFO -   SAM perturbation/gradient ratio: 0.108
2025-09-14 18:50:50,482 - root - INFO -   Rank-1 noise contribution: 0.051
2025-09-14 18:50:50,482 - root - INFO -   Loss change after SAM perturbation: 0.5628
2025-09-14 18:57:59,599 - root - INFO - Burn-in step 1000/8000:
2025-09-14 18:57:59,601 - root - INFO -   Actual drift norm: 2.36e-03
2025-09-14 18:57:59,601 - root - INFO -   Actual noise norm: 1.66e-03
2025-09-14 18:57:59,601 - root - INFO -   Actual drift/noise ratio: 1.420
2025-09-14 18:57:59,602 - root - INFO -   Theoretical step/noise ratio: 209.790
2025-09-14 18:57:59,602 - root - INFO -   Prior/Likelihood ratio: 10.601
2025-09-14 18:57:59,602 - root - INFO -   SAM perturbation norm: 4.90e-01
2025-09-14 18:57:59,602 - root - INFO -   SAM gradient norm: 1.26e+00
2025-09-14 18:57:59,602 - root - INFO -   SAM perturbation/gradient ratio: 0.387
2025-09-14 18:57:59,602 - root - INFO -   Rank-1 noise contribution: 0.048
2025-09-14 18:57:59,602 - root - INFO -   Loss change after SAM perturbation: 0.2241
2025-09-14 19:05:03,366 - root - INFO - Burn-in step 1500/8000:
2025-09-14 19:05:03,390 - root - INFO -   Actual drift norm: 8.47e-03
2025-09-14 19:05:03,391 - root - INFO -   Actual noise norm: 1.64e-03
2025-09-14 19:05:03,391 - root - INFO -   Actual drift/noise ratio: 5.169
2025-09-14 19:05:03,391 - root - INFO -   Theoretical step/noise ratio: 206.812
2025-09-14 19:05:03,391 - root - INFO -   Prior/Likelihood ratio: 2.343
2025-09-14 19:05:03,391 - root - INFO -   SAM perturbation norm: 4.90e-01
2025-09-14 19:05:03,391 - root - INFO -   SAM gradient norm: 4.66e+00
2025-09-14 19:05:03,391 - root - INFO -   SAM perturbation/gradient ratio: 0.105
2025-09-14 19:05:03,391 - root - INFO -   Rank-1 noise contribution: 0.053
2025-09-14 19:05:03,391 - root - INFO -   Loss change after SAM perturbation: 0.6180
2025-09-14 19:12:03,268 - root - INFO - Burn-in step 2000/8000:
2025-09-14 19:12:03,270 - root - INFO -   Actual drift norm: 2.99e-03
2025-09-14 19:12:03,270 - root - INFO -   Actual noise norm: 1.62e-03
2025-09-14 19:12:03,270 - root - INFO -   Actual drift/noise ratio: 1.850
2025-09-14 19:12:03,270 - root - INFO -   Theoretical step/noise ratio: 204.130
2025-09-14 19:12:03,270 - root - INFO -   Prior/Likelihood ratio: 7.881
2025-09-14 19:12:03,270 - root - INFO -   SAM perturbation norm: 4.90e-01
2025-09-14 19:12:03,270 - root - INFO -   SAM gradient norm: 1.69e+00
2025-09-14 19:12:03,270 - root - INFO -   SAM perturbation/gradient ratio: 0.290
2025-09-14 19:12:03,271 - root - INFO -   Rank-1 noise contribution: 0.049
2025-09-14 19:12:03,271 - root - INFO -   Loss change after SAM perturbation: 0.3420
2025-09-14 19:19:05,740 - root - INFO - Burn-in step 2500/8000:
2025-09-14 19:19:05,742 - root - INFO -   Actual drift norm: 3.04e-03
2025-09-14 19:19:05,742 - root - INFO -   Actual noise norm: 1.60e-03
2025-09-14 19:19:05,742 - root - INFO -   Actual drift/noise ratio: 1.903
2025-09-14 19:19:05,742 - root - INFO -   Theoretical step/noise ratio: 201.694
2025-09-14 19:19:05,742 - root - INFO -   Prior/Likelihood ratio: 11.240
2025-09-14 19:19:05,743 - root - INFO -   SAM perturbation norm: 4.90e-01
2025-09-14 19:19:05,743 - root - INFO -   SAM gradient norm: 1.76e+00
2025-09-14 19:19:05,743 - root - INFO -   SAM perturbation/gradient ratio: 0.278
2025-09-14 19:19:05,743 - root - INFO -   Rank-1 noise contribution: 0.051
2025-09-14 19:19:05,743 - root - INFO -   Loss change after SAM perturbation: 0.1695
2025-09-14 19:26:15,627 - root - INFO - Burn-in step 3000/8000:
2025-09-14 19:26:15,629 - root - INFO -   Actual drift norm: 2.23e-03
2025-09-14 19:26:15,629 - root - INFO -   Actual noise norm: 1.58e-03
2025-09-14 19:26:15,629 - root - INFO -   Actual drift/noise ratio: 1.409
2025-09-14 19:26:15,629 - root - INFO -   Theoretical step/noise ratio: 199.464
2025-09-14 19:26:15,630 - root - INFO -   Prior/Likelihood ratio: 4.616
2025-09-14 19:26:15,630 - root - INFO -   SAM perturbation norm: 4.90e-01
2025-09-14 19:26:15,630 - root - INFO -   SAM gradient norm: 1.32e+00
2025-09-14 19:26:15,630 - root - INFO -   SAM perturbation/gradient ratio: 0.372
2025-09-14 19:26:15,630 - root - INFO -   Rank-1 noise contribution: 0.055
2025-09-14 19:26:15,630 - root - INFO -   Loss change after SAM perturbation: 0.1851
2025-09-14 19:33:24,738 - root - INFO - Burn-in step 3500/8000:
2025-09-14 19:33:24,741 - root - INFO -   Actual drift norm: 6.69e-03
2025-09-14 19:33:24,741 - root - INFO -   Actual noise norm: 1.57e-03
2025-09-14 19:33:24,741 - root - INFO -   Actual drift/noise ratio: 4.272
2025-09-14 19:33:24,741 - root - INFO -   Theoretical step/noise ratio: 197.411
2025-09-14 19:33:24,741 - root - INFO -   Prior/Likelihood ratio: 4.502
2025-09-14 19:33:24,741 - root - INFO -   SAM perturbation norm: 4.90e-01
2025-09-14 19:33:24,741 - root - INFO -   SAM gradient norm: 4.04e+00
2025-09-14 19:33:24,741 - root - INFO -   SAM perturbation/gradient ratio: 0.121
2025-09-14 19:33:24,741 - root - INFO -   Rank-1 noise contribution: 0.048
2025-09-14 19:33:24,741 - root - INFO -   Loss change after SAM perturbation: 0.2691
2025-09-14 19:40:32,770 - root - INFO - Burn-in step 4000/8000:
2025-09-14 19:40:32,772 - root - INFO -   Actual drift norm: 4.81e-03
2025-09-14 19:40:32,772 - root - INFO -   Actual noise norm: 1.55e-03
2025-09-14 19:40:32,773 - root - INFO -   Actual drift/noise ratio: 3.099
2025-09-14 19:40:32,773 - root - INFO -   Theoretical step/noise ratio: 195.509
2025-09-14 19:40:32,773 - root - INFO -   Prior/Likelihood ratio: 3.052
2025-09-14 19:40:32,773 - root - INFO -   SAM perturbation norm: 4.90e-01
2025-09-14 19:40:32,773 - root - INFO -   SAM gradient norm: 2.96e+00
2025-09-14 19:40:32,773 - root - INFO -   SAM perturbation/gradient ratio: 0.166
2025-09-14 19:40:32,773 - root - INFO -   Rank-1 noise contribution: 0.043
2025-09-14 19:40:32,773 - root - INFO -   Loss change after SAM perturbation: 0.1939
2025-09-14 19:47:41,432 - root - INFO - Burn-in step 4500/8000:
2025-09-14 19:47:41,434 - root - INFO -   Actual drift norm: 6.14e-03
2025-09-14 19:47:41,434 - root - INFO -   Actual noise norm: 1.54e-03
2025-09-14 19:47:41,434 - root - INFO -   Actual drift/noise ratio: 3.995
2025-09-14 19:47:41,434 - root - INFO -   Theoretical step/noise ratio: 193.739
2025-09-14 19:47:41,434 - root - INFO -   Prior/Likelihood ratio: 2.631
2025-09-14 19:47:41,434 - root - INFO -   SAM perturbation norm: 4.90e-01
2025-09-14 19:47:41,435 - root - INFO -   SAM gradient norm: 3.85e+00
2025-09-14 19:47:41,435 - root - INFO -   SAM perturbation/gradient ratio: 0.127
2025-09-14 19:47:41,435 - root - INFO -   Rank-1 noise contribution: 0.056
2025-09-14 19:47:41,435 - root - INFO -   Loss change after SAM perturbation: 0.3567
2025-09-14 19:54:49,956 - root - INFO - Burn-in step 5000/8000:
2025-09-14 19:54:49,958 - root - INFO -   Actual drift norm: 4.65e-03
2025-09-14 19:54:49,958 - root - INFO -   Actual noise norm: 1.52e-03
2025-09-14 19:54:49,958 - root - INFO -   Actual drift/noise ratio: 3.053
2025-09-14 19:54:49,958 - root - INFO -   Theoretical step/noise ratio: 192.085
2025-09-14 19:54:49,959 - root - INFO -   Prior/Likelihood ratio: 9.931
2025-09-14 19:54:49,959 - root - INFO -   SAM perturbation norm: 4.90e-01
2025-09-14 19:54:49,959 - root - INFO -   SAM gradient norm: 2.96e+00
2025-09-14 19:54:49,959 - root - INFO -   SAM perturbation/gradient ratio: 0.165
2025-09-14 19:54:49,959 - root - INFO -   Rank-1 noise contribution: 0.048
2025-09-14 19:54:49,959 - root - INFO -   Loss change after SAM perturbation: 0.3482
2025-09-14 20:01:58,258 - root - INFO - Burn-in step 5500/8000:
2025-09-14 20:01:58,260 - root - INFO -   Actual drift norm: 3.67e-03
2025-09-14 20:01:58,260 - root - INFO -   Actual noise norm: 1.51e-03
2025-09-14 20:01:58,260 - root - INFO -   Actual drift/noise ratio: 2.429
2025-09-14 20:01:58,260 - root - INFO -   Theoretical step/noise ratio: 190.533
2025-09-14 20:01:58,260 - root - INFO -   Prior/Likelihood ratio: 6.021
2025-09-14 20:01:58,260 - root - INFO -   SAM perturbation norm: 4.90e-01
2025-09-14 20:01:58,261 - root - INFO -   SAM gradient norm: 2.38e+00
2025-09-14 20:01:58,261 - root - INFO -   SAM perturbation/gradient ratio: 0.206
2025-09-14 20:01:58,261 - root - INFO -   Rank-1 noise contribution: 0.055
2025-09-14 20:01:58,261 - root - INFO -   Loss change after SAM perturbation: 0.3251
2025-09-14 20:09:06,474 - root - INFO - Burn-in step 6000/8000:
2025-09-14 20:09:06,477 - root - INFO -   Actual drift norm: 5.47e-03
2025-09-14 20:09:06,477 - root - INFO -   Actual noise norm: 1.50e-03
2025-09-14 20:09:06,477 - root - INFO -   Actual drift/noise ratio: 3.644
2025-09-14 20:09:06,477 - root - INFO -   Theoretical step/noise ratio: 189.073
2025-09-14 20:09:06,477 - root - INFO -   Prior/Likelihood ratio: 9.356
2025-09-14 20:09:06,477 - root - INFO -   SAM perturbation norm: 4.90e-01
2025-09-14 20:09:06,477 - root - INFO -   SAM gradient norm: 3.60e+00
2025-09-14 20:09:06,477 - root - INFO -   SAM perturbation/gradient ratio: 0.136
2025-09-14 20:09:06,477 - root - INFO -   Rank-1 noise contribution: 0.045
2025-09-14 20:09:06,477 - root - INFO -   Loss change after SAM perturbation: 0.5874
2025-09-14 20:16:09,758 - root - INFO - Burn-in step 6500/8000:
2025-09-14 20:16:09,761 - root - INFO -   Actual drift norm: 2.09e-03
2025-09-14 20:16:09,761 - root - INFO -   Actual noise norm: 1.49e-03
2025-09-14 20:16:09,761 - root - INFO -   Actual drift/noise ratio: 1.405
2025-09-14 20:16:09,761 - root - INFO -   Theoretical step/noise ratio: 187.694
2025-09-14 20:16:09,761 - root - INFO -   Prior/Likelihood ratio: 11.729
2025-09-14 20:16:09,761 - root - INFO -   SAM perturbation norm: 4.90e-01
2025-09-14 20:16:09,761 - root - INFO -   SAM gradient norm: 1.40e+00
2025-09-14 20:16:09,761 - root - INFO -   SAM perturbation/gradient ratio: 0.351
2025-09-14 20:16:09,761 - root - INFO -   Rank-1 noise contribution: 0.044
2025-09-14 20:16:09,761 - root - INFO -   Loss change after SAM perturbation: 0.1453
2025-09-14 20:23:05,401 - root - INFO - Burn-in step 7000/8000:
2025-09-14 20:23:05,404 - root - INFO -   Actual drift norm: 7.38e-03
2025-09-14 20:23:05,404 - root - INFO -   Actual noise norm: 1.48e-03
2025-09-14 20:23:05,404 - root - INFO -   Actual drift/noise ratio: 4.989
2025-09-14 20:23:05,404 - root - INFO -   Theoretical step/noise ratio: 186.389
2025-09-14 20:23:05,404 - root - INFO -   Prior/Likelihood ratio: 4.366
2025-09-14 20:23:05,404 - root - INFO -   SAM perturbation norm: 4.90e-01
2025-09-14 20:23:05,404 - root - INFO -   SAM gradient norm: 6.61e+00
2025-09-14 20:23:05,404 - root - INFO -   SAM perturbation/gradient ratio: 0.074
2025-09-14 20:23:05,404 - root - INFO -   Rank-1 noise contribution: 0.039
2025-09-14 20:23:05,404 - root - INFO -   Loss change after SAM perturbation: 0.4885
2025-09-14 20:30:01,226 - root - INFO - Burn-in step 7500/8000:
2025-09-14 20:30:01,229 - root - INFO -   Actual drift norm: 2.40e-03
2025-09-14 20:30:01,229 - root - INFO -   Actual noise norm: 1.47e-03
2025-09-14 20:30:01,229 - root - INFO -   Actual drift/noise ratio: 1.630
2025-09-14 20:30:01,229 - root - INFO -   Theoretical step/noise ratio: 185.150
2025-09-14 20:30:01,229 - root - INFO -   Prior/Likelihood ratio: 3.170
2025-09-14 20:30:01,229 - root - INFO -   SAM perturbation norm: 4.90e-01
2025-09-14 20:30:01,229 - root - INFO -   SAM gradient norm: 1.65e+00
2025-09-14 20:30:01,229 - root - INFO -   SAM perturbation/gradient ratio: 0.298
2025-09-14 20:30:01,229 - root - INFO -   Rank-1 noise contribution: 0.047
2025-09-14 20:30:01,229 - root - INFO -   Loss change after SAM perturbation: 0.1180
2025-09-14 20:36:56,250 - root - INFO -   DIAGNOSTIC - Burn-in completed:
2025-09-14 20:36:56,253 - root - INFO -     Avg parameter movement: 0.132881
2025-09-14 20:36:56,253 - root - INFO -     Total parameters moved: 96
2025-09-14 20:36:56,253 - root - INFO - Chain 1: Sampling phase (3000 steps)
2025-09-14 20:36:56,446 - root - INFO -   DIAGNOSTIC - Initial state:
2025-09-14 20:36:56,447 - root - INFO -     Initial prediction: [0, 1]
2025-09-14 20:36:56,447 - root - INFO -     Initial confidence: [0.929100513458252, 0.07089942693710327]
2025-09-14 20:36:56,451 - root - INFO - Chain 1: Step size after burn-in:
2025-09-14 20:36:56,451 - root - INFO -   Initial: 2.00e-03
2025-09-14 20:36:56,451 - root - INFO -   Final: 1.44e-03
2025-09-14 20:36:56,451 - root - INFO -   Reduction: 28.1%
2025-09-14 20:36:57,468 - root - INFO - Chain 1, Step 0:
2025-09-14 20:36:57,468 - root - INFO -   Actual drift norm: 1.96e-03
2025-09-14 20:36:57,468 - root - INFO -   Actual noise norm: 1.46e-03
2025-09-14 20:36:57,468 - root - INFO -   Actual drift/noise ratio: 1.345
2025-09-14 20:36:57,468 - root - INFO -   Theoretical step/noise ratio: 183.972
2025-09-14 20:36:57,468 - root - INFO -   Prior/Likelihood ratio: 4.354
2025-09-14 20:36:57,468 - root - INFO -   SAM rho: 0.050
2025-09-14 20:36:57,468 - root - INFO -   SAM perturbation norm: 4.90e-01
2025-09-14 20:36:57,468 - root - INFO -   SAM gradient norm: 1.36e+00
2025-09-14 20:36:57,468 - root - INFO -   SAM perturbation/gradient ratio: 0.359
2025-09-14 20:36:57,469 - root - INFO -   Rank-1 noise contribution: 0.051
2025-09-14 20:36:57,469 - root - INFO -   Loss change after SAM perturbation: 0.1560
2025-09-14 20:36:57,469 - root - INFO -   Temperature: 2.0
2025-09-14 20:36:57,643 - root - INFO -   DIAGNOSTIC - Sample 1:
2025-09-14 20:36:57,643 - root - INFO -     Avg parameter movement: 0.000234
2025-09-14 20:36:57,643 - root - INFO -     Prediction changed: False
2025-09-14 20:36:57,643 - root - INFO -     Confidence change: 0.031967
2025-09-14 20:36:57,643 - root - INFO -     Current prediction: [0, 1]
2025-09-14 20:36:57,643 - root - INFO -     Current confidence: [0.9512489438056946, 0.04875104874372482]
2025-09-14 20:36:57,643 - root - INFO - Sampling step 0/3000, step_size: 1.44e-03
2025-09-14 20:37:39,185 - root - INFO -   DIAGNOSTIC - Sample 2:
2025-09-14 20:37:39,186 - root - INFO -     Avg parameter movement: 0.002171
2025-09-14 20:37:39,186 - root - INFO -     Prediction changed: True
2025-09-14 20:37:39,186 - root - INFO -     Confidence change: 1.306839
2025-09-14 20:37:39,186 - root - INFO -     Current prediction: [0, 0]
2025-09-14 20:37:39,186 - root - INFO -     Current confidence: [0.9325401186943054, 0.06745987385511398]
2025-09-14 20:38:20,729 - root - INFO -   DIAGNOSTIC - Sample 3:
2025-09-14 20:38:20,729 - root - INFO -     Avg parameter movement: 0.002974
2025-09-14 20:38:20,730 - root - INFO -     Prediction changed: True
2025-09-14 20:38:20,730 - root - INFO -     Confidence change: 1.307311
2025-09-14 20:38:20,730 - root - INFO -     Current prediction: [1, 1]
2025-09-14 20:38:20,730 - root - INFO -     Current confidence: [0.004696367774158716, 0.9953036308288574]
2025-09-14 20:39:02,280 - root - INFO -   DIAGNOSTIC - Sample 4:
2025-09-14 20:39:02,281 - root - INFO -     Avg parameter movement: 0.003636
2025-09-14 20:39:02,281 - root - INFO -     Prediction changed: True
2025-09-14 20:39:02,281 - root - INFO -     Confidence change: 1.297097
2025-09-14 20:39:02,281 - root - INFO -     Current prediction: [1, 1]
2025-09-14 20:39:02,281 - root - INFO -     Current confidence: [0.011924557387828827, 0.9880753755569458]
2025-09-14 20:39:43,817 - root - INFO -   DIAGNOSTIC - Sample 5:
2025-09-14 20:39:43,818 - root - INFO -     Avg parameter movement: 0.004424
2025-09-14 20:39:43,818 - root - INFO -     Prediction changed: True
2025-09-14 20:39:43,818 - root - INFO -     Confidence change: 1.308030
2025-09-14 20:39:43,818 - root - INFO -     Current prediction: [1, 1]
2025-09-14 20:39:43,818 - root - INFO -     Current confidence: [0.004193061497062445, 0.9958069324493408]
2025-09-14 20:43:11,486 - root - INFO -   DIAGNOSTIC - Sample 10:
2025-09-14 20:43:11,488 - root - INFO -     Avg parameter movement: 0.007246
2025-09-14 20:43:11,488 - root - INFO -     Prediction changed: False
2025-09-14 20:43:11,488 - root - INFO -     Confidence change: 0.023232
2025-09-14 20:43:11,489 - root - INFO -     Current prediction: [0, 1]
2025-09-14 20:43:11,489 - root - INFO -     Current confidence: [0.9454495310783386, 0.05455049127340317]
2025-09-14 20:50:06,093 - root - INFO -   DIAGNOSTIC - Sample 20:
2025-09-14 20:50:06,095 - root - INFO -     Avg parameter movement: 0.012421
2025-09-14 20:50:06,095 - root - INFO -     Prediction changed: True
2025-09-14 20:50:06,095 - root - INFO -     Confidence change: 1.331077
2025-09-14 20:50:06,095 - root - INFO -     Current prediction: [0, 0]
2025-09-14 20:50:06,096 - root - INFO -     Current confidence: [0.9492864608764648, 0.050713568925857544]
2025-09-14 20:50:47,639 - root - INFO - Chain 1, Step 1000:
2025-09-14 20:50:47,641 - root - INFO -   Actual drift norm: 3.99e-03
2025-09-14 20:50:47,641 - root - INFO -   Actual noise norm: 1.46e-03
2025-09-14 20:50:47,641 - root - INFO -   Actual drift/noise ratio: 2.735
2025-09-14 20:50:47,641 - root - INFO -   Theoretical step/noise ratio: 183.972
2025-09-14 20:50:47,641 - root - INFO -   Prior/Likelihood ratio: 8.754
2025-09-14 20:50:47,641 - root - INFO -   SAM rho: 0.050
2025-09-14 20:50:47,641 - root - INFO -   SAM perturbation norm: 4.90e-01
2025-09-14 20:50:47,641 - root - INFO -   SAM gradient norm: 2.77e+00
2025-09-14 20:50:47,641 - root - INFO -   SAM perturbation/gradient ratio: 0.177
2025-09-14 20:50:47,641 - root - INFO -   Rank-1 noise contribution: 0.045
2025-09-14 20:50:47,641 - root - INFO -   Loss change after SAM perturbation: 0.3809
2025-09-14 20:50:47,641 - root - INFO -   Temperature: 2.0
2025-09-14 20:50:47,772 - root - INFO - Sampling step 1000/3000, step_size: 1.44e-03
2025-09-14 20:57:00,598 - root - INFO -   DIAGNOSTIC - Sample 30:
2025-09-14 20:57:00,600 - root - INFO -     Avg parameter movement: 0.017299
2025-09-14 20:57:00,600 - root - INFO -     Prediction changed: True
2025-09-14 20:57:00,600 - root - INFO -     Confidence change: 1.843824
2025-09-14 20:57:00,601 - root - INFO -     Current prediction: [1, 0]
2025-09-14 20:57:00,601 - root - INFO -     Current confidence: [0.006875212304294109, 0.993124783039093]
2025-09-14 21:03:55,117 - root - INFO -   DIAGNOSTIC - Sample 40:
2025-09-14 21:03:55,120 - root - INFO -     Avg parameter movement: 0.022004
2025-09-14 21:03:55,120 - root - INFO -     Prediction changed: True
2025-09-14 21:03:55,120 - root - INFO -     Confidence change: 1.307923
2025-09-14 21:03:55,120 - root - INFO -     Current prediction: [1, 1]
2025-09-14 21:03:55,120 - root - INFO -     Current confidence: [0.004283076152205467, 0.9957168698310852]
2025-09-14 21:04:36,648 - root - INFO - Chain 1, Step 2000:
2025-09-14 21:04:36,649 - root - INFO -   Actual drift norm: 3.37e-03
2025-09-14 21:04:36,649 - root - INFO -   Actual noise norm: 1.46e-03
2025-09-14 21:04:36,649 - root - INFO -   Actual drift/noise ratio: 2.305
2025-09-14 21:04:36,649 - root - INFO -   Theoretical step/noise ratio: 183.972
2025-09-14 21:04:36,649 - root - INFO -   Prior/Likelihood ratio: 6.001
2025-09-14 21:04:36,649 - root - INFO -   SAM rho: 0.050
2025-09-14 21:04:36,649 - root - INFO -   SAM perturbation norm: 4.90e-01
2025-09-14 21:04:36,649 - root - INFO -   SAM gradient norm: 2.34e+00
2025-09-14 21:04:36,649 - root - INFO -   SAM perturbation/gradient ratio: 0.209
2025-09-14 21:04:36,649 - root - INFO -   Rank-1 noise contribution: 0.048
2025-09-14 21:04:36,649 - root - INFO -   Loss change after SAM perturbation: 0.3156
2025-09-14 21:04:36,649 - root - INFO -   Temperature: 2.0
2025-09-14 21:04:36,778 - root - INFO - Sampling step 2000/3000, step_size: 1.44e-03
2025-09-14 21:10:49,669 - root - INFO -   DIAGNOSTIC - Sample 50:
2025-09-14 21:10:49,671 - root - INFO -     Avg parameter movement: 0.026647
2025-09-14 21:10:49,671 - root - INFO -     Prediction changed: True
2025-09-14 21:10:49,671 - root - INFO -     Confidence change: 1.329795
2025-09-14 21:10:49,672 - root - INFO -     Current prediction: [1, 1]
2025-09-14 21:10:49,672 - root - INFO -     Current confidence: [0.004492334555834532, 0.9955077171325684]
2025-09-14 21:17:44,613 - root - INFO -   DIAGNOSTIC - Sample 60:
2025-09-14 21:17:44,615 - root - INFO -     Avg parameter movement: 0.031310
2025-09-14 21:17:44,615 - root - INFO -     Prediction changed: True
2025-09-14 21:17:44,615 - root - INFO -     Confidence change: 1.307242
2025-09-14 21:17:44,616 - root - INFO -     Current prediction: [1, 1]
2025-09-14 21:17:44,616 - root - INFO -     Current confidence: [0.004742894321680069, 0.9952570796012878]
2025-09-14 21:18:25,151 - root - INFO - Chain 1: Collected 60 samples
2025-09-14 21:18:25,195 - root - INFO -   DIAGNOSTIC - Chain 1 summary:
2025-09-14 21:18:25,195 - root - INFO -     Final avg parameter movement: 0.031714
2025-09-14 21:18:25,195 - root - INFO -     Final prediction changed: False
2025-09-14 21:18:25,195 - root - INFO -     Final confidence change: 0.028808
2025-09-14 21:18:25,196 - root - INFO -     Final prediction: [0, 1]
2025-09-14 21:18:25,196 - root - INFO -     Final confidence: [0.9490178823471069, 0.050982169806957245]
2025-09-14 21:18:25,307 - root - INFO - Total samples collected: 60
2025-09-14 21:18:25,308 - root - INFO - Computing overall MCMC diagnostics...
2025-09-14 21:18:25,308 - root - INFO - SAM-SGLD sampling completed with 60 total samples
2025-09-14 21:18:25,495 - root - INFO - Final model after sampling - Loss: 0.1652, Acc: 0.9062
2025-09-14 21:18:25,495 - root - INFO - ESS and R-hat will be computed during evaluation phase
2025-09-14 21:18:26,306 - root - INFO - SAM-SGLD samples saved to runs/mrpc_roberta_lora_samsgld_rank1/samsgld_samples.pth
2025-09-14 21:18:26,307 - root - INFO - Training completed successfully!
Total parameters: 125,829,124
Trainable (LoRA) parameters: 589,824
Frozen (base) parameters: 125,239,300
LoRA ratio: 0.47%
✅ SAM-SGLD LoRA training completed successfully!
=== Phase 2: Evaluating SAM-SGLD LoRA Results ===
2025-09-14 21:18:53,646 - root - INFO - Using device: cuda
2025-09-14 21:18:53,647 - root - INFO - Loading MAP model...
Some weights of RobertaForSequenceClassification were not initialized from the model checkpoint at roberta-base and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2025-09-14 21:18:55,116 - root - INFO - Loading samples...
2025-09-14 21:18:55,117 - root - INFO - Loading samples from: runs/mrpc_roberta_lora_samsgld_rank1/samsgld_samples.pth
2025-09-14 21:18:56,161 - root - INFO - Loaded 60 samples from file
2025-09-14 21:18:56,161 - root - WARNING - No diagnostic values found, will recompute from samples
2025-09-14 21:18:58,119 - root - INFO - Evaluating MAP model...
2025-09-14 21:19:00,887 - root - INFO - Config: chains=1, samples_to_retain=60
2025-09-14 21:19:00,887 - root - INFO - Actual: 60 samples loaded
2025-09-14 21:19:00,887 - root - INFO - Single chain mode: using all 60 samples
2025-09-14 21:19:01,124 - root - INFO - Evaluating sample 1/60
2025-09-14 21:19:03,437 - root - INFO - Evaluating sample 2/60
2025-09-14 21:19:05,744 - root - INFO - Evaluating sample 3/60
2025-09-14 21:19:08,035 - root - INFO - Evaluating sample 4/60
2025-09-14 21:19:10,333 - root - INFO - Evaluating sample 5/60
2025-09-14 21:19:12,631 - root - INFO - Evaluating sample 6/60
2025-09-14 21:19:14,933 - root - INFO - Evaluating sample 7/60
2025-09-14 21:19:17,234 - root - INFO - Evaluating sample 8/60
2025-09-14 21:19:19,537 - root - INFO - Evaluating sample 9/60
2025-09-14 21:19:21,851 - root - INFO - Evaluating sample 10/60
2025-09-14 21:19:24,161 - root - INFO - Evaluating sample 11/60
2025-09-14 21:19:26,473 - root - INFO - Evaluating sample 12/60
2025-09-14 21:19:28,792 - root - INFO - Evaluating sample 13/60
2025-09-14 21:19:31,109 - root - INFO - Evaluating sample 14/60
2025-09-14 21:19:33,426 - root - INFO - Evaluating sample 15/60
2025-09-14 21:19:35,745 - root - INFO - Evaluating sample 16/60
2025-09-14 21:19:38,066 - root - INFO - Evaluating sample 17/60
2025-09-14 21:19:40,388 - root - INFO - Evaluating sample 18/60
2025-09-14 21:19:42,712 - root - INFO - Evaluating sample 19/60
2025-09-14 21:19:45,035 - root - INFO - Evaluating sample 20/60
2025-09-14 21:19:47,358 - root - INFO - Evaluating sample 21/60
2025-09-14 21:19:49,683 - root - INFO - Evaluating sample 22/60
2025-09-14 21:19:52,010 - root - INFO - Evaluating sample 23/60
2025-09-14 21:19:54,344 - root - INFO - Evaluating sample 24/60
2025-09-14 21:19:56,675 - root - INFO - Evaluating sample 25/60
2025-09-14 21:19:59,006 - root - INFO - Evaluating sample 26/60
2025-09-14 21:20:01,342 - root - INFO - Evaluating sample 27/60
2025-09-14 21:20:03,676 - root - INFO - Evaluating sample 28/60
2025-09-14 21:20:06,008 - root - INFO - Evaluating sample 29/60
2025-09-14 21:20:08,345 - root - INFO - Evaluating sample 30/60
2025-09-14 21:20:10,685 - root - INFO - Evaluating sample 31/60
2025-09-14 21:20:13,026 - root - INFO - Evaluating sample 32/60
2025-09-14 21:20:15,366 - root - INFO - Evaluating sample 33/60
2025-09-14 21:20:17,709 - root - INFO - Evaluating sample 34/60
2025-09-14 21:20:20,050 - root - INFO - Evaluating sample 35/60
2025-09-14 21:20:22,392 - root - INFO - Evaluating sample 36/60
2025-09-14 21:20:24,735 - root - INFO - Evaluating sample 37/60
2025-09-14 21:20:27,079 - root - INFO - Evaluating sample 38/60
2025-09-14 21:20:29,425 - root - INFO - Evaluating sample 39/60
2025-09-14 21:20:31,773 - root - INFO - Evaluating sample 40/60
2025-09-14 21:20:34,118 - root - INFO - Evaluating sample 41/60
2025-09-14 21:20:36,468 - root - INFO - Evaluating sample 42/60
2025-09-14 21:20:38,818 - root - INFO - Evaluating sample 43/60
2025-09-14 21:20:41,166 - root - INFO - Evaluating sample 44/60
2025-09-14 21:20:43,511 - root - INFO - Evaluating sample 45/60
2025-09-14 21:20:45,861 - root - INFO - Evaluating sample 46/60
2025-09-14 21:20:48,214 - root - INFO - Evaluating sample 47/60
2025-09-14 21:20:50,568 - root - INFO - Evaluating sample 48/60
2025-09-14 21:20:52,922 - root - INFO - Evaluating sample 49/60
2025-09-14 21:20:55,274 - root - INFO - Evaluating sample 50/60
2025-09-14 21:20:57,627 - root - INFO - Evaluating sample 51/60
2025-09-14 21:20:59,984 - root - INFO - Evaluating sample 52/60
2025-09-14 21:21:02,341 - root - INFO - Evaluating sample 53/60
2025-09-14 21:21:04,700 - root - INFO - Evaluating sample 54/60
2025-09-14 21:21:07,059 - root - INFO - Evaluating sample 55/60
2025-09-14 21:21:09,418 - root - INFO - Evaluating sample 56/60
2025-09-14 21:21:11,776 - root - INFO - Evaluating sample 57/60
2025-09-14 21:21:14,135 - root - INFO - Evaluating sample 58/60
2025-09-14 21:21:16,493 - root - INFO - Evaluating sample 59/60
2025-09-14 21:21:18,855 - root - INFO - Evaluating sample 60/60
2025-09-14 21:21:21,238 - root - INFO - Recomputing diagnostic values from samples
2025-09-14 21:21:21,469 - root - INFO - 
==================================================
2025-09-14 21:21:21,469 - root - INFO - EVALUATION RESULTS
2025-09-14 21:21:21,469 - root - INFO - ==================================================
2025-09-14 21:21:21,469 - root - INFO - Method          Accuracy   NLL        ECE       
2025-09-14 21:21:21,469 - root - INFO - --------------------------------------------------
2025-09-14 21:21:21,469 - root - INFO - MAP-LoRA        0.8603     0.5030     0.1024    
2025-09-14 21:21:21,469 - root - INFO - SAM-SGLD-LoRA   0.8799     0.3281     0.0525    
2025-09-14 21:21:21,469 - root - INFO - 
MCMC Diagnostics:
2025-09-14 21:21:21,469 - root - INFO - R-hat (log posterior): 1.0000
2025-09-14 21:21:21,469 - root - INFO - R-hat (L2 norm): 1.0000
2025-09-14 21:21:21,469 - root - INFO - ESS (log posterior): 29
2025-09-14 21:21:21,469 - root - INFO - ESS (L2 norm): 3
2025-09-14 21:21:21,469 - root - INFO - Min ESS: 3
2025-09-14 21:21:21,470 - root - INFO - 
Multimodal MCMC Quality Assessment:
2025-09-14 21:21:21,470 - root - INFO - R-hat (log posterior): 1.000
2025-09-14 21:21:21,470 - root - INFO - R-hat (L2 norm): 1.000
2025-09-14 21:21:21,470 - root - INFO - Multimodal R-hat (1.1 < R-hat < 3.0): ⚠️  CHECK
2025-09-14 21:21:21,470 - root - INFO - 
Within-mode mixing:
2025-09-14 21:21:21,470 - root - INFO - Avg ESS (log posterior): 29.0 ± 0.0
2025-09-14 21:21:21,470 - root - INFO - Avg ESS (L2 norm): 3.0 ± 0.0
2025-09-14 21:21:21,470 - root - INFO - Within-mode mixing (ESS ≥ 12.5): ⚠️  NEEDS IMPROVEMENT
2025-09-14 21:21:21,470 - root - INFO - 
ESS Statistics Summary:
2025-09-14 21:21:21,470 - root - INFO -   Log Posterior ESS: 29 (min), 29.0 ± 0.0 (mean ± std)
2025-09-14 21:21:21,470 - root - INFO -   L2 Norm ESS: 3 (min), 3.0 ± 0.0 (mean ± std)
2025-09-14 21:21:21,470 - root - INFO - 
ESS Variability Interpretation:
2025-09-14 21:21:21,470 - root - INFO -   • Log posterior ESS is consistent across modes (std=0.0) - uniform mixing quality
2025-09-14 21:21:21,470 - root - INFO -   • L2 norm ESS is consistent across modes (std=0.0) - uniform parameter space mixing
2025-09-14 21:21:21,471 - root - INFO - 
Per-chain ESS details:
2025-09-14 21:21:21,471 - root - INFO -   Chain 1: ESS(log_posterior)=29, ESS(l2_norm)=3
2025-09-14 21:21:21,471 - root - INFO - 
Overall Multimodal Quality: ⚠️  NEEDS IMPROVEMENT
2025-09-14 21:21:21,471 - root - WARNING - R-hat values suggest chains may be in the same mode (not multimodal)
2025-09-14 21:21:21,471 - root - WARNING - Within-mode ESS is low - samples within each mode are too correlated
2025-09-14 21:21:21,471 - root - INFO - 
Multimodal Pass/Fail Criteria Assessment:
2025-09-14 21:21:21,471 - root - INFO -   Multimodal R-hat (1.1 < R-hat < 3.0): ❌ FAIL
2025-09-14 21:21:21,471 - root - INFO -   Within-mode ESS ≥ 12.5: ❌ FAIL
2025-09-14 21:21:21,471 - root - INFO -   Accuracy within ±0.3% of MAP: ❌ FAIL (diff: 0.0196)
2025-09-14 21:21:21,471 - root - INFO -   NLL lower than MAP: ✅ PASS (SAM-SGLD-LoRA: 0.3281, MAP: 0.5030)
2025-09-14 21:21:21,471 - root - INFO -   ECE lower than MAP: ✅ PASS (SAM-SGLD-LoRA: 0.0525, MAP: 0.1024)
2025-09-14 21:21:21,471 - root - INFO - 
Overall Multimodal Convergence Assessment: ⚠️  FAIL
2025-09-14 21:21:21,471 - root - WARNING - Multimodal convergence criteria not met. Consider:
2025-09-14 21:21:21,471 - root - WARNING -   - Chains are in same mode - increase step size or reduce prior strength
2025-09-14 21:21:21,472 - root - WARNING -   - Within-mode mixing is poor - reduce step size or increase sampling steps
2025-09-14 21:21:21,472 - root - WARNING -   - Check if SAM-SGLD-LoRA is learning properly
2025-09-14 21:21:21,476 - root - INFO - 
Results saved to runs/mrpc_roberta_lora_samsgld_rank1/evaluation_results.yaml
Total parameters: 125,829,124
Trainable (LoRA) parameters: 589,824
Frozen (base) parameters: 125,239,300
LoRA ratio: 0.47%
✅ SAM-SGLD LoRA evaluation completed successfully!
=== SAM-SGLD LoRA experiment completed successfully! ===
Results saved to: runs/mrpc_roberta_lora_samsgld_rank1/
Job completed at: Sun Sep 14 21:21:22 CDT 2025
