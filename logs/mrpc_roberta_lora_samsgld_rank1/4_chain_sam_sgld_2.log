=== GPU Information ===
Tue Sep 16 18:59:01 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 575.57.08              Driver Version: 575.57.08      CUDA Version: 12.9     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA A10                     Off |   00000000:C8:00.0 Off |                    0 |
|  0%   33C    P8             15W /  150W |       0MiB /  23028MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI              PID   Type   Process name                        GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+
=== Memory Information ===
               total        used        free      shared  buff/cache   available
Mem:           503Gi        26Gi       391Gi        15Gi       103Gi       477Gi
Swap:             0B          0B          0B
=== Current Directory ===
/u/nalint2/scratch/Bayesian-LORA
=== Python Version ===
Python 3.9.18
=== Setting up environment ===
=== Upgrading pip to fix version issues ===
Requirement already satisfied: pip in ./.venv/lib/python3.9/site-packages (25.2)
=== Installing dependencies ===
Installing package in editable mode...
Obtaining file:///scratch/nalint2/Bayesian-LORA
  Installing build dependencies: started
  Installing build dependencies: finished with status 'done'
  Checking if build backend supports build_editable: started
  Checking if build backend supports build_editable: finished with status 'done'
  Getting requirements to build editable: started
  Getting requirements to build editable: finished with status 'done'
  Preparing editable metadata (pyproject.toml): started
  Preparing editable metadata (pyproject.toml): finished with status 'done'
Requirement already satisfied: torch>=2.0.0 in ./.venv/lib/python3.9/site-packages (from Bayesian-LORA==0.1.0) (2.8.0)
Requirement already satisfied: torchvision in ./.venv/lib/python3.9/site-packages (from Bayesian-LORA==0.1.0) (0.23.0)
Requirement already satisfied: numpy in ./.venv/lib/python3.9/site-packages (from Bayesian-LORA==0.1.0) (2.0.2)
Requirement already satisfied: tqdm in ./.venv/lib/python3.9/site-packages (from Bayesian-LORA==0.1.0) (4.67.1)
Requirement already satisfied: pyyaml in ./.venv/lib/python3.9/site-packages (from Bayesian-LORA==0.1.0) (6.0.2)
Requirement already satisfied: scikit-learn in ./.venv/lib/python3.9/site-packages (from Bayesian-LORA==0.1.0) (1.6.1)
Requirement already satisfied: scipy in ./.venv/lib/python3.9/site-packages (from Bayesian-LORA==0.1.0) (1.13.1)
Requirement already satisfied: matplotlib in ./.venv/lib/python3.9/site-packages (from Bayesian-LORA==0.1.0) (3.9.4)
Requirement already satisfied: transformers>=4.30.0 in ./.venv/lib/python3.9/site-packages (from Bayesian-LORA==0.1.0) (4.56.0)
Requirement already satisfied: datasets>=2.12.0 in ./.venv/lib/python3.9/site-packages (from Bayesian-LORA==0.1.0) (4.0.0)
Requirement already satisfied: tokenizers>=0.13.0 in ./.venv/lib/python3.9/site-packages (from Bayesian-LORA==0.1.0) (0.22.0)
Requirement already satisfied: peft>=0.4.0 in ./.venv/lib/python3.9/site-packages (from Bayesian-LORA==0.1.0) (0.17.1)
Requirement already satisfied: accelerate>=0.20.0 in ./.venv/lib/python3.9/site-packages (from Bayesian-LORA==0.1.0) (1.10.1)
Requirement already satisfied: sentencepiece in ./.venv/lib/python3.9/site-packages (from Bayesian-LORA==0.1.0) (0.2.1)
Requirement already satisfied: protobuf in ./.venv/lib/python3.9/site-packages (from Bayesian-LORA==0.1.0) (6.32.0)
Requirement already satisfied: packaging>=20.0 in ./.venv/lib/python3.9/site-packages (from accelerate>=0.20.0->Bayesian-LORA==0.1.0) (25.0)
Requirement already satisfied: psutil in ./.venv/lib/python3.9/site-packages (from accelerate>=0.20.0->Bayesian-LORA==0.1.0) (7.0.0)
Requirement already satisfied: huggingface_hub>=0.21.0 in ./.venv/lib/python3.9/site-packages (from accelerate>=0.20.0->Bayesian-LORA==0.1.0) (0.34.4)
Requirement already satisfied: safetensors>=0.4.3 in ./.venv/lib/python3.9/site-packages (from accelerate>=0.20.0->Bayesian-LORA==0.1.0) (0.6.2)
Requirement already satisfied: filelock in ./.venv/lib/python3.9/site-packages (from datasets>=2.12.0->Bayesian-LORA==0.1.0) (3.19.1)
Requirement already satisfied: pyarrow>=15.0.0 in ./.venv/lib/python3.9/site-packages (from datasets>=2.12.0->Bayesian-LORA==0.1.0) (21.0.0)
Requirement already satisfied: dill<0.3.9,>=0.3.0 in ./.venv/lib/python3.9/site-packages (from datasets>=2.12.0->Bayesian-LORA==0.1.0) (0.3.8)
Requirement already satisfied: pandas in ./.venv/lib/python3.9/site-packages (from datasets>=2.12.0->Bayesian-LORA==0.1.0) (2.3.2)
Requirement already satisfied: requests>=2.32.2 in ./.venv/lib/python3.9/site-packages (from datasets>=2.12.0->Bayesian-LORA==0.1.0) (2.32.5)
Requirement already satisfied: xxhash in ./.venv/lib/python3.9/site-packages (from datasets>=2.12.0->Bayesian-LORA==0.1.0) (3.5.0)
Requirement already satisfied: multiprocess<0.70.17 in ./.venv/lib/python3.9/site-packages (from datasets>=2.12.0->Bayesian-LORA==0.1.0) (0.70.16)
Requirement already satisfied: fsspec<=2025.3.0,>=2023.1.0 in ./.venv/lib/python3.9/site-packages (from fsspec[http]<=2025.3.0,>=2023.1.0->datasets>=2.12.0->Bayesian-LORA==0.1.0) (2025.3.0)
Requirement already satisfied: aiohttp!=4.0.0a0,!=4.0.0a1 in ./.venv/lib/python3.9/site-packages (from fsspec[http]<=2025.3.0,>=2023.1.0->datasets>=2.12.0->Bayesian-LORA==0.1.0) (3.12.15)
Requirement already satisfied: aiohappyeyeballs>=2.5.0 in ./.venv/lib/python3.9/site-packages (from aiohttp!=4.0.0a0,!=4.0.0a1->fsspec[http]<=2025.3.0,>=2023.1.0->datasets>=2.12.0->Bayesian-LORA==0.1.0) (2.6.1)
Requirement already satisfied: aiosignal>=1.4.0 in ./.venv/lib/python3.9/site-packages (from aiohttp!=4.0.0a0,!=4.0.0a1->fsspec[http]<=2025.3.0,>=2023.1.0->datasets>=2.12.0->Bayesian-LORA==0.1.0) (1.4.0)
Requirement already satisfied: async-timeout<6.0,>=4.0 in ./.venv/lib/python3.9/site-packages (from aiohttp!=4.0.0a0,!=4.0.0a1->fsspec[http]<=2025.3.0,>=2023.1.0->datasets>=2.12.0->Bayesian-LORA==0.1.0) (5.0.1)
Requirement already satisfied: attrs>=17.3.0 in ./.venv/lib/python3.9/site-packages (from aiohttp!=4.0.0a0,!=4.0.0a1->fsspec[http]<=2025.3.0,>=2023.1.0->datasets>=2.12.0->Bayesian-LORA==0.1.0) (25.3.0)
Requirement already satisfied: frozenlist>=1.1.1 in ./.venv/lib/python3.9/site-packages (from aiohttp!=4.0.0a0,!=4.0.0a1->fsspec[http]<=2025.3.0,>=2023.1.0->datasets>=2.12.0->Bayesian-LORA==0.1.0) (1.7.0)
Requirement already satisfied: multidict<7.0,>=4.5 in ./.venv/lib/python3.9/site-packages (from aiohttp!=4.0.0a0,!=4.0.0a1->fsspec[http]<=2025.3.0,>=2023.1.0->datasets>=2.12.0->Bayesian-LORA==0.1.0) (6.6.4)
Requirement already satisfied: propcache>=0.2.0 in ./.venv/lib/python3.9/site-packages (from aiohttp!=4.0.0a0,!=4.0.0a1->fsspec[http]<=2025.3.0,>=2023.1.0->datasets>=2.12.0->Bayesian-LORA==0.1.0) (0.3.2)
Requirement already satisfied: yarl<2.0,>=1.17.0 in ./.venv/lib/python3.9/site-packages (from aiohttp!=4.0.0a0,!=4.0.0a1->fsspec[http]<=2025.3.0,>=2023.1.0->datasets>=2.12.0->Bayesian-LORA==0.1.0) (1.20.1)
Requirement already satisfied: typing-extensions>=4.1.0 in ./.venv/lib/python3.9/site-packages (from multidict<7.0,>=4.5->aiohttp!=4.0.0a0,!=4.0.0a1->fsspec[http]<=2025.3.0,>=2023.1.0->datasets>=2.12.0->Bayesian-LORA==0.1.0) (4.15.0)
Requirement already satisfied: idna>=2.0 in ./.venv/lib/python3.9/site-packages (from yarl<2.0,>=1.17.0->aiohttp!=4.0.0a0,!=4.0.0a1->fsspec[http]<=2025.3.0,>=2023.1.0->datasets>=2.12.0->Bayesian-LORA==0.1.0) (3.10)
Requirement already satisfied: hf-xet<2.0.0,>=1.1.3 in ./.venv/lib/python3.9/site-packages (from huggingface_hub>=0.21.0->accelerate>=0.20.0->Bayesian-LORA==0.1.0) (1.1.9)
Requirement already satisfied: charset_normalizer<4,>=2 in ./.venv/lib/python3.9/site-packages (from requests>=2.32.2->datasets>=2.12.0->Bayesian-LORA==0.1.0) (3.4.3)
Requirement already satisfied: urllib3<3,>=1.21.1 in ./.venv/lib/python3.9/site-packages (from requests>=2.32.2->datasets>=2.12.0->Bayesian-LORA==0.1.0) (2.5.0)
Requirement already satisfied: certifi>=2017.4.17 in ./.venv/lib/python3.9/site-packages (from requests>=2.32.2->datasets>=2.12.0->Bayesian-LORA==0.1.0) (2025.8.3)
Requirement already satisfied: sympy>=1.13.3 in ./.venv/lib/python3.9/site-packages (from torch>=2.0.0->Bayesian-LORA==0.1.0) (1.14.0)
Requirement already satisfied: networkx in ./.venv/lib/python3.9/site-packages (from torch>=2.0.0->Bayesian-LORA==0.1.0) (3.2.1)
Requirement already satisfied: jinja2 in ./.venv/lib/python3.9/site-packages (from torch>=2.0.0->Bayesian-LORA==0.1.0) (3.1.6)
Requirement already satisfied: nvidia-cuda-nvrtc-cu12==12.8.93 in ./.venv/lib/python3.9/site-packages (from torch>=2.0.0->Bayesian-LORA==0.1.0) (12.8.93)
Requirement already satisfied: nvidia-cuda-runtime-cu12==12.8.90 in ./.venv/lib/python3.9/site-packages (from torch>=2.0.0->Bayesian-LORA==0.1.0) (12.8.90)
Requirement already satisfied: nvidia-cuda-cupti-cu12==12.8.90 in ./.venv/lib/python3.9/site-packages (from torch>=2.0.0->Bayesian-LORA==0.1.0) (12.8.90)
Requirement already satisfied: nvidia-cudnn-cu12==9.10.2.21 in ./.venv/lib/python3.9/site-packages (from torch>=2.0.0->Bayesian-LORA==0.1.0) (9.10.2.21)
Requirement already satisfied: nvidia-cublas-cu12==12.8.4.1 in ./.venv/lib/python3.9/site-packages (from torch>=2.0.0->Bayesian-LORA==0.1.0) (12.8.4.1)
Requirement already satisfied: nvidia-cufft-cu12==11.3.3.83 in ./.venv/lib/python3.9/site-packages (from torch>=2.0.0->Bayesian-LORA==0.1.0) (11.3.3.83)
Requirement already satisfied: nvidia-curand-cu12==10.3.9.90 in ./.venv/lib/python3.9/site-packages (from torch>=2.0.0->Bayesian-LORA==0.1.0) (10.3.9.90)
Requirement already satisfied: nvidia-cusolver-cu12==11.7.3.90 in ./.venv/lib/python3.9/site-packages (from torch>=2.0.0->Bayesian-LORA==0.1.0) (11.7.3.90)
Requirement already satisfied: nvidia-cusparse-cu12==12.5.8.93 in ./.venv/lib/python3.9/site-packages (from torch>=2.0.0->Bayesian-LORA==0.1.0) (12.5.8.93)
Requirement already satisfied: nvidia-cusparselt-cu12==0.7.1 in ./.venv/lib/python3.9/site-packages (from torch>=2.0.0->Bayesian-LORA==0.1.0) (0.7.1)
Requirement already satisfied: nvidia-nccl-cu12==2.27.3 in ./.venv/lib/python3.9/site-packages (from torch>=2.0.0->Bayesian-LORA==0.1.0) (2.27.3)
Requirement already satisfied: nvidia-nvtx-cu12==12.8.90 in ./.venv/lib/python3.9/site-packages (from torch>=2.0.0->Bayesian-LORA==0.1.0) (12.8.90)
Requirement already satisfied: nvidia-nvjitlink-cu12==12.8.93 in ./.venv/lib/python3.9/site-packages (from torch>=2.0.0->Bayesian-LORA==0.1.0) (12.8.93)
Requirement already satisfied: nvidia-cufile-cu12==1.13.1.3 in ./.venv/lib/python3.9/site-packages (from torch>=2.0.0->Bayesian-LORA==0.1.0) (1.13.1.3)
Requirement already satisfied: triton==3.4.0 in ./.venv/lib/python3.9/site-packages (from torch>=2.0.0->Bayesian-LORA==0.1.0) (3.4.0)
Requirement already satisfied: setuptools>=40.8.0 in ./.venv/lib/python3.9/site-packages (from triton==3.4.0->torch>=2.0.0->Bayesian-LORA==0.1.0) (53.0.0)
Requirement already satisfied: importlib-metadata in ./.venv/lib/python3.9/site-packages (from triton==3.4.0->torch>=2.0.0->Bayesian-LORA==0.1.0) (8.7.0)
Requirement already satisfied: mpmath<1.4,>=1.1.0 in ./.venv/lib/python3.9/site-packages (from sympy>=1.13.3->torch>=2.0.0->Bayesian-LORA==0.1.0) (1.3.0)
Requirement already satisfied: regex!=2019.12.17 in ./.venv/lib/python3.9/site-packages (from transformers>=4.30.0->Bayesian-LORA==0.1.0) (2025.9.1)
Requirement already satisfied: zipp>=3.20 in ./.venv/lib/python3.9/site-packages (from importlib-metadata->triton==3.4.0->torch>=2.0.0->Bayesian-LORA==0.1.0) (3.23.0)
Requirement already satisfied: MarkupSafe>=2.0 in ./.venv/lib/python3.9/site-packages (from jinja2->torch>=2.0.0->Bayesian-LORA==0.1.0) (3.0.2)
Requirement already satisfied: contourpy>=1.0.1 in ./.venv/lib/python3.9/site-packages (from matplotlib->Bayesian-LORA==0.1.0) (1.3.0)
Requirement already satisfied: cycler>=0.10 in ./.venv/lib/python3.9/site-packages (from matplotlib->Bayesian-LORA==0.1.0) (0.12.1)
Requirement already satisfied: fonttools>=4.22.0 in ./.venv/lib/python3.9/site-packages (from matplotlib->Bayesian-LORA==0.1.0) (4.59.2)
Requirement already satisfied: kiwisolver>=1.3.1 in ./.venv/lib/python3.9/site-packages (from matplotlib->Bayesian-LORA==0.1.0) (1.4.7)
Requirement already satisfied: pillow>=8 in ./.venv/lib/python3.9/site-packages (from matplotlib->Bayesian-LORA==0.1.0) (11.3.0)
Requirement already satisfied: pyparsing>=2.3.1 in ./.venv/lib/python3.9/site-packages (from matplotlib->Bayesian-LORA==0.1.0) (3.2.3)
Requirement already satisfied: python-dateutil>=2.7 in ./.venv/lib/python3.9/site-packages (from matplotlib->Bayesian-LORA==0.1.0) (2.9.0.post0)
Requirement already satisfied: importlib-resources>=3.2.0 in ./.venv/lib/python3.9/site-packages (from matplotlib->Bayesian-LORA==0.1.0) (6.5.2)
Requirement already satisfied: six>=1.5 in ./.venv/lib/python3.9/site-packages (from python-dateutil>=2.7->matplotlib->Bayesian-LORA==0.1.0) (1.17.0)
Requirement already satisfied: pytz>=2020.1 in ./.venv/lib/python3.9/site-packages (from pandas->datasets>=2.12.0->Bayesian-LORA==0.1.0) (2025.2)
Requirement already satisfied: tzdata>=2022.7 in ./.venv/lib/python3.9/site-packages (from pandas->datasets>=2.12.0->Bayesian-LORA==0.1.0) (2025.2)
Requirement already satisfied: joblib>=1.2.0 in ./.venv/lib/python3.9/site-packages (from scikit-learn->Bayesian-LORA==0.1.0) (1.5.2)
Requirement already satisfied: threadpoolctl>=3.1.0 in ./.venv/lib/python3.9/site-packages (from scikit-learn->Bayesian-LORA==0.1.0) (3.6.0)
Building wheels for collected packages: Bayesian-LORA
  Building editable for Bayesian-LORA (pyproject.toml): started
  Building editable for Bayesian-LORA (pyproject.toml): finished with status 'done'
  Created wheel for Bayesian-LORA: filename=bayesian_lora-0.1.0-0.editable-py3-none-any.whl size=1457 sha256=e3066c883a86ec23f578647d646897fec3844666596c7fb20ab52e9154fb4741
  Stored in directory: /tmp/pip-ephem-wheel-cache-jk549u_7/wheels/e6/8c/54/9ced548b41650fdd37110b7a4079fec5aecbe008507cf13c8d
Successfully built Bayesian-LORA
Installing collected packages: Bayesian-LORA
  Attempting uninstall: Bayesian-LORA
    Found existing installation: Bayesian-LORA 0.1.0
    Uninstalling Bayesian-LORA-0.1.0:
      Successfully uninstalled Bayesian-LORA-0.1.0
Successfully installed Bayesian-LORA-0.1.0
=== Verifying pip installation ===
Name: Bayesian-LORA
Version: 0.1.0
Summary: Bayesian inference for Low-Rank Adaptation of Large Language Models
Home-page: 
Author: Bayesian LoRA Team
Author-email: 
License: 
Location: /scratch/nalint2/Bayesian-LORA/.venv/lib/python3.9/site-packages
Editable project location: /scratch/nalint2/Bayesian-LORA
Requires: accelerate, datasets, matplotlib, numpy, peft, protobuf, pyyaml, scikit-learn, scipy, sentencepiece, tokenizers, torch, torchvision, tqdm, transformers
Required-by: 
=== Verifying installation ===
Testing package installation status...
=== Testing bayesian_lora import ===
Python path: ['', '/usr/lib64/python39.zip', '/usr/lib64/python3.9']...
✅ bayesian_lora module imported successfully!
Version: 0.1.0
Author: Bayesian LoRA Team
Module location: /scratch/nalint2/Bayesian-LORA/src/bayesian_lora/__init__.py
✅ Package installation verified successfully!
=== Installing additional requirements ===
Requirement already satisfied: torch>=2.0.0 in ./.venv/lib/python3.9/site-packages (from -r requirements_lora.txt (line 2)) (2.8.0)
Requirement already satisfied: torchvision in ./.venv/lib/python3.9/site-packages (from -r requirements_lora.txt (line 3)) (0.23.0)
Requirement already satisfied: numpy in ./.venv/lib/python3.9/site-packages (from -r requirements_lora.txt (line 4)) (2.0.2)
Requirement already satisfied: tqdm in ./.venv/lib/python3.9/site-packages (from -r requirements_lora.txt (line 5)) (4.67.1)
Requirement already satisfied: pyyaml in ./.venv/lib/python3.9/site-packages (from -r requirements_lora.txt (line 6)) (6.0.2)
Requirement already satisfied: scikit-learn in ./.venv/lib/python3.9/site-packages (from -r requirements_lora.txt (line 7)) (1.6.1)
Requirement already satisfied: scipy in ./.venv/lib/python3.9/site-packages (from -r requirements_lora.txt (line 8)) (1.13.1)
Requirement already satisfied: matplotlib in ./.venv/lib/python3.9/site-packages (from -r requirements_lora.txt (line 9)) (3.9.4)
Requirement already satisfied: transformers>=4.30.0 in ./.venv/lib/python3.9/site-packages (from -r requirements_lora.txt (line 12)) (4.56.0)
Requirement already satisfied: datasets>=2.12.0 in ./.venv/lib/python3.9/site-packages (from -r requirements_lora.txt (line 13)) (4.0.0)
Requirement already satisfied: tokenizers>=0.13.0 in ./.venv/lib/python3.9/site-packages (from -r requirements_lora.txt (line 14)) (0.22.0)
Requirement already satisfied: peft>=0.4.0 in ./.venv/lib/python3.9/site-packages (from -r requirements_lora.txt (line 15)) (0.17.1)
Requirement already satisfied: accelerate>=0.20.0 in ./.venv/lib/python3.9/site-packages (from -r requirements_lora.txt (line 18)) (1.10.1)
Requirement already satisfied: sentencepiece in ./.venv/lib/python3.9/site-packages (from -r requirements_lora.txt (line 19)) (0.2.1)
Requirement already satisfied: protobuf in ./.venv/lib/python3.9/site-packages (from -r requirements_lora.txt (line 20)) (6.32.0)
Requirement already satisfied: filelock in ./.venv/lib/python3.9/site-packages (from torch>=2.0.0->-r requirements_lora.txt (line 2)) (3.19.1)
Requirement already satisfied: typing-extensions>=4.10.0 in ./.venv/lib/python3.9/site-packages (from torch>=2.0.0->-r requirements_lora.txt (line 2)) (4.15.0)
Requirement already satisfied: sympy>=1.13.3 in ./.venv/lib/python3.9/site-packages (from torch>=2.0.0->-r requirements_lora.txt (line 2)) (1.14.0)
Requirement already satisfied: networkx in ./.venv/lib/python3.9/site-packages (from torch>=2.0.0->-r requirements_lora.txt (line 2)) (3.2.1)
Requirement already satisfied: jinja2 in ./.venv/lib/python3.9/site-packages (from torch>=2.0.0->-r requirements_lora.txt (line 2)) (3.1.6)
Requirement already satisfied: fsspec in ./.venv/lib/python3.9/site-packages (from torch>=2.0.0->-r requirements_lora.txt (line 2)) (2025.3.0)
Requirement already satisfied: nvidia-cuda-nvrtc-cu12==12.8.93 in ./.venv/lib/python3.9/site-packages (from torch>=2.0.0->-r requirements_lora.txt (line 2)) (12.8.93)
Requirement already satisfied: nvidia-cuda-runtime-cu12==12.8.90 in ./.venv/lib/python3.9/site-packages (from torch>=2.0.0->-r requirements_lora.txt (line 2)) (12.8.90)
Requirement already satisfied: nvidia-cuda-cupti-cu12==12.8.90 in ./.venv/lib/python3.9/site-packages (from torch>=2.0.0->-r requirements_lora.txt (line 2)) (12.8.90)
Requirement already satisfied: nvidia-cudnn-cu12==9.10.2.21 in ./.venv/lib/python3.9/site-packages (from torch>=2.0.0->-r requirements_lora.txt (line 2)) (9.10.2.21)
Requirement already satisfied: nvidia-cublas-cu12==12.8.4.1 in ./.venv/lib/python3.9/site-packages (from torch>=2.0.0->-r requirements_lora.txt (line 2)) (12.8.4.1)
Requirement already satisfied: nvidia-cufft-cu12==11.3.3.83 in ./.venv/lib/python3.9/site-packages (from torch>=2.0.0->-r requirements_lora.txt (line 2)) (11.3.3.83)
Requirement already satisfied: nvidia-curand-cu12==10.3.9.90 in ./.venv/lib/python3.9/site-packages (from torch>=2.0.0->-r requirements_lora.txt (line 2)) (10.3.9.90)
Requirement already satisfied: nvidia-cusolver-cu12==11.7.3.90 in ./.venv/lib/python3.9/site-packages (from torch>=2.0.0->-r requirements_lora.txt (line 2)) (11.7.3.90)
Requirement already satisfied: nvidia-cusparse-cu12==12.5.8.93 in ./.venv/lib/python3.9/site-packages (from torch>=2.0.0->-r requirements_lora.txt (line 2)) (12.5.8.93)
Requirement already satisfied: nvidia-cusparselt-cu12==0.7.1 in ./.venv/lib/python3.9/site-packages (from torch>=2.0.0->-r requirements_lora.txt (line 2)) (0.7.1)
Requirement already satisfied: nvidia-nccl-cu12==2.27.3 in ./.venv/lib/python3.9/site-packages (from torch>=2.0.0->-r requirements_lora.txt (line 2)) (2.27.3)
Requirement already satisfied: nvidia-nvtx-cu12==12.8.90 in ./.venv/lib/python3.9/site-packages (from torch>=2.0.0->-r requirements_lora.txt (line 2)) (12.8.90)
Requirement already satisfied: nvidia-nvjitlink-cu12==12.8.93 in ./.venv/lib/python3.9/site-packages (from torch>=2.0.0->-r requirements_lora.txt (line 2)) (12.8.93)
Requirement already satisfied: nvidia-cufile-cu12==1.13.1.3 in ./.venv/lib/python3.9/site-packages (from torch>=2.0.0->-r requirements_lora.txt (line 2)) (1.13.1.3)
Requirement already satisfied: triton==3.4.0 in ./.venv/lib/python3.9/site-packages (from torch>=2.0.0->-r requirements_lora.txt (line 2)) (3.4.0)
Requirement already satisfied: setuptools>=40.8.0 in ./.venv/lib/python3.9/site-packages (from triton==3.4.0->torch>=2.0.0->-r requirements_lora.txt (line 2)) (53.0.0)
Requirement already satisfied: importlib-metadata in ./.venv/lib/python3.9/site-packages (from triton==3.4.0->torch>=2.0.0->-r requirements_lora.txt (line 2)) (8.7.0)
Requirement already satisfied: pillow!=8.3.*,>=5.3.0 in ./.venv/lib/python3.9/site-packages (from torchvision->-r requirements_lora.txt (line 3)) (11.3.0)
Requirement already satisfied: joblib>=1.2.0 in ./.venv/lib/python3.9/site-packages (from scikit-learn->-r requirements_lora.txt (line 7)) (1.5.2)
Requirement already satisfied: threadpoolctl>=3.1.0 in ./.venv/lib/python3.9/site-packages (from scikit-learn->-r requirements_lora.txt (line 7)) (3.6.0)
Requirement already satisfied: contourpy>=1.0.1 in ./.venv/lib/python3.9/site-packages (from matplotlib->-r requirements_lora.txt (line 9)) (1.3.0)
Requirement already satisfied: cycler>=0.10 in ./.venv/lib/python3.9/site-packages (from matplotlib->-r requirements_lora.txt (line 9)) (0.12.1)
Requirement already satisfied: fonttools>=4.22.0 in ./.venv/lib/python3.9/site-packages (from matplotlib->-r requirements_lora.txt (line 9)) (4.59.2)
Requirement already satisfied: kiwisolver>=1.3.1 in ./.venv/lib/python3.9/site-packages (from matplotlib->-r requirements_lora.txt (line 9)) (1.4.7)
Requirement already satisfied: packaging>=20.0 in ./.venv/lib/python3.9/site-packages (from matplotlib->-r requirements_lora.txt (line 9)) (25.0)
Requirement already satisfied: pyparsing>=2.3.1 in ./.venv/lib/python3.9/site-packages (from matplotlib->-r requirements_lora.txt (line 9)) (3.2.3)
Requirement already satisfied: python-dateutil>=2.7 in ./.venv/lib/python3.9/site-packages (from matplotlib->-r requirements_lora.txt (line 9)) (2.9.0.post0)
Requirement already satisfied: importlib-resources>=3.2.0 in ./.venv/lib/python3.9/site-packages (from matplotlib->-r requirements_lora.txt (line 9)) (6.5.2)
Requirement already satisfied: huggingface-hub<1.0,>=0.34.0 in ./.venv/lib/python3.9/site-packages (from transformers>=4.30.0->-r requirements_lora.txt (line 12)) (0.34.4)
Requirement already satisfied: regex!=2019.12.17 in ./.venv/lib/python3.9/site-packages (from transformers>=4.30.0->-r requirements_lora.txt (line 12)) (2025.9.1)
Requirement already satisfied: requests in ./.venv/lib/python3.9/site-packages (from transformers>=4.30.0->-r requirements_lora.txt (line 12)) (2.32.5)
Requirement already satisfied: safetensors>=0.4.3 in ./.venv/lib/python3.9/site-packages (from transformers>=4.30.0->-r requirements_lora.txt (line 12)) (0.6.2)
Requirement already satisfied: hf-xet<2.0.0,>=1.1.3 in ./.venv/lib/python3.9/site-packages (from huggingface-hub<1.0,>=0.34.0->transformers>=4.30.0->-r requirements_lora.txt (line 12)) (1.1.9)
Requirement already satisfied: pyarrow>=15.0.0 in ./.venv/lib/python3.9/site-packages (from datasets>=2.12.0->-r requirements_lora.txt (line 13)) (21.0.0)
Requirement already satisfied: dill<0.3.9,>=0.3.0 in ./.venv/lib/python3.9/site-packages (from datasets>=2.12.0->-r requirements_lora.txt (line 13)) (0.3.8)
Requirement already satisfied: pandas in ./.venv/lib/python3.9/site-packages (from datasets>=2.12.0->-r requirements_lora.txt (line 13)) (2.3.2)
Requirement already satisfied: xxhash in ./.venv/lib/python3.9/site-packages (from datasets>=2.12.0->-r requirements_lora.txt (line 13)) (3.5.0)
Requirement already satisfied: multiprocess<0.70.17 in ./.venv/lib/python3.9/site-packages (from datasets>=2.12.0->-r requirements_lora.txt (line 13)) (0.70.16)
Requirement already satisfied: aiohttp!=4.0.0a0,!=4.0.0a1 in ./.venv/lib/python3.9/site-packages (from fsspec[http]<=2025.3.0,>=2023.1.0->datasets>=2.12.0->-r requirements_lora.txt (line 13)) (3.12.15)
Requirement already satisfied: psutil in ./.venv/lib/python3.9/site-packages (from peft>=0.4.0->-r requirements_lora.txt (line 15)) (7.0.0)
Requirement already satisfied: aiohappyeyeballs>=2.5.0 in ./.venv/lib/python3.9/site-packages (from aiohttp!=4.0.0a0,!=4.0.0a1->fsspec[http]<=2025.3.0,>=2023.1.0->datasets>=2.12.0->-r requirements_lora.txt (line 13)) (2.6.1)
Requirement already satisfied: aiosignal>=1.4.0 in ./.venv/lib/python3.9/site-packages (from aiohttp!=4.0.0a0,!=4.0.0a1->fsspec[http]<=2025.3.0,>=2023.1.0->datasets>=2.12.0->-r requirements_lora.txt (line 13)) (1.4.0)
Requirement already satisfied: async-timeout<6.0,>=4.0 in ./.venv/lib/python3.9/site-packages (from aiohttp!=4.0.0a0,!=4.0.0a1->fsspec[http]<=2025.3.0,>=2023.1.0->datasets>=2.12.0->-r requirements_lora.txt (line 13)) (5.0.1)
Requirement already satisfied: attrs>=17.3.0 in ./.venv/lib/python3.9/site-packages (from aiohttp!=4.0.0a0,!=4.0.0a1->fsspec[http]<=2025.3.0,>=2023.1.0->datasets>=2.12.0->-r requirements_lora.txt (line 13)) (25.3.0)
Requirement already satisfied: frozenlist>=1.1.1 in ./.venv/lib/python3.9/site-packages (from aiohttp!=4.0.0a0,!=4.0.0a1->fsspec[http]<=2025.3.0,>=2023.1.0->datasets>=2.12.0->-r requirements_lora.txt (line 13)) (1.7.0)
Requirement already satisfied: multidict<7.0,>=4.5 in ./.venv/lib/python3.9/site-packages (from aiohttp!=4.0.0a0,!=4.0.0a1->fsspec[http]<=2025.3.0,>=2023.1.0->datasets>=2.12.0->-r requirements_lora.txt (line 13)) (6.6.4)
Requirement already satisfied: propcache>=0.2.0 in ./.venv/lib/python3.9/site-packages (from aiohttp!=4.0.0a0,!=4.0.0a1->fsspec[http]<=2025.3.0,>=2023.1.0->datasets>=2.12.0->-r requirements_lora.txt (line 13)) (0.3.2)
Requirement already satisfied: yarl<2.0,>=1.17.0 in ./.venv/lib/python3.9/site-packages (from aiohttp!=4.0.0a0,!=4.0.0a1->fsspec[http]<=2025.3.0,>=2023.1.0->datasets>=2.12.0->-r requirements_lora.txt (line 13)) (1.20.1)
Requirement already satisfied: idna>=2.0 in ./.venv/lib/python3.9/site-packages (from yarl<2.0,>=1.17.0->aiohttp!=4.0.0a0,!=4.0.0a1->fsspec[http]<=2025.3.0,>=2023.1.0->datasets>=2.12.0->-r requirements_lora.txt (line 13)) (3.10)
Requirement already satisfied: zipp>=3.1.0 in ./.venv/lib/python3.9/site-packages (from importlib-resources>=3.2.0->matplotlib->-r requirements_lora.txt (line 9)) (3.23.0)
Requirement already satisfied: six>=1.5 in ./.venv/lib/python3.9/site-packages (from python-dateutil>=2.7->matplotlib->-r requirements_lora.txt (line 9)) (1.17.0)
Requirement already satisfied: charset_normalizer<4,>=2 in ./.venv/lib/python3.9/site-packages (from requests->transformers>=4.30.0->-r requirements_lora.txt (line 12)) (3.4.3)
Requirement already satisfied: urllib3<3,>=1.21.1 in ./.venv/lib/python3.9/site-packages (from requests->transformers>=4.30.0->-r requirements_lora.txt (line 12)) (2.5.0)
Requirement already satisfied: certifi>=2017.4.17 in ./.venv/lib/python3.9/site-packages (from requests->transformers>=4.30.0->-r requirements_lora.txt (line 12)) (2025.8.3)
Requirement already satisfied: mpmath<1.4,>=1.1.0 in ./.venv/lib/python3.9/site-packages (from sympy>=1.13.3->torch>=2.0.0->-r requirements_lora.txt (line 2)) (1.3.0)
Requirement already satisfied: MarkupSafe>=2.0 in ./.venv/lib/python3.9/site-packages (from jinja2->torch>=2.0.0->-r requirements_lora.txt (line 2)) (3.0.2)
Requirement already satisfied: pytz>=2020.1 in ./.venv/lib/python3.9/site-packages (from pandas->datasets>=2.12.0->-r requirements_lora.txt (line 13)) (2025.2)
Requirement already satisfied: tzdata>=2022.7 in ./.venv/lib/python3.9/site-packages (from pandas->datasets>=2.12.0->-r requirements_lora.txt (line 13)) (2025.2)
=== Environment setup complete ===
Python executable: /scratch/nalint2/Bayesian-LORA/.venv/bin/python3
Pip executable: /scratch/nalint2/Bayesian-LORA/.venv/bin/pip3
Virtual environment: /scratch/nalint2/Bayesian-LORA/.venv
=== Starting SAM-SGLD LoRA Experiment ===
Configuration: configs/mrpc_roberta_lora_samsgld_rank1.yaml
Output directory: runs/mrpc_roberta_lora_samsgld_rank1
=== Phase 1: Training MAP LoRA and SAM-SGLD Sampling ===
2025-09-16 18:59:49,301 - root - INFO - Using device: cuda
Some weights of RobertaForSequenceClassification were not initialized from the model checkpoint at roberta-base and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2025-09-16 18:59:52,308 - root - INFO - Starting MAP LoRA training...
2025-09-16 19:00:38,889 - root - INFO - Epoch 1: Train Loss: 0.5923, Val Loss: 0.5152, Val Acc: 0.6838
2025-09-16 19:01:25,044 - root - INFO - Epoch 2: Train Loss: 0.4595, Val Loss: 0.3633, Val Acc: 0.8480
2025-09-16 19:02:12,552 - root - INFO - Epoch 3: Train Loss: 0.3861, Val Loss: 0.3196, Val Acc: 0.8701
2025-09-16 19:03:01,002 - root - INFO - Epoch 4: Train Loss: 0.3378, Val Loss: 0.3245, Val Acc: 0.8627
2025-09-16 19:03:50,160 - root - INFO - Epoch 5: Train Loss: 0.3187, Val Loss: 0.2969, Val Acc: 0.8799
2025-09-16 19:04:39,661 - root - INFO - Epoch 6: Train Loss: 0.2689, Val Loss: 0.3125, Val Acc: 0.8799
2025-09-16 19:05:29,310 - root - INFO - Epoch 7: Train Loss: 0.2299, Val Loss: 0.2790, Val Acc: 0.8897
2025-09-16 19:06:19,050 - root - INFO - Epoch 8: Train Loss: 0.2044, Val Loss: 0.3413, Val Acc: 0.8799
2025-09-16 19:07:08,889 - root - INFO - Epoch 9: Train Loss: 0.1900, Val Loss: 0.3367, Val Acc: 0.8652
2025-09-16 19:07:58,744 - root - INFO - Epoch 10: Train Loss: 0.1672, Val Loss: 0.3324, Val Acc: 0.8725
2025-09-16 19:08:48,533 - root - INFO - Epoch 11: Train Loss: 0.1472, Val Loss: 0.3349, Val Acc: 0.8701
2025-09-16 19:09:38,483 - root - INFO - Epoch 12: Train Loss: 0.1214, Val Loss: 0.3414, Val Acc: 0.8922
2025-09-16 19:10:28,320 - root - INFO - Epoch 13: Train Loss: 0.1102, Val Loss: 0.3787, Val Acc: 0.8873
2025-09-16 19:11:18,022 - root - INFO - Epoch 14: Train Loss: 0.0949, Val Loss: 0.4628, Val Acc: 0.8701
2025-09-16 19:12:07,765 - root - INFO - Epoch 15: Train Loss: 0.0832, Val Loss: 0.4375, Val Acc: 0.8775
2025-09-16 19:12:57,611 - root - INFO - Epoch 16: Train Loss: 0.0857, Val Loss: 0.4233, Val Acc: 0.8701
2025-09-16 19:13:47,336 - root - INFO - Epoch 17: Train Loss: 0.0717, Val Loss: 0.4749, Val Acc: 0.8578
2025-09-16 19:14:37,462 - root - INFO - Epoch 18: Train Loss: 0.0574, Val Loss: 0.4891, Val Acc: 0.8725
2025-09-16 19:15:27,172 - root - INFO - Epoch 19: Train Loss: 0.0674, Val Loss: 0.5233, Val Acc: 0.8725
2025-09-16 19:16:16,841 - root - INFO - Epoch 20: Train Loss: 0.0413, Val Loss: 0.5835, Val Acc: 0.8676
2025-09-16 19:16:17,634 - root - INFO - MAP model saved to runs/mrpc_roberta_lora_samsgld_rank1/map_model.pth
2025-09-16 19:16:17,753 - root - INFO - Starting SAM-SGLD Rank-1 LoRA training...
2025-09-16 19:16:17,753 - root - INFO - Running chain 1/4
2025-09-16 19:16:18,082 - root - INFO - Chain 1: MAP model loaded - LoRA param norms: [2.315675735473633, 1.2554264068603516, 2.3865742683410645]
2025-09-16 19:16:18,307 - root - INFO - Chain 1: MAP model test - Loss: 0.4546, Acc: 0.9062
2025-09-16 19:16:18,308 - root - INFO - Chain 1: Initial configuration:
2025-09-16 19:16:18,308 - root - INFO -   Initial step size: 2.00e-03
2025-09-16 19:16:18,308 - root - INFO -   Temperature: 2.0
2025-09-16 19:16:18,308 - root - INFO -   Noise scale: 1.00e-04
2025-09-16 19:16:18,308 - root - INFO -   Prior std: 17.000
2025-09-16 19:16:18,308 - root - INFO -   SAM rho: 0.050
2025-09-16 19:16:18,308 - root - INFO -   Decay rate: 0.300
2025-09-16 19:16:18,308 - root - INFO - Chain 1: Burn-in phase (8000 steps)
2025-09-16 19:16:19,567 - root - INFO - Burn-in step 0/8000:
2025-09-16 19:16:19,567 - root - INFO -   Actual drift norm: 1.00e-02
2025-09-16 19:16:19,567 - root - INFO -   Actual noise norm: 3.46e-03
2025-09-16 19:16:19,567 - root - INFO -   Actual drift/noise ratio: 2.894
2025-09-16 19:16:19,568 - root - INFO -   Theoretical step/noise ratio: 55.470
2025-09-16 19:16:19,568 - root - INFO -   Prior/Likelihood ratio: 49.739
2025-09-16 19:16:19,568 - root - INFO -   SAM perturbation norm: 4.90e-01
2025-09-16 19:16:19,568 - root - INFO -   SAM gradient norm: 1.08e+01
2025-09-16 19:16:19,568 - root - INFO -   SAM perturbation/gradient ratio: 0.045
2025-09-16 19:16:19,568 - root - INFO -   Rank-1 noise contribution: 0.093
2025-09-16 19:16:19,568 - root - INFO -   Loss change after SAM perturbation: 2.3945
2025-09-16 19:23:28,317 - root - INFO - Burn-in step 500/8000:
2025-09-16 19:23:28,320 - root - INFO -   Actual drift norm: 2.22e-03
2025-09-16 19:23:28,320 - root - INFO -   Actual noise norm: 3.39e-03
2025-09-16 19:23:28,320 - root - INFO -   Actual drift/noise ratio: 0.655
2025-09-16 19:23:28,320 - root - INFO -   Theoretical step/noise ratio: 54.499
2025-09-16 19:23:28,320 - root - INFO -   Prior/Likelihood ratio: 15.714
2025-09-16 19:23:28,320 - root - INFO -   SAM perturbation norm: 4.90e-01
2025-09-16 19:23:28,320 - root - INFO -   SAM gradient norm: 1.15e+00
2025-09-16 19:23:28,320 - root - INFO -   SAM perturbation/gradient ratio: 0.426
2025-09-16 19:23:28,320 - root - INFO -   Rank-1 noise contribution: 0.096
2025-09-16 19:23:28,320 - root - INFO -   Loss change after SAM perturbation: 0.1413
2025-09-16 19:30:37,448 - root - INFO - Burn-in step 1000/8000:
2025-09-16 19:30:37,451 - root - INFO -   Actual drift norm: 6.60e-03
2025-09-16 19:30:37,451 - root - INFO -   Actual noise norm: 3.35e-03
2025-09-16 19:30:37,451 - root - INFO -   Actual drift/noise ratio: 1.971
2025-09-16 19:30:37,451 - root - INFO -   Theoretical step/noise ratio: 53.644
2025-09-16 19:30:37,451 - root - INFO -   Prior/Likelihood ratio: 3.431
2025-09-16 19:30:37,451 - root - INFO -   SAM perturbation norm: 4.90e-01
2025-09-16 19:30:37,451 - root - INFO -   SAM gradient norm: 3.53e+00
2025-09-16 19:30:37,451 - root - INFO -   SAM perturbation/gradient ratio: 0.139
2025-09-16 19:30:37,452 - root - INFO -   Rank-1 noise contribution: 0.087
2025-09-16 19:30:37,452 - root - INFO -   Loss change after SAM perturbation: 0.3168
2025-09-16 19:37:46,602 - root - INFO - Burn-in step 1500/8000:
2025-09-16 19:37:46,605 - root - INFO -   Actual drift norm: 2.57e-03
2025-09-16 19:37:46,605 - root - INFO -   Actual noise norm: 3.29e-03
2025-09-16 19:37:46,605 - root - INFO -   Actual drift/noise ratio: 0.781
2025-09-16 19:37:46,605 - root - INFO -   Theoretical step/noise ratio: 52.883
2025-09-16 19:37:46,605 - root - INFO -   Prior/Likelihood ratio: 16.467
2025-09-16 19:37:46,605 - root - INFO -   SAM perturbation norm: 4.90e-01
2025-09-16 19:37:46,605 - root - INFO -   SAM gradient norm: 1.42e+00
2025-09-16 19:37:46,606 - root - INFO -   SAM perturbation/gradient ratio: 0.346
2025-09-16 19:37:46,606 - root - INFO -   Rank-1 noise contribution: 0.101
2025-09-16 19:37:46,606 - root - INFO -   Loss change after SAM perturbation: 0.2483
2025-09-16 19:44:55,030 - root - INFO - Burn-in step 2000/8000:
2025-09-16 19:44:55,032 - root - INFO -   Actual drift norm: 4.78e-03
2025-09-16 19:44:55,033 - root - INFO -   Actual noise norm: 3.26e-03
2025-09-16 19:44:55,033 - root - INFO -   Actual drift/noise ratio: 1.467
2025-09-16 19:44:55,033 - root - INFO -   Theoretical step/noise ratio: 52.197
2025-09-16 19:44:55,033 - root - INFO -   Prior/Likelihood ratio: 4.730
2025-09-16 19:44:55,033 - root - INFO -   SAM perturbation norm: 4.90e-01
2025-09-16 19:44:55,033 - root - INFO -   SAM gradient norm: 2.70e+00
2025-09-16 19:44:55,033 - root - INFO -   SAM perturbation/gradient ratio: 0.181
2025-09-16 19:44:55,033 - root - INFO -   Rank-1 noise contribution: 0.079
2025-09-16 19:44:55,033 - root - INFO -   Loss change after SAM perturbation: 0.3270
2025-09-16 19:52:04,104 - root - INFO - Burn-in step 2500/8000:
2025-09-16 19:52:04,107 - root - INFO -   Actual drift norm: 3.48e-03
2025-09-16 19:52:04,107 - root - INFO -   Actual noise norm: 3.22e-03
2025-09-16 19:52:04,107 - root - INFO -   Actual drift/noise ratio: 1.083
2025-09-16 19:52:04,107 - root - INFO -   Theoretical step/noise ratio: 51.574
2025-09-16 19:52:04,107 - root - INFO -   Prior/Likelihood ratio: 9.832
2025-09-16 19:52:04,107 - root - INFO -   SAM perturbation norm: 4.90e-01
2025-09-16 19:52:04,107 - root - INFO -   SAM gradient norm: 2.01e+00
2025-09-16 19:52:04,107 - root - INFO -   SAM perturbation/gradient ratio: 0.243
2025-09-16 19:52:04,107 - root - INFO -   Rank-1 noise contribution: 0.091
2025-09-16 19:52:04,107 - root - INFO -   Loss change after SAM perturbation: 0.2394
2025-09-16 19:59:13,294 - root - INFO - Burn-in step 3000/8000:
2025-09-16 19:59:13,296 - root - INFO -   Actual drift norm: 4.72e-03
2025-09-16 19:59:13,297 - root - INFO -   Actual noise norm: 3.18e-03
2025-09-16 19:59:13,297 - root - INFO -   Actual drift/noise ratio: 1.485
2025-09-16 19:59:13,297 - root - INFO -   Theoretical step/noise ratio: 51.004
2025-09-16 19:59:13,297 - root - INFO -   Prior/Likelihood ratio: 12.846
2025-09-16 19:59:13,297 - root - INFO -   SAM perturbation norm: 4.90e-01
2025-09-16 19:59:13,297 - root - INFO -   SAM gradient norm: 2.79e+00
2025-09-16 19:59:13,297 - root - INFO -   SAM perturbation/gradient ratio: 0.176
2025-09-16 19:59:13,297 - root - INFO -   Rank-1 noise contribution: 0.089
2025-09-16 19:59:13,297 - root - INFO -   Loss change after SAM perturbation: 0.2921
2025-09-16 20:06:21,141 - root - INFO - Burn-in step 3500/8000:
2025-09-16 20:06:21,143 - root - INFO -   Actual drift norm: 5.05e-03
2025-09-16 20:06:21,144 - root - INFO -   Actual noise norm: 3.14e-03
2025-09-16 20:06:21,144 - root - INFO -   Actual drift/noise ratio: 1.609
2025-09-16 20:06:21,144 - root - INFO -   Theoretical step/noise ratio: 50.479
2025-09-16 20:06:21,144 - root - INFO -   Prior/Likelihood ratio: 4.228
2025-09-16 20:06:21,144 - root - INFO -   SAM perturbation norm: 4.90e-01
2025-09-16 20:06:21,144 - root - INFO -   SAM gradient norm: 3.05e+00
2025-09-16 20:06:21,144 - root - INFO -   SAM perturbation/gradient ratio: 0.161
2025-09-16 20:06:21,144 - root - INFO -   Rank-1 noise contribution: 0.095
2025-09-16 20:06:21,144 - root - INFO -   Loss change after SAM perturbation: 0.2512
2025-09-16 20:13:29,884 - root - INFO - Burn-in step 4000/8000:
2025-09-16 20:13:29,887 - root - INFO -   Actual drift norm: 2.96e-03
2025-09-16 20:13:29,887 - root - INFO -   Actual noise norm: 3.11e-03
2025-09-16 20:13:29,887 - root - INFO -   Actual drift/noise ratio: 0.952
2025-09-16 20:13:29,887 - root - INFO -   Theoretical step/noise ratio: 49.992
2025-09-16 20:13:29,887 - root - INFO -   Prior/Likelihood ratio: 6.028
2025-09-16 20:13:29,887 - root - INFO -   SAM perturbation norm: 4.90e-01
2025-09-16 20:13:29,887 - root - INFO -   SAM gradient norm: 1.82e+00
2025-09-16 20:13:29,887 - root - INFO -   SAM perturbation/gradient ratio: 0.269
2025-09-16 20:13:29,887 - root - INFO -   Rank-1 noise contribution: 0.097
2025-09-16 20:13:29,888 - root - INFO -   Loss change after SAM perturbation: 0.2687
2025-09-16 20:20:38,307 - root - INFO - Burn-in step 4500/8000:
2025-09-16 20:20:38,310 - root - INFO -   Actual drift norm: 7.98e-03
2025-09-16 20:20:38,310 - root - INFO -   Actual noise norm: 3.09e-03
2025-09-16 20:20:38,310 - root - INFO -   Actual drift/noise ratio: 2.584
2025-09-16 20:20:38,310 - root - INFO -   Theoretical step/noise ratio: 49.540
2025-09-16 20:20:38,310 - root - INFO -   Prior/Likelihood ratio: 4.956
2025-09-16 20:20:38,310 - root - INFO -   SAM perturbation norm: 4.90e-01
2025-09-16 20:20:38,310 - root - INFO -   SAM gradient norm: 6.55e+00
2025-09-16 20:20:38,310 - root - INFO -   SAM perturbation/gradient ratio: 0.075
2025-09-16 20:20:38,310 - root - INFO -   Rank-1 noise contribution: 0.098
2025-09-16 20:20:38,310 - root - INFO -   Loss change after SAM perturbation: 0.1953
2025-09-16 20:27:46,745 - root - INFO - Burn-in step 5000/8000:
2025-09-16 20:27:46,748 - root - INFO -   Actual drift norm: 3.61e-03
2025-09-16 20:27:46,748 - root - INFO -   Actual noise norm: 3.07e-03
2025-09-16 20:27:46,748 - root - INFO -   Actual drift/noise ratio: 1.178
2025-09-16 20:27:46,748 - root - INFO -   Theoretical step/noise ratio: 49.117
2025-09-16 20:27:46,748 - root - INFO -   Prior/Likelihood ratio: 4.614
2025-09-16 20:27:46,749 - root - INFO -   SAM perturbation norm: 4.90e-01
2025-09-16 20:27:46,749 - root - INFO -   SAM gradient norm: 2.30e+00
2025-09-16 20:27:46,749 - root - INFO -   SAM perturbation/gradient ratio: 0.213
2025-09-16 20:27:46,749 - root - INFO -   Rank-1 noise contribution: 0.090
2025-09-16 20:27:46,749 - root - INFO -   Loss change after SAM perturbation: 0.2494
2025-09-16 20:34:54,773 - root - INFO - Burn-in step 5500/8000:
2025-09-16 20:34:54,776 - root - INFO -   Actual drift norm: 3.03e-03
2025-09-16 20:34:54,776 - root - INFO -   Actual noise norm: 3.03e-03
2025-09-16 20:34:54,776 - root - INFO -   Actual drift/noise ratio: 0.997
2025-09-16 20:34:54,776 - root - INFO -   Theoretical step/noise ratio: 48.720
2025-09-16 20:34:54,777 - root - INFO -   Prior/Likelihood ratio: 6.026
2025-09-16 20:34:54,777 - root - INFO -   SAM perturbation norm: 4.90e-01
2025-09-16 20:34:54,777 - root - INFO -   SAM gradient norm: 1.96e+00
2025-09-16 20:34:54,777 - root - INFO -   SAM perturbation/gradient ratio: 0.250
2025-09-16 20:34:54,777 - root - INFO -   Rank-1 noise contribution: 0.101
2025-09-16 20:34:54,777 - root - INFO -   Loss change after SAM perturbation: 0.1446
2025-09-16 20:42:03,538 - root - INFO - Burn-in step 6000/8000:
2025-09-16 20:42:03,541 - root - INFO -   Actual drift norm: 3.83e-03
2025-09-16 20:42:03,541 - root - INFO -   Actual noise norm: 3.01e-03
2025-09-16 20:42:03,541 - root - INFO -   Actual drift/noise ratio: 1.273
2025-09-16 20:42:03,541 - root - INFO -   Theoretical step/noise ratio: 48.347
2025-09-16 20:42:03,541 - root - INFO -   Prior/Likelihood ratio: 12.742
2025-09-16 20:42:03,541 - root - INFO -   SAM perturbation norm: 4.90e-01
2025-09-16 20:42:03,541 - root - INFO -   SAM gradient norm: 2.52e+00
2025-09-16 20:42:03,541 - root - INFO -   SAM perturbation/gradient ratio: 0.194
2025-09-16 20:42:03,541 - root - INFO -   Rank-1 noise contribution: 0.092
2025-09-16 20:42:03,541 - root - INFO -   Loss change after SAM perturbation: 0.1544
2025-09-16 20:49:12,749 - root - INFO - Burn-in step 6500/8000:
2025-09-16 20:49:12,752 - root - INFO -   Actual drift norm: 2.33e-03
2025-09-16 20:49:12,752 - root - INFO -   Actual noise norm: 2.99e-03
2025-09-16 20:49:12,752 - root - INFO -   Actual drift/noise ratio: 0.779
2025-09-16 20:49:12,752 - root - INFO -   Theoretical step/noise ratio: 47.994
2025-09-16 20:49:12,752 - root - INFO -   Prior/Likelihood ratio: 15.793
2025-09-16 20:49:12,752 - root - INFO -   SAM perturbation norm: 4.90e-01
2025-09-16 20:49:12,752 - root - INFO -   SAM gradient norm: 1.56e+00
2025-09-16 20:49:12,752 - root - INFO -   SAM perturbation/gradient ratio: 0.315
2025-09-16 20:49:12,752 - root - INFO -   Rank-1 noise contribution: 0.093
2025-09-16 20:49:12,752 - root - INFO -   Loss change after SAM perturbation: 0.1840
2025-09-16 20:56:22,080 - root - INFO - Burn-in step 7000/8000:
2025-09-16 20:56:22,083 - root - INFO -   Actual drift norm: 5.77e-03
2025-09-16 20:56:22,083 - root - INFO -   Actual noise norm: 2.97e-03
2025-09-16 20:56:22,083 - root - INFO -   Actual drift/noise ratio: 1.944
2025-09-16 20:56:22,083 - root - INFO -   Theoretical step/noise ratio: 47.660
2025-09-16 20:56:22,084 - root - INFO -   Prior/Likelihood ratio: 5.393
2025-09-16 20:56:22,084 - root - INFO -   SAM perturbation norm: 4.90e-01
2025-09-16 20:56:22,084 - root - INFO -   SAM gradient norm: 3.91e+00
2025-09-16 20:56:22,084 - root - INFO -   SAM perturbation/gradient ratio: 0.125
2025-09-16 20:56:22,084 - root - INFO -   Rank-1 noise contribution: 0.090
2025-09-16 20:56:22,084 - root - INFO -   Loss change after SAM perturbation: 0.3336
2025-09-16 21:03:30,598 - root - INFO - Burn-in step 7500/8000:
2025-09-16 21:03:30,601 - root - INFO -   Actual drift norm: 1.14e-03
2025-09-16 21:03:30,602 - root - INFO -   Actual noise norm: 2.95e-03
2025-09-16 21:03:30,602 - root - INFO -   Actual drift/noise ratio: 0.388
2025-09-16 21:03:30,602 - root - INFO -   Theoretical step/noise ratio: 47.344
2025-09-16 21:03:30,602 - root - INFO -   Prior/Likelihood ratio: 2.923
2025-09-16 21:03:30,602 - root - INFO -   SAM perturbation norm: 4.90e-01
2025-09-16 21:03:30,602 - root - INFO -   SAM gradient norm: 7.84e-01
2025-09-16 21:03:30,602 - root - INFO -   SAM perturbation/gradient ratio: 0.625
2025-09-16 21:03:30,602 - root - INFO -   Rank-1 noise contribution: 0.101
2025-09-16 21:03:30,602 - root - INFO -   Loss change after SAM perturbation: 0.0952
2025-09-16 21:10:37,542 - root - INFO -   DIAGNOSTIC - Burn-in completed:
2025-09-16 21:10:37,545 - root - INFO -     Avg parameter movement: 0.131191
2025-09-16 21:10:37,545 - root - INFO -     Total parameters moved: 96
2025-09-16 21:10:37,545 - root - INFO - Chain 1: Sampling phase (3000 steps)
2025-09-16 21:10:37,749 - root - INFO -   DIAGNOSTIC - Initial state:
2025-09-16 21:10:37,749 - root - INFO -     Initial prediction: [0, 0]
2025-09-16 21:10:37,750 - root - INFO -     Initial confidence: [0.949265718460083, 0.0507342703640461]
2025-09-16 21:10:37,754 - root - INFO - Chain 1: Step size after burn-in:
2025-09-16 21:10:37,754 - root - INFO -   Initial: 2.00e-03
2025-09-16 21:10:37,754 - root - INFO -   Final: 1.44e-03
2025-09-16 21:10:37,754 - root - INFO -   Reduction: 28.1%
2025-09-16 21:10:38,802 - root - INFO - Chain 1, Step 0:
2025-09-16 21:10:38,803 - root - INFO -   Actual drift norm: 2.66e-03
2025-09-16 21:10:38,803 - root - INFO -   Actual noise norm: 2.93e-03
2025-09-16 21:10:38,803 - root - INFO -   Actual drift/noise ratio: 0.907
2025-09-16 21:10:38,803 - root - INFO -   Theoretical step/noise ratio: 47.042
2025-09-16 21:10:38,803 - root - INFO -   Prior/Likelihood ratio: 9.039
2025-09-16 21:10:38,803 - root - INFO -   SAM rho: 0.050
2025-09-16 21:10:38,803 - root - INFO -   SAM perturbation norm: 4.90e-01
2025-09-16 21:10:38,803 - root - INFO -   SAM gradient norm: 1.85e+00
2025-09-16 21:10:38,803 - root - INFO -   SAM perturbation/gradient ratio: 0.265
2025-09-16 21:10:38,803 - root - INFO -   Rank-1 noise contribution: 0.095
2025-09-16 21:10:38,803 - root - INFO -   Loss change after SAM perturbation: 0.2360
2025-09-16 21:10:38,803 - root - INFO -   Temperature: 2.0
2025-09-16 21:10:38,975 - root - INFO -   DIAGNOSTIC - Sample 1:
2025-09-16 21:10:38,975 - root - INFO -     Avg parameter movement: 0.000390
2025-09-16 21:10:38,975 - root - INFO -     Prediction changed: True
2025-09-16 21:10:38,976 - root - INFO -     Confidence change: 1.346975
2025-09-16 21:10:38,976 - root - INFO -     Current prediction: [0, 1]
2025-09-16 21:10:38,976 - root - INFO -     Current confidence: [0.9335681200027466, 0.06643183529376984]
2025-09-16 21:10:38,976 - root - INFO - Sampling step 0/3000, step_size: 1.44e-03
2025-09-16 21:11:21,860 - root - INFO -   DIAGNOSTIC - Sample 2:
2025-09-16 21:11:21,862 - root - INFO -     Avg parameter movement: 0.003187
2025-09-16 21:11:21,862 - root - INFO -     Prediction changed: True
2025-09-16 21:11:21,862 - root - INFO -     Confidence change: 0.765037
2025-09-16 21:11:21,863 - root - INFO -     Current prediction: [1, 0]
2025-09-16 21:11:21,863 - root - INFO -     Current confidence: [0.4083764851093292, 0.5916235446929932]
2025-09-16 21:12:04,637 - root - INFO -   DIAGNOSTIC - Sample 3:
2025-09-16 21:12:04,638 - root - INFO -     Avg parameter movement: 0.004559
2025-09-16 21:12:04,638 - root - INFO -     Prediction changed: True
2025-09-16 21:12:04,638 - root - INFO -     Confidence change: 1.346512
2025-09-16 21:12:04,638 - root - INFO -     Current prediction: [0, 1]
2025-09-16 21:12:04,638 - root - INFO -     Current confidence: [0.9546564221382141, 0.04534352570772171]
2025-09-16 21:12:47,369 - root - INFO -   DIAGNOSTIC - Sample 4:
2025-09-16 21:12:47,369 - root - INFO -     Avg parameter movement: 0.005559
2025-09-16 21:12:47,369 - root - INFO -     Prediction changed: True
2025-09-16 21:12:47,369 - root - INFO -     Confidence change: 1.334920
2025-09-16 21:12:47,369 - root - INFO -     Current prediction: [1, 0]
2025-09-16 21:12:47,369 - root - INFO -     Current confidence: [0.005403644870966673, 0.9945964217185974]
2025-09-16 21:13:30,132 - root - INFO -   DIAGNOSTIC - Sample 5:
2025-09-16 21:13:30,132 - root - INFO -     Avg parameter movement: 0.006407
2025-09-16 21:13:30,132 - root - INFO -     Prediction changed: True
2025-09-16 21:13:30,133 - root - INFO -     Confidence change: 1.895211
2025-09-16 21:13:30,133 - root - INFO -     Current prediction: [1, 1]
2025-09-16 21:13:30,133 - root - INFO -     Current confidence: [0.0051611848175525665, 0.9948387742042542]
2025-09-16 21:17:03,969 - root - INFO -   DIAGNOSTIC - Sample 10:
2025-09-16 21:17:03,971 - root - INFO -     Avg parameter movement: 0.010014
2025-09-16 21:17:03,972 - root - INFO -     Prediction changed: True
2025-09-16 21:17:03,972 - root - INFO -     Confidence change: 1.890262
2025-09-16 21:17:03,972 - root - INFO -     Current prediction: [1, 1]
2025-09-16 21:17:03,972 - root - INFO -     Current confidence: [0.008591129444539547, 0.9914088845252991]
2025-09-16 21:24:12,183 - root - INFO -   DIAGNOSTIC - Sample 20:
2025-09-16 21:24:12,185 - root - INFO -     Avg parameter movement: 0.015637
2025-09-16 21:24:12,185 - root - INFO -     Prediction changed: True
2025-09-16 21:24:12,185 - root - INFO -     Confidence change: 1.875688
2025-09-16 21:24:12,186 - root - INFO -     Current prediction: [1, 1]
2025-09-16 21:24:12,186 - root - INFO -     Current confidence: [0.01603851281106472, 0.9839614629745483]
2025-09-16 21:24:55,105 - root - INFO - Chain 1, Step 1000:
2025-09-16 21:24:55,106 - root - INFO -   Actual drift norm: 1.33e-03
2025-09-16 21:24:55,106 - root - INFO -   Actual noise norm: 2.94e-03
2025-09-16 21:24:55,106 - root - INFO -   Actual drift/noise ratio: 0.452
2025-09-16 21:24:55,106 - root - INFO -   Theoretical step/noise ratio: 47.042
2025-09-16 21:24:55,106 - root - INFO -   Prior/Likelihood ratio: 8.077
2025-09-16 21:24:55,106 - root - INFO -   SAM rho: 0.050
2025-09-16 21:24:55,106 - root - INFO -   SAM perturbation norm: 4.90e-01
2025-09-16 21:24:55,106 - root - INFO -   SAM gradient norm: 9.24e-01
2025-09-16 21:24:55,106 - root - INFO -   SAM perturbation/gradient ratio: 0.530
2025-09-16 21:24:55,106 - root - INFO -   Rank-1 noise contribution: 0.086
2025-09-16 21:24:55,106 - root - INFO -   Loss change after SAM perturbation: 0.1486
2025-09-16 21:24:55,106 - root - INFO -   Temperature: 2.0
2025-09-16 21:24:55,233 - root - INFO - Sampling step 1000/3000, step_size: 1.44e-03
2025-09-16 21:31:20,626 - root - INFO -   DIAGNOSTIC - Sample 30:
2025-09-16 21:31:20,628 - root - INFO -     Avg parameter movement: 0.020672
2025-09-16 21:31:20,628 - root - INFO -     Prediction changed: False
2025-09-16 21:31:20,628 - root - INFO -     Confidence change: 0.076111
2025-09-16 21:31:20,629 - root - INFO -     Current prediction: [0, 0]
2025-09-16 21:31:20,629 - root - INFO -     Current confidence: [0.9022312760353088, 0.09776869416236877]
2025-09-16 21:38:29,396 - root - INFO -   DIAGNOSTIC - Sample 40:
2025-09-16 21:38:29,399 - root - INFO -     Avg parameter movement: 0.025382
2025-09-16 21:38:29,399 - root - INFO -     Prediction changed: True
2025-09-16 21:38:29,399 - root - INFO -     Confidence change: 1.345983
2025-09-16 21:38:29,399 - root - INFO -     Current prediction: [0, 1]
2025-09-16 21:38:29,399 - root - INFO -     Current confidence: [0.9310113787651062, 0.06898856908082962]
2025-09-16 21:39:12,285 - root - INFO - Chain 1, Step 2000:
2025-09-16 21:39:12,285 - root - INFO -   Actual drift norm: 6.58e-03
2025-09-16 21:39:12,286 - root - INFO -   Actual noise norm: 2.93e-03
2025-09-16 21:39:12,286 - root - INFO -   Actual drift/noise ratio: 2.241
2025-09-16 21:39:12,286 - root - INFO -   Theoretical step/noise ratio: 47.042
2025-09-16 21:39:12,286 - root - INFO -   Prior/Likelihood ratio: 4.314
2025-09-16 21:39:12,286 - root - INFO -   SAM rho: 0.050
2025-09-16 21:39:12,286 - root - INFO -   SAM perturbation norm: 4.90e-01
2025-09-16 21:39:12,286 - root - INFO -   SAM gradient norm: 4.57e+00
2025-09-16 21:39:12,286 - root - INFO -   SAM perturbation/gradient ratio: 0.107
2025-09-16 21:39:12,286 - root - INFO -   Rank-1 noise contribution: 0.092
2025-09-16 21:39:12,286 - root - INFO -   Loss change after SAM perturbation: 0.2513
2025-09-16 21:39:12,286 - root - INFO -   Temperature: 2.0
2025-09-16 21:39:12,411 - root - INFO - Sampling step 2000/3000, step_size: 1.44e-03
2025-09-16 21:45:37,660 - root - INFO -   DIAGNOSTIC - Sample 50:
2025-09-16 21:45:37,663 - root - INFO -     Avg parameter movement: 0.030174
2025-09-16 21:45:37,663 - root - INFO -     Prediction changed: True
2025-09-16 21:45:37,663 - root - INFO -     Confidence change: 1.346329
2025-09-16 21:45:37,663 - root - INFO -     Current prediction: [0, 1]
2025-09-16 21:45:37,663 - root - INFO -     Current confidence: [0.9490581154823303, 0.05094192922115326]
2025-09-16 21:52:47,022 - root - INFO -   DIAGNOSTIC - Sample 60:
2025-09-16 21:52:47,024 - root - INFO -     Avg parameter movement: 0.034775
2025-09-16 21:52:47,024 - root - INFO -     Prediction changed: False
2025-09-16 21:52:47,024 - root - INFO -     Confidence change: 0.506299
2025-09-16 21:52:47,025 - root - INFO -     Current prediction: [0, 0]
2025-09-16 21:52:47,025 - root - INFO -     Current confidence: [0.591741681098938, 0.408258318901062]
2025-09-16 21:53:28,961 - root - INFO - Chain 1: Collected 60 samples
2025-09-16 21:53:29,005 - root - INFO -   DIAGNOSTIC - Chain 1 summary:
2025-09-16 21:53:29,005 - root - INFO -     Final avg parameter movement: 0.035273
2025-09-16 21:53:29,005 - root - INFO -     Final prediction changed: True
2025-09-16 21:53:29,005 - root - INFO -     Final confidence change: 1.895209
2025-09-16 21:53:29,005 - root - INFO -     Final prediction: [1, 1]
2025-09-16 21:53:29,005 - root - INFO -     Final confidence: [0.006044444628059864, 0.9939555525779724]
2025-09-16 21:53:29,115 - root - INFO - Running chain 2/4
2025-09-16 21:53:29,761 - root - INFO - Chain 2: MAP model loaded - LoRA param norms: [2.315675735473633, 1.2554264068603516, 2.3865742683410645]
2025-09-16 21:53:29,954 - root - INFO - Chain 2: MAP model test - Loss: 0.4546, Acc: 0.9062
2025-09-16 21:53:29,954 - root - INFO - Chain 2: Initial configuration:
2025-09-16 21:53:29,954 - root - INFO -   Initial step size: 2.00e-03
2025-09-16 21:53:29,954 - root - INFO -   Temperature: 2.0
2025-09-16 21:53:29,954 - root - INFO -   Noise scale: 1.00e-04
2025-09-16 21:53:29,954 - root - INFO -   Prior std: 17.000
2025-09-16 21:53:29,954 - root - INFO -   SAM rho: 0.050
2025-09-16 21:53:29,954 - root - INFO -   Decay rate: 0.300
2025-09-16 21:53:29,954 - root - INFO - Chain 2: Burn-in phase (8000 steps)
2025-09-16 21:53:31,141 - root - INFO - Burn-in step 0/8000:
2025-09-16 21:53:31,142 - root - INFO -   Actual drift norm: 1.00e-02
2025-09-16 21:53:31,142 - root - INFO -   Actual noise norm: 3.46e-03
2025-09-16 21:53:31,142 - root - INFO -   Actual drift/noise ratio: 2.890
2025-09-16 21:53:31,142 - root - INFO -   Theoretical step/noise ratio: 55.470
2025-09-16 21:53:31,142 - root - INFO -   Prior/Likelihood ratio: 64.017
2025-09-16 21:53:31,142 - root - INFO -   SAM perturbation norm: 4.90e-01
2025-09-16 21:53:31,142 - root - INFO -   SAM gradient norm: 2.26e+01
2025-09-16 21:53:31,142 - root - INFO -   SAM perturbation/gradient ratio: 0.022
2025-09-16 21:53:31,142 - root - INFO -   Rank-1 noise contribution: 0.089
2025-09-16 21:53:31,142 - root - INFO -   Loss change after SAM perturbation: 1.4248
2025-09-16 22:00:40,472 - root - INFO - Burn-in step 500/8000:
2025-09-16 22:00:40,474 - root - INFO -   Actual drift norm: 3.08e-03
2025-09-16 22:00:40,475 - root - INFO -   Actual noise norm: 3.39e-03
2025-09-16 22:00:40,475 - root - INFO -   Actual drift/noise ratio: 0.908
2025-09-16 22:00:40,475 - root - INFO -   Theoretical step/noise ratio: 54.499
2025-09-16 22:00:40,475 - root - INFO -   Prior/Likelihood ratio: 4.991
2025-09-16 22:00:40,475 - root - INFO -   SAM perturbation norm: 4.90e-01
2025-09-16 22:00:40,475 - root - INFO -   SAM gradient norm: 1.60e+00
2025-09-16 22:00:40,475 - root - INFO -   SAM perturbation/gradient ratio: 0.307
2025-09-16 22:00:40,475 - root - INFO -   Rank-1 noise contribution: 0.088
2025-09-16 22:00:40,475 - root - INFO -   Loss change after SAM perturbation: 0.1571
2025-09-16 22:07:49,519 - root - INFO - Burn-in step 1000/8000:
2025-09-16 22:07:49,522 - root - INFO -   Actual drift norm: 3.52e-03
2025-09-16 22:07:49,522 - root - INFO -   Actual noise norm: 3.35e-03
2025-09-16 22:07:49,522 - root - INFO -   Actual drift/noise ratio: 1.051
2025-09-16 22:07:49,522 - root - INFO -   Theoretical step/noise ratio: 53.644
2025-09-16 22:07:49,522 - root - INFO -   Prior/Likelihood ratio: 12.409
2025-09-16 22:07:49,522 - root - INFO -   SAM perturbation norm: 4.90e-01
2025-09-16 22:07:49,522 - root - INFO -   SAM gradient norm: 1.88e+00
2025-09-16 22:07:49,522 - root - INFO -   SAM perturbation/gradient ratio: 0.260
2025-09-16 22:07:49,522 - root - INFO -   Rank-1 noise contribution: 0.092
2025-09-16 22:07:49,522 - root - INFO -   Loss change after SAM perturbation: 0.3539
2025-09-16 22:14:58,228 - root - INFO - Burn-in step 1500/8000:
2025-09-16 22:14:58,232 - root - INFO -   Actual drift norm: 3.01e-03
2025-09-16 22:14:58,233 - root - INFO -   Actual noise norm: 3.30e-03
2025-09-16 22:14:58,233 - root - INFO -   Actual drift/noise ratio: 0.911
2025-09-16 22:14:58,233 - root - INFO -   Theoretical step/noise ratio: 52.883
2025-09-16 22:14:58,233 - root - INFO -   Prior/Likelihood ratio: 10.506
2025-09-16 22:14:58,233 - root - INFO -   SAM perturbation norm: 4.90e-01
2025-09-16 22:14:58,233 - root - INFO -   SAM gradient norm: 1.65e+00
2025-09-16 22:14:58,233 - root - INFO -   SAM perturbation/gradient ratio: 0.296
2025-09-16 22:14:58,233 - root - INFO -   Rank-1 noise contribution: 0.093
2025-09-16 22:14:58,233 - root - INFO -   Loss change after SAM perturbation: 0.2809
2025-09-16 22:22:06,661 - root - INFO - Burn-in step 2000/8000:
2025-09-16 22:22:06,663 - root - INFO -   Actual drift norm: 2.88e-03
2025-09-16 22:22:06,664 - root - INFO -   Actual noise norm: 3.25e-03
2025-09-16 22:22:06,664 - root - INFO -   Actual drift/noise ratio: 0.887
2025-09-16 22:22:06,664 - root - INFO -   Theoretical step/noise ratio: 52.197
2025-09-16 22:22:06,664 - root - INFO -   Prior/Likelihood ratio: 12.869
2025-09-16 22:22:06,664 - root - INFO -   SAM perturbation norm: 4.90e-01
2025-09-16 22:22:06,664 - root - INFO -   SAM gradient norm: 1.63e+00
2025-09-16 22:22:06,664 - root - INFO -   SAM perturbation/gradient ratio: 0.301
2025-09-16 22:22:06,664 - root - INFO -   Rank-1 noise contribution: 0.089
2025-09-16 22:22:06,664 - root - INFO -   Loss change after SAM perturbation: 0.2483
2025-09-16 22:29:15,021 - root - INFO - Burn-in step 2500/8000:
2025-09-16 22:29:15,024 - root - INFO -   Actual drift norm: 8.64e-03
2025-09-16 22:29:15,024 - root - INFO -   Actual noise norm: 3.22e-03
2025-09-16 22:29:15,024 - root - INFO -   Actual drift/noise ratio: 2.688
2025-09-16 22:29:15,024 - root - INFO -   Theoretical step/noise ratio: 51.574
2025-09-16 22:29:15,024 - root - INFO -   Prior/Likelihood ratio: 8.506
2025-09-16 22:29:15,024 - root - INFO -   SAM perturbation norm: 4.90e-01
2025-09-16 22:29:15,024 - root - INFO -   SAM gradient norm: 5.65e+00
2025-09-16 22:29:15,025 - root - INFO -   SAM perturbation/gradient ratio: 0.087
2025-09-16 22:29:15,025 - root - INFO -   Rank-1 noise contribution: 0.093
2025-09-16 22:29:15,025 - root - INFO -   Loss change after SAM perturbation: 0.2828
2025-09-16 22:36:23,822 - root - INFO - Burn-in step 3000/8000:
2025-09-16 22:36:23,825 - root - INFO -   Actual drift norm: 2.87e-03
2025-09-16 22:36:23,825 - root - INFO -   Actual noise norm: 3.18e-03
2025-09-16 22:36:23,825 - root - INFO -   Actual drift/noise ratio: 0.902
2025-09-16 22:36:23,825 - root - INFO -   Theoretical step/noise ratio: 51.004
2025-09-16 22:36:23,825 - root - INFO -   Prior/Likelihood ratio: 6.256
2025-09-16 22:36:23,825 - root - INFO -   SAM perturbation norm: 4.90e-01
2025-09-16 22:36:23,825 - root - INFO -   SAM gradient norm: 1.70e+00
2025-09-16 22:36:23,825 - root - INFO -   SAM perturbation/gradient ratio: 0.288
2025-09-16 22:36:23,825 - root - INFO -   Rank-1 noise contribution: 0.096
2025-09-16 22:36:23,826 - root - INFO -   Loss change after SAM perturbation: 0.2031
2025-09-16 22:43:32,722 - root - INFO - Burn-in step 3500/8000:
2025-09-16 22:43:32,725 - root - INFO -   Actual drift norm: 4.14e-03
2025-09-16 22:43:32,725 - root - INFO -   Actual noise norm: 3.15e-03
2025-09-16 22:43:32,725 - root - INFO -   Actual drift/noise ratio: 1.312
2025-09-16 22:43:32,725 - root - INFO -   Theoretical step/noise ratio: 50.479
2025-09-16 22:43:32,725 - root - INFO -   Prior/Likelihood ratio: 15.720
2025-09-16 22:43:32,725 - root - INFO -   SAM perturbation norm: 4.90e-01
2025-09-16 22:43:32,725 - root - INFO -   SAM gradient norm: 2.50e+00
2025-09-16 22:43:32,725 - root - INFO -   SAM perturbation/gradient ratio: 0.196
2025-09-16 22:43:32,725 - root - INFO -   Rank-1 noise contribution: 0.090
2025-09-16 22:43:32,725 - root - INFO -   Loss change after SAM perturbation: 0.2781
2025-09-16 22:50:42,150 - root - INFO - Burn-in step 4000/8000:
2025-09-16 22:50:42,153 - root - INFO -   Actual drift norm: 3.57e-03
2025-09-16 22:50:42,153 - root - INFO -   Actual noise norm: 3.11e-03
2025-09-16 22:50:42,153 - root - INFO -   Actual drift/noise ratio: 1.147
2025-09-16 22:50:42,153 - root - INFO -   Theoretical step/noise ratio: 49.992
2025-09-16 22:50:42,153 - root - INFO -   Prior/Likelihood ratio: 4.397
2025-09-16 22:50:42,153 - root - INFO -   SAM perturbation norm: 4.90e-01
2025-09-16 22:50:42,153 - root - INFO -   SAM gradient norm: 2.20e+00
2025-09-16 22:50:42,153 - root - INFO -   SAM perturbation/gradient ratio: 0.223
2025-09-16 22:50:42,154 - root - INFO -   Rank-1 noise contribution: 0.088
2025-09-16 22:50:42,154 - root - INFO -   Loss change after SAM perturbation: 0.2305
2025-09-16 22:57:51,530 - root - INFO - Burn-in step 4500/8000:
2025-09-16 22:57:51,533 - root - INFO -   Actual drift norm: 3.64e-03
2025-09-16 22:57:51,533 - root - INFO -   Actual noise norm: 3.09e-03
2025-09-16 22:57:51,533 - root - INFO -   Actual drift/noise ratio: 1.177
2025-09-16 22:57:51,533 - root - INFO -   Theoretical step/noise ratio: 49.540
2025-09-16 22:57:51,534 - root - INFO -   Prior/Likelihood ratio: 10.485
2025-09-16 22:57:51,534 - root - INFO -   SAM perturbation norm: 4.90e-01
2025-09-16 22:57:51,534 - root - INFO -   SAM gradient norm: 2.28e+00
2025-09-16 22:57:51,534 - root - INFO -   SAM perturbation/gradient ratio: 0.215
2025-09-16 22:57:51,534 - root - INFO -   Rank-1 noise contribution: 0.090
2025-09-16 22:57:51,534 - root - INFO -   Loss change after SAM perturbation: 0.2462
2025-09-16 23:04:59,910 - root - INFO - Burn-in step 5000/8000:
2025-09-16 23:04:59,912 - root - INFO -   Actual drift norm: 1.42e-03
2025-09-16 23:04:59,913 - root - INFO -   Actual noise norm: 3.06e-03
2025-09-16 23:04:59,913 - root - INFO -   Actual drift/noise ratio: 0.464
2025-09-16 23:04:59,913 - root - INFO -   Theoretical step/noise ratio: 49.117
2025-09-16 23:04:59,913 - root - INFO -   Prior/Likelihood ratio: 14.945
2025-09-16 23:04:59,913 - root - INFO -   SAM perturbation norm: 4.90e-01
2025-09-16 23:04:59,913 - root - INFO -   SAM gradient norm: 9.04e-01
2025-09-16 23:04:59,913 - root - INFO -   SAM perturbation/gradient ratio: 0.542
2025-09-16 23:04:59,913 - root - INFO -   Rank-1 noise contribution: 0.087
2025-09-16 23:04:59,913 - root - INFO -   Loss change after SAM perturbation: 0.1241
2025-09-16 23:12:08,197 - root - INFO - Burn-in step 5500/8000:
2025-09-16 23:12:08,200 - root - INFO -   Actual drift norm: 1.79e-03
2025-09-16 23:12:08,200 - root - INFO -   Actual noise norm: 3.03e-03
2025-09-16 23:12:08,200 - root - INFO -   Actual drift/noise ratio: 0.591
2025-09-16 23:12:08,200 - root - INFO -   Theoretical step/noise ratio: 48.720
2025-09-16 23:12:08,200 - root - INFO -   Prior/Likelihood ratio: 14.420
2025-09-16 23:12:08,200 - root - INFO -   SAM perturbation norm: 4.90e-01
2025-09-16 23:12:08,200 - root - INFO -   SAM gradient norm: 1.16e+00
2025-09-16 23:12:08,200 - root - INFO -   SAM perturbation/gradient ratio: 0.422
2025-09-16 23:12:08,200 - root - INFO -   Rank-1 noise contribution: 0.097
2025-09-16 23:12:08,200 - root - INFO -   Loss change after SAM perturbation: 0.1809
2025-09-16 23:19:16,217 - root - INFO - Burn-in step 6000/8000:
2025-09-16 23:19:16,220 - root - INFO -   Actual drift norm: 3.33e-03
2025-09-16 23:19:16,220 - root - INFO -   Actual noise norm: 3.01e-03
2025-09-16 23:19:16,220 - root - INFO -   Actual drift/noise ratio: 1.106
2025-09-16 23:19:16,220 - root - INFO -   Theoretical step/noise ratio: 48.347
2025-09-16 23:19:16,220 - root - INFO -   Prior/Likelihood ratio: 6.136
2025-09-16 23:19:16,220 - root - INFO -   SAM perturbation norm: 4.90e-01
2025-09-16 23:19:16,221 - root - INFO -   SAM gradient norm: 2.19e+00
2025-09-16 23:19:16,221 - root - INFO -   SAM perturbation/gradient ratio: 0.224
2025-09-16 23:19:16,221 - root - INFO -   Rank-1 noise contribution: 0.097
2025-09-16 23:19:16,221 - root - INFO -   Loss change after SAM perturbation: 0.3491
2025-09-16 23:26:24,352 - root - INFO - Burn-in step 6500/8000:
2025-09-16 23:26:24,355 - root - INFO -   Actual drift norm: 2.19e-03
2025-09-16 23:26:24,355 - root - INFO -   Actual noise norm: 3.00e-03
2025-09-16 23:26:24,355 - root - INFO -   Actual drift/noise ratio: 0.730
2025-09-16 23:26:24,355 - root - INFO -   Theoretical step/noise ratio: 47.994
2025-09-16 23:26:24,355 - root - INFO -   Prior/Likelihood ratio: 4.915
2025-09-16 23:26:24,355 - root - INFO -   SAM perturbation norm: 4.90e-01
2025-09-16 23:26:24,355 - root - INFO -   SAM gradient norm: 1.46e+00
2025-09-16 23:26:24,355 - root - INFO -   SAM perturbation/gradient ratio: 0.335
2025-09-16 23:26:24,356 - root - INFO -   Rank-1 noise contribution: 0.101
2025-09-16 23:26:24,356 - root - INFO -   Loss change after SAM perturbation: 0.1796
2025-09-16 23:33:32,793 - root - INFO - Burn-in step 7000/8000:
2025-09-16 23:33:32,796 - root - INFO -   Actual drift norm: 2.40e-03
2025-09-16 23:33:32,796 - root - INFO -   Actual noise norm: 2.97e-03
2025-09-16 23:33:32,796 - root - INFO -   Actual drift/noise ratio: 0.810
2025-09-16 23:33:32,796 - root - INFO -   Theoretical step/noise ratio: 47.660
2025-09-16 23:33:32,796 - root - INFO -   Prior/Likelihood ratio: 4.973
2025-09-16 23:33:32,796 - root - INFO -   SAM perturbation norm: 4.90e-01
2025-09-16 23:33:32,797 - root - INFO -   SAM gradient norm: 1.63e+00
2025-09-16 23:33:32,797 - root - INFO -   SAM perturbation/gradient ratio: 0.301
2025-09-16 23:33:32,797 - root - INFO -   Rank-1 noise contribution: 0.101
2025-09-16 23:33:32,797 - root - INFO -   Loss change after SAM perturbation: 0.2088
2025-09-16 23:40:41,589 - root - INFO - Burn-in step 7500/8000:
2025-09-16 23:40:41,592 - root - INFO -   Actual drift norm: 1.92e-03
2025-09-16 23:40:41,592 - root - INFO -   Actual noise norm: 2.95e-03
2025-09-16 23:40:41,592 - root - INFO -   Actual drift/noise ratio: 0.652
2025-09-16 23:40:41,592 - root - INFO -   Theoretical step/noise ratio: 47.344
2025-09-16 23:40:41,592 - root - INFO -   Prior/Likelihood ratio: 13.829
2025-09-16 23:40:41,592 - root - INFO -   SAM perturbation norm: 4.90e-01
2025-09-16 23:40:41,592 - root - INFO -   SAM gradient norm: 1.32e+00
2025-09-16 23:40:41,592 - root - INFO -   SAM perturbation/gradient ratio: 0.371
2025-09-16 23:40:41,592 - root - INFO -   Rank-1 noise contribution: 0.089
2025-09-16 23:40:41,593 - root - INFO -   Loss change after SAM perturbation: 0.1578
2025-09-16 23:47:49,140 - root - INFO -   DIAGNOSTIC - Burn-in completed:
2025-09-16 23:47:49,142 - root - INFO -     Avg parameter movement: 0.130920
2025-09-16 23:47:49,142 - root - INFO -     Total parameters moved: 96
2025-09-16 23:47:49,142 - root - INFO - Chain 2: Sampling phase (3000 steps)
2025-09-16 23:47:49,300 - root - INFO -   DIAGNOSTIC - Initial state:
2025-09-16 23:47:49,301 - root - INFO -     Initial prediction: [0, 1]
2025-09-16 23:47:49,301 - root - INFO -     Initial confidence: [0.9318374991416931, 0.0681624636054039]
2025-09-16 23:47:49,305 - root - INFO - Chain 2: Step size after burn-in:
2025-09-16 23:47:49,305 - root - INFO -   Initial: 2.00e-03
2025-09-16 23:47:49,305 - root - INFO -   Final: 1.44e-03
2025-09-16 23:47:49,305 - root - INFO -   Reduction: 28.1%
2025-09-16 23:47:50,354 - root - INFO - Chain 2, Step 0:
2025-09-16 23:47:50,354 - root - INFO -   Actual drift norm: 2.98e-03
2025-09-16 23:47:50,354 - root - INFO -   Actual noise norm: 2.93e-03
2025-09-16 23:47:50,354 - root - INFO -   Actual drift/noise ratio: 1.015
2025-09-16 23:47:50,354 - root - INFO -   Theoretical step/noise ratio: 47.042
2025-09-16 23:47:50,354 - root - INFO -   Prior/Likelihood ratio: 5.912
2025-09-16 23:47:50,354 - root - INFO -   SAM rho: 0.050
2025-09-16 23:47:50,354 - root - INFO -   SAM perturbation norm: 4.90e-01
2025-09-16 23:47:50,354 - root - INFO -   SAM gradient norm: 2.07e+00
2025-09-16 23:47:50,354 - root - INFO -   SAM perturbation/gradient ratio: 0.237
2025-09-16 23:47:50,354 - root - INFO -   Rank-1 noise contribution: 0.090
2025-09-16 23:47:50,354 - root - INFO -   Loss change after SAM perturbation: 0.3226
2025-09-16 23:47:50,355 - root - INFO -   Temperature: 2.0
2025-09-16 23:47:50,526 - root - INFO -   DIAGNOSTIC - Sample 1:
2025-09-16 23:47:50,527 - root - INFO -     Avg parameter movement: 0.000405
2025-09-16 23:47:50,527 - root - INFO -     Prediction changed: True
2025-09-16 23:47:50,527 - root - INFO -     Confidence change: 1.333755
2025-09-16 23:47:50,527 - root - INFO -     Current prediction: [1, 1]
2025-09-16 23:47:50,527 - root - INFO -     Current confidence: [0.006474439986050129, 0.9935256242752075]
2025-09-16 23:47:50,527 - root - INFO - Sampling step 0/3000, step_size: 1.44e-03
2025-09-16 23:48:33,622 - root - INFO -   DIAGNOSTIC - Sample 2:
2025-09-16 23:48:33,623 - root - INFO -     Avg parameter movement: 0.003166
2025-09-16 23:48:33,623 - root - INFO -     Prediction changed: True
2025-09-16 23:48:33,623 - root - INFO -     Confidence change: 1.308459
2025-09-16 23:48:33,624 - root - INFO -     Current prediction: [1, 1]
2025-09-16 23:48:33,624 - root - INFO -     Current confidence: [0.006618733983486891, 0.9933812618255615]
2025-09-16 23:49:16,601 - root - INFO -   DIAGNOSTIC - Sample 3:
2025-09-16 23:49:16,602 - root - INFO -     Avg parameter movement: 0.004562
2025-09-16 23:49:16,603 - root - INFO -     Prediction changed: False
2025-09-16 23:49:16,603 - root - INFO -     Confidence change: 0.027017
2025-09-16 23:49:16,603 - root - INFO -     Current prediction: [0, 1]
2025-09-16 23:49:16,603 - root - INFO -     Current confidence: [0.9509171843528748, 0.04908284917473793]
2025-09-16 23:49:59,543 - root - INFO -   DIAGNOSTIC - Sample 4:
2025-09-16 23:49:59,543 - root - INFO -     Avg parameter movement: 0.005431
2025-09-16 23:49:59,543 - root - INFO -     Prediction changed: True
2025-09-16 23:49:59,543 - root - INFO -     Confidence change: 1.335468
2025-09-16 23:49:59,543 - root - INFO -     Current prediction: [0, 0]
2025-09-16 23:49:59,543 - root - INFO -     Current confidence: [0.9450110793113708, 0.05498896911740303]
2025-09-16 23:50:42,494 - root - INFO -   DIAGNOSTIC - Sample 5:
2025-09-16 23:50:42,495 - root - INFO -     Avg parameter movement: 0.006320
2025-09-16 23:50:42,495 - root - INFO -     Prediction changed: False
2025-09-16 23:50:42,495 - root - INFO -     Confidence change: 0.000711
2025-09-16 23:50:42,495 - root - INFO -     Current prediction: [0, 1]
2025-09-16 23:50:42,495 - root - INFO -     Current confidence: [0.9317378401756287, 0.06826222687959671]
2025-09-16 23:54:17,149 - root - INFO -   DIAGNOSTIC - Sample 10:
2025-09-16 23:54:17,150 - root - INFO -     Avg parameter movement: 0.009865
2025-09-16 23:54:17,151 - root - INFO -     Prediction changed: False
2025-09-16 23:54:17,151 - root - INFO -     Confidence change: 0.007793
2025-09-16 23:54:17,153 - root - INFO -     Current prediction: [0, 1]
2025-09-16 23:54:17,154 - root - INFO -     Current confidence: [0.9265467524528503, 0.07345318794250488]
2025-09-17 00:01:26,548 - root - INFO -   DIAGNOSTIC - Sample 20:
2025-09-17 00:01:26,551 - root - INFO -     Avg parameter movement: 0.015439
2025-09-17 00:01:26,551 - root - INFO -     Prediction changed: True
2025-09-17 00:01:26,551 - root - INFO -     Confidence change: 1.309629
2025-09-17 00:01:26,551 - root - INFO -     Current prediction: [1, 1]
2025-09-17 00:01:26,551 - root - INFO -     Current confidence: [0.005790298338979483, 0.9942097663879395]
2025-09-17 00:02:09,430 - root - INFO - Chain 2, Step 1000:
2025-09-17 00:02:09,431 - root - INFO -   Actual drift norm: 3.73e-03
2025-09-17 00:02:09,431 - root - INFO -   Actual noise norm: 2.93e-03
2025-09-17 00:02:09,431 - root - INFO -   Actual drift/noise ratio: 1.274
2025-09-17 00:02:09,431 - root - INFO -   Theoretical step/noise ratio: 47.042
2025-09-17 00:02:09,431 - root - INFO -   Prior/Likelihood ratio: 13.552
2025-09-17 00:02:09,431 - root - INFO -   SAM rho: 0.050
2025-09-17 00:02:09,431 - root - INFO -   SAM perturbation norm: 4.90e-01
2025-09-17 00:02:09,431 - root - INFO -   SAM gradient norm: 2.59e+00
2025-09-17 00:02:09,431 - root - INFO -   SAM perturbation/gradient ratio: 0.189
2025-09-17 00:02:09,431 - root - INFO -   Rank-1 noise contribution: 0.098
2025-09-17 00:02:09,432 - root - INFO -   Loss change after SAM perturbation: 0.2186
2025-09-17 00:02:09,432 - root - INFO -   Temperature: 2.0
2025-09-17 00:02:09,556 - root - INFO - Sampling step 1000/3000, step_size: 1.44e-03
2025-09-17 00:08:34,817 - root - INFO -   DIAGNOSTIC - Sample 30:
2025-09-17 00:08:34,820 - root - INFO -     Avg parameter movement: 0.020580
2025-09-17 00:08:34,820 - root - INFO -     Prediction changed: True
2025-09-17 00:08:34,820 - root - INFO -     Confidence change: 1.309443
2025-09-17 00:08:34,821 - root - INFO -     Current prediction: [1, 1]
2025-09-17 00:08:34,821 - root - INFO -     Current confidence: [0.005923107266426086, 0.9940768480300903]
2025-09-17 00:15:42,483 - root - INFO -   DIAGNOSTIC - Sample 40:
2025-09-17 00:15:42,485 - root - INFO -     Avg parameter movement: 0.025486
2025-09-17 00:15:42,485 - root - INFO -     Prediction changed: True
2025-09-17 00:15:42,486 - root - INFO -     Confidence change: 1.332903
2025-09-17 00:15:42,486 - root - INFO -     Current prediction: [0, 0]
2025-09-17 00:15:42,486 - root - INFO -     Current confidence: [0.9426087737083435, 0.057391274720430374]
2025-09-17 00:16:25,362 - root - INFO - Chain 2, Step 2000:
2025-09-17 00:16:25,363 - root - INFO -   Actual drift norm: 2.59e-03
2025-09-17 00:16:25,363 - root - INFO -   Actual noise norm: 2.93e-03
2025-09-17 00:16:25,363 - root - INFO -   Actual drift/noise ratio: 0.884
2025-09-17 00:16:25,363 - root - INFO -   Theoretical step/noise ratio: 47.042
2025-09-17 00:16:25,363 - root - INFO -   Prior/Likelihood ratio: 9.628
2025-09-17 00:16:25,363 - root - INFO -   SAM rho: 0.050
2025-09-17 00:16:25,363 - root - INFO -   SAM perturbation norm: 4.90e-01
2025-09-17 00:16:25,363 - root - INFO -   SAM gradient norm: 1.80e+00
2025-09-17 00:16:25,363 - root - INFO -   SAM perturbation/gradient ratio: 0.272
2025-09-17 00:16:25,363 - root - INFO -   Rank-1 noise contribution: 0.105
2025-09-17 00:16:25,363 - root - INFO -   Loss change after SAM perturbation: 0.2438
2025-09-17 00:16:25,363 - root - INFO -   Temperature: 2.0
2025-09-17 00:16:25,490 - root - INFO - Sampling step 2000/3000, step_size: 1.44e-03
2025-09-17 00:22:50,321 - root - INFO -   DIAGNOSTIC - Sample 50:
2025-09-17 00:22:50,323 - root - INFO -     Avg parameter movement: 0.030392
2025-09-17 00:22:50,323 - root - INFO -     Prediction changed: False
2025-09-17 00:22:50,323 - root - INFO -     Confidence change: 0.213698
2025-09-17 00:22:50,324 - root - INFO -     Current prediction: [0, 1]
2025-09-17 00:22:50,324 - root - INFO -     Current confidence: [0.8876985907554626, 0.11230142414569855]
2025-09-17 00:29:58,785 - root - INFO -   DIAGNOSTIC - Sample 60:
2025-09-17 00:29:58,788 - root - INFO -     Avg parameter movement: 0.035063
2025-09-17 00:29:58,788 - root - INFO -     Prediction changed: True
2025-09-17 00:29:58,788 - root - INFO -     Confidence change: 1.309117
2025-09-17 00:29:58,788 - root - INFO -     Current prediction: [1, 1]
2025-09-17 00:29:58,788 - root - INFO -     Current confidence: [0.006152522284537554, 0.9938474297523499]
2025-09-17 00:30:40,637 - root - INFO - Chain 2: Collected 60 samples
2025-09-17 00:30:40,683 - root - INFO -   DIAGNOSTIC - Chain 2 summary:
2025-09-17 00:30:40,683 - root - INFO -     Final avg parameter movement: 0.035528
2025-09-17 00:30:40,683 - root - INFO -     Final prediction changed: True
2025-09-17 00:30:40,683 - root - INFO -     Final confidence change: 1.307597
2025-09-17 00:30:40,683 - root - INFO -     Final prediction: [1, 1]
2025-09-17 00:30:40,683 - root - INFO -     Final confidence: [0.00723601970821619, 0.9927639365196228]
2025-09-17 00:30:40,791 - root - INFO - Running chain 3/4
2025-09-17 00:30:41,420 - root - INFO - Chain 3: MAP model loaded - LoRA param norms: [2.315675735473633, 1.2554264068603516, 2.3865742683410645]
2025-09-17 00:30:41,613 - root - INFO - Chain 3: MAP model test - Loss: 0.4546, Acc: 0.9062
2025-09-17 00:30:41,613 - root - INFO - Chain 3: Initial configuration:
2025-09-17 00:30:41,613 - root - INFO -   Initial step size: 2.00e-03
2025-09-17 00:30:41,613 - root - INFO -   Temperature: 2.0
2025-09-17 00:30:41,613 - root - INFO -   Noise scale: 1.00e-04
2025-09-17 00:30:41,613 - root - INFO -   Prior std: 17.000
2025-09-17 00:30:41,613 - root - INFO -   SAM rho: 0.050
2025-09-17 00:30:41,614 - root - INFO -   Decay rate: 0.300
2025-09-17 00:30:41,614 - root - INFO - Chain 3: Burn-in phase (8000 steps)
2025-09-17 00:30:42,791 - root - INFO - Burn-in step 0/8000:
2025-09-17 00:30:42,791 - root - INFO -   Actual drift norm: 1.00e-02
2025-09-17 00:30:42,791 - root - INFO -   Actual noise norm: 3.45e-03
2025-09-17 00:30:42,791 - root - INFO -   Actual drift/noise ratio: 2.897
2025-09-17 00:30:42,791 - root - INFO -   Theoretical step/noise ratio: 55.470
2025-09-17 00:30:42,791 - root - INFO -   Prior/Likelihood ratio: 7.456
2025-09-17 00:30:42,792 - root - INFO -   SAM perturbation norm: 4.90e-01
2025-09-17 00:30:42,792 - root - INFO -   SAM gradient norm: 7.87e+00
2025-09-17 00:30:42,792 - root - INFO -   SAM perturbation/gradient ratio: 0.062
2025-09-17 00:30:42,792 - root - INFO -   Rank-1 noise contribution: 0.081
2025-09-17 00:30:42,792 - root - INFO -   Loss change after SAM perturbation: 1.1280
2025-09-17 00:37:57,733 - root - INFO - Burn-in step 500/8000:
2025-09-17 00:37:57,736 - root - INFO -   Actual drift norm: 2.92e-03
2025-09-17 00:37:57,736 - root - INFO -   Actual noise norm: 3.40e-03
2025-09-17 00:37:57,736 - root - INFO -   Actual drift/noise ratio: 0.860
2025-09-17 00:37:57,737 - root - INFO -   Theoretical step/noise ratio: 54.499
2025-09-17 00:37:57,737 - root - INFO -   Prior/Likelihood ratio: 12.697
2025-09-17 00:37:57,737 - root - INFO -   SAM perturbation norm: 4.90e-01
2025-09-17 00:37:57,737 - root - INFO -   SAM gradient norm: 1.51e+00
2025-09-17 00:37:57,737 - root - INFO -   SAM perturbation/gradient ratio: 0.323
2025-09-17 00:37:57,737 - root - INFO -   Rank-1 noise contribution: 0.087
2025-09-17 00:37:57,737 - root - INFO -   Loss change after SAM perturbation: 0.2372
2025-09-17 00:45:06,821 - root - INFO - Burn-in step 1000/8000:
2025-09-17 00:45:06,823 - root - INFO -   Actual drift norm: 7.96e-03
2025-09-17 00:45:06,823 - root - INFO -   Actual noise norm: 3.34e-03
2025-09-17 00:45:06,823 - root - INFO -   Actual drift/noise ratio: 2.383
2025-09-17 00:45:06,823 - root - INFO -   Theoretical step/noise ratio: 53.644
2025-09-17 00:45:06,824 - root - INFO -   Prior/Likelihood ratio: 2.489
2025-09-17 00:45:06,824 - root - INFO -   SAM perturbation norm: 4.90e-01
2025-09-17 00:45:06,824 - root - INFO -   SAM gradient norm: 4.25e+00
2025-09-17 00:45:06,824 - root - INFO -   SAM perturbation/gradient ratio: 0.115
2025-09-17 00:45:06,824 - root - INFO -   Rank-1 noise contribution: 0.096
2025-09-17 00:45:06,824 - root - INFO -   Loss change after SAM perturbation: 0.4073
2025-09-17 00:52:24,586 - root - INFO - Burn-in step 1500/8000:
2025-09-17 00:52:24,589 - root - INFO -   Actual drift norm: 7.46e-03
2025-09-17 00:52:24,589 - root - INFO -   Actual noise norm: 3.30e-03
2025-09-17 00:52:24,589 - root - INFO -   Actual drift/noise ratio: 2.263
2025-09-17 00:52:24,589 - root - INFO -   Theoretical step/noise ratio: 52.883
2025-09-17 00:52:24,589 - root - INFO -   Prior/Likelihood ratio: 5.668
2025-09-17 00:52:24,589 - root - INFO -   SAM perturbation norm: 4.90e-01
2025-09-17 00:52:24,590 - root - INFO -   SAM gradient norm: 4.10e+00
2025-09-17 00:52:24,590 - root - INFO -   SAM perturbation/gradient ratio: 0.119
2025-09-17 00:52:24,590 - root - INFO -   Rank-1 noise contribution: 0.093
2025-09-17 00:52:24,590 - root - INFO -   Loss change after SAM perturbation: 0.5403
2025-09-17 00:59:38,012 - root - INFO - Burn-in step 2000/8000:
2025-09-17 00:59:38,015 - root - INFO -   Actual drift norm: 8.85e-03
2025-09-17 00:59:38,015 - root - INFO -   Actual noise norm: 3.25e-03
2025-09-17 00:59:38,015 - root - INFO -   Actual drift/noise ratio: 2.724
2025-09-17 00:59:38,015 - root - INFO -   Theoretical step/noise ratio: 52.197
2025-09-17 00:59:38,016 - root - INFO -   Prior/Likelihood ratio: 3.775
2025-09-17 00:59:38,016 - root - INFO -   SAM perturbation norm: 4.90e-01
2025-09-17 00:59:38,016 - root - INFO -   SAM gradient norm: 7.74e+00
2025-09-17 00:59:38,016 - root - INFO -   SAM perturbation/gradient ratio: 0.063
2025-09-17 00:59:38,016 - root - INFO -   Rank-1 noise contribution: 0.088
2025-09-17 00:59:38,016 - root - INFO -   Loss change after SAM perturbation: 0.2998
2025-09-17 01:06:51,139 - root - INFO - Burn-in step 2500/8000:
2025-09-17 01:06:51,143 - root - INFO -   Actual drift norm: 4.87e-03
2025-09-17 01:06:51,143 - root - INFO -   Actual noise norm: 3.21e-03
2025-09-17 01:06:51,143 - root - INFO -   Actual drift/noise ratio: 1.516
2025-09-17 01:06:51,143 - root - INFO -   Theoretical step/noise ratio: 51.574
2025-09-17 01:06:51,143 - root - INFO -   Prior/Likelihood ratio: 4.698
2025-09-17 01:06:51,143 - root - INFO -   SAM perturbation norm: 4.90e-01
2025-09-17 01:06:51,143 - root - INFO -   SAM gradient norm: 2.82e+00
2025-09-17 01:06:51,143 - root - INFO -   SAM perturbation/gradient ratio: 0.174
2025-09-17 01:06:51,143 - root - INFO -   Rank-1 noise contribution: 0.096
2025-09-17 01:06:51,143 - root - INFO -   Loss change after SAM perturbation: 0.3919
2025-09-17 01:14:03,868 - root - INFO - Burn-in step 3000/8000:
2025-09-17 01:14:03,871 - root - INFO -   Actual drift norm: 1.80e-03
2025-09-17 01:14:03,871 - root - INFO -   Actual noise norm: 3.18e-03
2025-09-17 01:14:03,871 - root - INFO -   Actual drift/noise ratio: 0.565
2025-09-17 01:14:03,871 - root - INFO -   Theoretical step/noise ratio: 51.004
2025-09-17 01:14:03,871 - root - INFO -   Prior/Likelihood ratio: 9.803
2025-09-17 01:14:03,871 - root - INFO -   SAM perturbation norm: 4.90e-01
2025-09-17 01:14:03,871 - root - INFO -   SAM gradient norm: 1.06e+00
2025-09-17 01:14:03,871 - root - INFO -   SAM perturbation/gradient ratio: 0.461
2025-09-17 01:14:03,871 - root - INFO -   Rank-1 noise contribution: 0.091
2025-09-17 01:14:03,871 - root - INFO -   Loss change after SAM perturbation: 0.1259
2025-09-17 01:21:17,550 - root - INFO - Burn-in step 3500/8000:
2025-09-17 01:21:17,553 - root - INFO -   Actual drift norm: 7.76e-03
2025-09-17 01:21:17,553 - root - INFO -   Actual noise norm: 3.15e-03
2025-09-17 01:21:17,553 - root - INFO -   Actual drift/noise ratio: 2.466
2025-09-17 01:21:17,553 - root - INFO -   Theoretical step/noise ratio: 50.479
2025-09-17 01:21:17,553 - root - INFO -   Prior/Likelihood ratio: 13.745
2025-09-17 01:21:17,553 - root - INFO -   SAM perturbation norm: 4.90e-01
2025-09-17 01:21:17,553 - root - INFO -   SAM gradient norm: 4.69e+00
2025-09-17 01:21:17,554 - root - INFO -   SAM perturbation/gradient ratio: 0.105
2025-09-17 01:21:17,554 - root - INFO -   Rank-1 noise contribution: 0.092
2025-09-17 01:21:17,554 - root - INFO -   Loss change after SAM perturbation: 0.4571
2025-09-17 01:28:29,922 - root - INFO - Burn-in step 4000/8000:
2025-09-17 01:28:29,925 - root - INFO -   Actual drift norm: 3.10e-03
2025-09-17 01:28:29,925 - root - INFO -   Actual noise norm: 3.11e-03
2025-09-17 01:28:29,925 - root - INFO -   Actual drift/noise ratio: 0.998
2025-09-17 01:28:29,925 - root - INFO -   Theoretical step/noise ratio: 49.992
2025-09-17 01:28:29,925 - root - INFO -   Prior/Likelihood ratio: 11.341
2025-09-17 01:28:29,925 - root - INFO -   SAM perturbation norm: 4.90e-01
2025-09-17 01:28:29,925 - root - INFO -   SAM gradient norm: 1.91e+00
2025-09-17 01:28:29,925 - root - INFO -   SAM perturbation/gradient ratio: 0.257
2025-09-17 01:28:29,925 - root - INFO -   Rank-1 noise contribution: 0.093
2025-09-17 01:28:29,925 - root - INFO -   Loss change after SAM perturbation: 0.2613
2025-09-17 01:35:43,095 - root - INFO - Burn-in step 4500/8000:
2025-09-17 01:35:43,098 - root - INFO -   Actual drift norm: 3.64e-03
2025-09-17 01:35:43,098 - root - INFO -   Actual noise norm: 3.09e-03
2025-09-17 01:35:43,098 - root - INFO -   Actual drift/noise ratio: 1.179
2025-09-17 01:35:43,098 - root - INFO -   Theoretical step/noise ratio: 49.540
2025-09-17 01:35:43,098 - root - INFO -   Prior/Likelihood ratio: 2.930
2025-09-17 01:35:43,098 - root - INFO -   SAM perturbation norm: 4.90e-01
2025-09-17 01:35:43,098 - root - INFO -   SAM gradient norm: 2.28e+00
2025-09-17 01:35:43,098 - root - INFO -   SAM perturbation/gradient ratio: 0.215
2025-09-17 01:35:43,098 - root - INFO -   Rank-1 noise contribution: 0.092
2025-09-17 01:35:43,099 - root - INFO -   Loss change after SAM perturbation: 0.3702
2025-09-17 01:42:56,513 - root - INFO - Burn-in step 5000/8000:
2025-09-17 01:42:56,516 - root - INFO -   Actual drift norm: 2.46e-03
2025-09-17 01:42:56,516 - root - INFO -   Actual noise norm: 3.06e-03
2025-09-17 01:42:56,516 - root - INFO -   Actual drift/noise ratio: 0.803
2025-09-17 01:42:56,516 - root - INFO -   Theoretical step/noise ratio: 49.117
2025-09-17 01:42:56,516 - root - INFO -   Prior/Likelihood ratio: 13.728
2025-09-17 01:42:56,516 - root - INFO -   SAM perturbation norm: 4.90e-01
2025-09-17 01:42:56,516 - root - INFO -   SAM gradient norm: 1.57e+00
2025-09-17 01:42:56,517 - root - INFO -   SAM perturbation/gradient ratio: 0.312
2025-09-17 01:42:56,517 - root - INFO -   Rank-1 noise contribution: 0.089
2025-09-17 01:42:56,517 - root - INFO -   Loss change after SAM perturbation: 0.1724
2025-09-17 01:50:09,854 - root - INFO - Burn-in step 5500/8000:
2025-09-17 01:50:09,857 - root - INFO -   Actual drift norm: 6.17e-03
2025-09-17 01:50:09,857 - root - INFO -   Actual noise norm: 3.03e-03
2025-09-17 01:50:09,857 - root - INFO -   Actual drift/noise ratio: 2.035
2025-09-17 01:50:09,857 - root - INFO -   Theoretical step/noise ratio: 48.720
2025-09-17 01:50:09,857 - root - INFO -   Prior/Likelihood ratio: 11.145
2025-09-17 01:50:09,857 - root - INFO -   SAM perturbation norm: 4.90e-01
2025-09-17 01:50:09,857 - root - INFO -   SAM gradient norm: 4.00e+00
2025-09-17 01:50:09,857 - root - INFO -   SAM perturbation/gradient ratio: 0.122
2025-09-17 01:50:09,858 - root - INFO -   Rank-1 noise contribution: 0.089
2025-09-17 01:50:09,858 - root - INFO -   Loss change after SAM perturbation: 0.3672
2025-09-17 01:57:23,524 - root - INFO - Burn-in step 6000/8000:
2025-09-17 01:57:23,527 - root - INFO -   Actual drift norm: 7.20e-03
2025-09-17 01:57:23,527 - root - INFO -   Actual noise norm: 3.01e-03
2025-09-17 01:57:23,527 - root - INFO -   Actual drift/noise ratio: 2.390
2025-09-17 01:57:23,527 - root - INFO -   Theoretical step/noise ratio: 48.347
2025-09-17 01:57:23,527 - root - INFO -   Prior/Likelihood ratio: 3.382
2025-09-17 01:57:23,527 - root - INFO -   SAM perturbation norm: 4.90e-01
2025-09-17 01:57:23,527 - root - INFO -   SAM gradient norm: 4.74e+00
2025-09-17 01:57:23,527 - root - INFO -   SAM perturbation/gradient ratio: 0.103
2025-09-17 01:57:23,527 - root - INFO -   Rank-1 noise contribution: 0.084
2025-09-17 01:57:23,528 - root - INFO -   Loss change after SAM perturbation: 0.2786
2025-09-17 02:04:36,603 - root - INFO - Burn-in step 6500/8000:
2025-09-17 02:04:36,605 - root - INFO -   Actual drift norm: 1.84e-03
2025-09-17 02:04:36,605 - root - INFO -   Actual noise norm: 2.99e-03
2025-09-17 02:04:36,605 - root - INFO -   Actual drift/noise ratio: 0.614
2025-09-17 02:04:36,605 - root - INFO -   Theoretical step/noise ratio: 47.994
2025-09-17 02:04:36,606 - root - INFO -   Prior/Likelihood ratio: 9.795
2025-09-17 02:04:36,606 - root - INFO -   SAM perturbation norm: 4.90e-01
2025-09-17 02:04:36,606 - root - INFO -   SAM gradient norm: 1.23e+00
2025-09-17 02:04:36,606 - root - INFO -   SAM perturbation/gradient ratio: 0.400
2025-09-17 02:04:36,606 - root - INFO -   Rank-1 noise contribution: 0.085
2025-09-17 02:04:36,606 - root - INFO -   Loss change after SAM perturbation: 0.1794
2025-09-17 02:11:49,990 - root - INFO - Burn-in step 7000/8000:
2025-09-17 02:11:49,993 - root - INFO -   Actual drift norm: 7.38e-03
2025-09-17 02:11:49,993 - root - INFO -   Actual noise norm: 2.97e-03
2025-09-17 02:11:49,993 - root - INFO -   Actual drift/noise ratio: 2.485
2025-09-17 02:11:49,993 - root - INFO -   Theoretical step/noise ratio: 47.660
2025-09-17 02:11:49,993 - root - INFO -   Prior/Likelihood ratio: 13.173
2025-09-17 02:11:49,993 - root - INFO -   SAM perturbation norm: 4.90e-01
2025-09-17 02:11:49,993 - root - INFO -   SAM gradient norm: 5.13e+00
2025-09-17 02:11:49,993 - root - INFO -   SAM perturbation/gradient ratio: 0.096
2025-09-17 02:11:49,993 - root - INFO -   Rank-1 noise contribution: 0.088
2025-09-17 02:11:49,993 - root - INFO -   Loss change after SAM perturbation: 0.2216
2025-09-17 02:19:03,220 - root - INFO - Burn-in step 7500/8000:
2025-09-17 02:19:03,222 - root - INFO -   Actual drift norm: 3.04e-03
2025-09-17 02:19:03,222 - root - INFO -   Actual noise norm: 2.95e-03
2025-09-17 02:19:03,222 - root - INFO -   Actual drift/noise ratio: 1.032
2025-09-17 02:19:03,222 - root - INFO -   Theoretical step/noise ratio: 47.344
2025-09-17 02:19:03,223 - root - INFO -   Prior/Likelihood ratio: 5.999
2025-09-17 02:19:03,223 - root - INFO -   SAM perturbation norm: 4.90e-01
2025-09-17 02:19:03,223 - root - INFO -   SAM gradient norm: 2.09e+00
2025-09-17 02:19:03,223 - root - INFO -   SAM perturbation/gradient ratio: 0.234
2025-09-17 02:19:03,223 - root - INFO -   Rank-1 noise contribution: 0.086
2025-09-17 02:19:03,223 - root - INFO -   Loss change after SAM perturbation: 0.1131
2025-09-17 02:26:15,271 - root - INFO -   DIAGNOSTIC - Burn-in completed:
2025-09-17 02:26:15,274 - root - INFO -     Avg parameter movement: 0.128239
2025-09-17 02:26:15,274 - root - INFO -     Total parameters moved: 96
2025-09-17 02:26:15,274 - root - INFO - Chain 3: Sampling phase (3000 steps)
2025-09-17 02:26:15,427 - root - INFO -   DIAGNOSTIC - Initial state:
2025-09-17 02:26:15,427 - root - INFO -     Initial prediction: [0, 0]
2025-09-17 02:26:15,427 - root - INFO -     Initial confidence: [0.9586405158042908, 0.04135947301983833]
2025-09-17 02:26:15,432 - root - INFO - Chain 3: Step size after burn-in:
2025-09-17 02:26:15,432 - root - INFO -   Initial: 2.00e-03
2025-09-17 02:26:15,432 - root - INFO -   Final: 1.44e-03
2025-09-17 02:26:15,432 - root - INFO -   Reduction: 28.1%
2025-09-17 02:26:16,499 - root - INFO - Chain 3, Step 0:
2025-09-17 02:26:16,499 - root - INFO -   Actual drift norm: 2.08e-03
2025-09-17 02:26:16,499 - root - INFO -   Actual noise norm: 2.93e-03
2025-09-17 02:26:16,499 - root - INFO -   Actual drift/noise ratio: 0.709
2025-09-17 02:26:16,500 - root - INFO -   Theoretical step/noise ratio: 47.042
2025-09-17 02:26:16,500 - root - INFO -   Prior/Likelihood ratio: 11.032
2025-09-17 02:26:16,500 - root - INFO -   SAM rho: 0.050
2025-09-17 02:26:16,500 - root - INFO -   SAM perturbation norm: 4.90e-01
2025-09-17 02:26:16,500 - root - INFO -   SAM gradient norm: 1.45e+00
2025-09-17 02:26:16,500 - root - INFO -   SAM perturbation/gradient ratio: 0.339
2025-09-17 02:26:16,500 - root - INFO -   Rank-1 noise contribution: 0.091
2025-09-17 02:26:16,500 - root - INFO -   Loss change after SAM perturbation: 0.1571
2025-09-17 02:26:16,500 - root - INFO -   Temperature: 2.0
2025-09-17 02:26:16,669 - root - INFO -   DIAGNOSTIC - Sample 1:
2025-09-17 02:26:16,669 - root - INFO -     Avg parameter movement: 0.000359
2025-09-17 02:26:16,669 - root - INFO -     Prediction changed: True
2025-09-17 02:26:16,669 - root - INFO -     Confidence change: 1.896653
2025-09-17 02:26:16,670 - root - INFO -     Current prediction: [1, 1]
2025-09-17 02:26:16,670 - root - INFO -     Current confidence: [0.011129909195005894, 0.9888701438903809]
2025-09-17 02:26:16,670 - root - INFO - Sampling step 0/3000, step_size: 1.44e-03
2025-09-17 02:26:59,925 - root - INFO -   DIAGNOSTIC - Sample 2:
2025-09-17 02:26:59,925 - root - INFO -     Avg parameter movement: 0.003100
2025-09-17 02:26:59,925 - root - INFO -     Prediction changed: True
2025-09-17 02:26:59,925 - root - INFO -     Confidence change: 1.896834
2025-09-17 02:26:59,925 - root - INFO -     Current prediction: [1, 1]
2025-09-17 02:26:59,925 - root - INFO -     Current confidence: [0.010343722067773342, 0.9896563291549683]
2025-09-17 02:27:43,274 - root - INFO -   DIAGNOSTIC - Sample 3:
2025-09-17 02:27:43,276 - root - INFO -     Avg parameter movement: 0.004426
2025-09-17 02:27:43,276 - root - INFO -     Prediction changed: True
2025-09-17 02:27:43,276 - root - INFO -     Confidence change: 1.341861
2025-09-17 02:27:43,277 - root - INFO -     Current prediction: [1, 0]
2025-09-17 02:27:43,277 - root - INFO -     Current confidence: [0.009802186861634254, 0.9901977777481079]
2025-09-17 02:28:26,593 - root - INFO -   DIAGNOSTIC - Sample 4:
2025-09-17 02:28:26,593 - root - INFO -     Avg parameter movement: 0.005364
2025-09-17 02:28:26,593 - root - INFO -     Prediction changed: True
2025-09-17 02:28:26,593 - root - INFO -     Confidence change: 1.330064
2025-09-17 02:28:26,594 - root - INFO -     Current prediction: [1, 0]
2025-09-17 02:28:26,594 - root - INFO -     Current confidence: [0.01817440055310726, 0.981825590133667]
2025-09-17 02:29:09,948 - root - INFO -   DIAGNOSTIC - Sample 5:
2025-09-17 02:29:09,948 - root - INFO -     Avg parameter movement: 0.006179
2025-09-17 02:29:09,948 - root - INFO -     Prediction changed: True
2025-09-17 02:29:09,948 - root - INFO -     Confidence change: 1.342074
2025-09-17 02:29:09,948 - root - INFO -     Current prediction: [1, 0]
2025-09-17 02:29:09,948 - root - INFO -     Current confidence: [0.009655623696744442, 0.9903443455696106]
2025-09-17 02:32:46,956 - root - INFO -   DIAGNOSTIC - Sample 10:
2025-09-17 02:32:46,958 - root - INFO -     Avg parameter movement: 0.009467
2025-09-17 02:32:46,958 - root - INFO -     Prediction changed: True
2025-09-17 02:32:46,958 - root - INFO -     Confidence change: 1.340858
2025-09-17 02:32:46,959 - root - INFO -     Current prediction: [1, 0]
2025-09-17 02:32:46,959 - root - INFO -     Current confidence: [0.010526388883590698, 0.9894736409187317]
2025-09-17 02:40:00,584 - root - INFO -   DIAGNOSTIC - Sample 20:
2025-09-17 02:40:00,586 - root - INFO -     Avg parameter movement: 0.015397
2025-09-17 02:40:00,586 - root - INFO -     Prediction changed: True
2025-09-17 02:40:00,586 - root - INFO -     Confidence change: 1.897823
2025-09-17 02:40:00,587 - root - INFO -     Current prediction: [1, 1]
2025-09-17 02:40:00,587 - root - INFO -     Current confidence: [0.009223037399351597, 0.9907768964767456]
2025-09-17 02:40:43,958 - root - INFO - Chain 3, Step 1000:
2025-09-17 02:40:43,958 - root - INFO -   Actual drift norm: 1.68e-03
2025-09-17 02:40:43,958 - root - INFO -   Actual noise norm: 2.93e-03
2025-09-17 02:40:43,958 - root - INFO -   Actual drift/noise ratio: 0.574
2025-09-17 02:40:43,959 - root - INFO -   Theoretical step/noise ratio: 47.042
2025-09-17 02:40:43,959 - root - INFO -   Prior/Likelihood ratio: 4.393
2025-09-17 02:40:43,959 - root - INFO -   SAM rho: 0.050
2025-09-17 02:40:43,959 - root - INFO -   SAM perturbation norm: 4.90e-01
2025-09-17 02:40:43,959 - root - INFO -   SAM gradient norm: 1.17e+00
2025-09-17 02:40:43,959 - root - INFO -   SAM perturbation/gradient ratio: 0.419
2025-09-17 02:40:43,959 - root - INFO -   Rank-1 noise contribution: 0.091
2025-09-17 02:40:43,959 - root - INFO -   Loss change after SAM perturbation: 0.1213
2025-09-17 02:40:43,959 - root - INFO -   Temperature: 2.0
2025-09-17 02:40:44,083 - root - INFO - Sampling step 1000/3000, step_size: 1.44e-03
2025-09-17 02:47:13,739 - root - INFO -   DIAGNOSTIC - Sample 30:
2025-09-17 02:47:13,742 - root - INFO -     Avg parameter movement: 0.020501
2025-09-17 02:47:13,742 - root - INFO -     Prediction changed: False
2025-09-17 02:47:13,742 - root - INFO -     Confidence change: 0.024155
2025-09-17 02:47:13,742 - root - INFO -     Current prediction: [0, 0]
2025-09-17 02:47:13,743 - root - INFO -     Current confidence: [0.9752021431922913, 0.024797866120934486]
2025-09-17 02:54:26,528 - root - INFO -   DIAGNOSTIC - Sample 40:
2025-09-17 02:54:26,530 - root - INFO -     Avg parameter movement: 0.025369
2025-09-17 02:54:26,531 - root - INFO -     Prediction changed: True
2025-09-17 02:54:26,531 - root - INFO -     Confidence change: 1.891270
2025-09-17 02:54:26,531 - root - INFO -     Current prediction: [1, 1]
2025-09-17 02:54:26,531 - root - INFO -     Current confidence: [0.013149283826351166, 0.9868506789207458]
2025-09-17 02:55:09,869 - root - INFO - Chain 3, Step 2000:
2025-09-17 02:55:09,869 - root - INFO -   Actual drift norm: 2.83e-03
2025-09-17 02:55:09,869 - root - INFO -   Actual noise norm: 2.94e-03
2025-09-17 02:55:09,869 - root - INFO -   Actual drift/noise ratio: 0.965
2025-09-17 02:55:09,869 - root - INFO -   Theoretical step/noise ratio: 47.042
2025-09-17 02:55:09,870 - root - INFO -   Prior/Likelihood ratio: 16.022
2025-09-17 02:55:09,870 - root - INFO -   SAM rho: 0.050
2025-09-17 02:55:09,870 - root - INFO -   SAM perturbation norm: 4.90e-01
2025-09-17 02:55:09,870 - root - INFO -   SAM gradient norm: 1.97e+00
2025-09-17 02:55:09,870 - root - INFO -   SAM perturbation/gradient ratio: 0.249
2025-09-17 02:55:09,870 - root - INFO -   Rank-1 noise contribution: 0.091
2025-09-17 02:55:09,870 - root - INFO -   Loss change after SAM perturbation: 0.2386
2025-09-17 02:55:09,870 - root - INFO -   Temperature: 2.0
2025-09-17 02:55:09,994 - root - INFO - Sampling step 2000/3000, step_size: 1.44e-03
2025-09-17 03:01:40,025 - root - INFO -   DIAGNOSTIC - Sample 50:
2025-09-17 03:01:40,027 - root - INFO -     Avg parameter movement: 0.030066
2025-09-17 03:01:40,027 - root - INFO -     Prediction changed: True
2025-09-17 03:01:40,027 - root - INFO -     Confidence change: 1.895545
2025-09-17 03:01:40,028 - root - INFO -     Current prediction: [1, 1]
2025-09-17 03:01:40,028 - root - INFO -     Current confidence: [0.012377673760056496, 0.9876223206520081]
2025-09-17 03:08:53,888 - root - INFO -   DIAGNOSTIC - Sample 60:
2025-09-17 03:08:53,890 - root - INFO -     Avg parameter movement: 0.034748
2025-09-17 03:08:53,890 - root - INFO -     Prediction changed: True
2025-09-17 03:08:53,890 - root - INFO -     Confidence change: 1.340688
2025-09-17 03:08:53,890 - root - INFO -     Current prediction: [0, 1]
2025-09-17 03:08:53,891 - root - INFO -     Current confidence: [0.9422183036804199, 0.05778169631958008]
2025-09-17 03:09:36,300 - root - INFO - Chain 3: Collected 60 samples
2025-09-17 03:09:36,343 - root - INFO -   DIAGNOSTIC - Chain 3 summary:
2025-09-17 03:09:36,343 - root - INFO -     Final avg parameter movement: 0.035190
2025-09-17 03:09:36,344 - root - INFO -     Final prediction changed: False
2025-09-17 03:09:36,344 - root - INFO -     Final confidence change: 0.253886
2025-09-17 03:09:36,344 - root - INFO -     Final prediction: [0, 0]
2025-09-17 03:09:36,344 - root - INFO -     Final confidence: [0.9653676748275757, 0.03463229164481163]
2025-09-17 03:09:36,452 - root - INFO - Running chain 4/4
2025-09-17 03:09:37,094 - root - INFO - Chain 4: MAP model loaded - LoRA param norms: [2.315675735473633, 1.2554264068603516, 2.3865742683410645]
2025-09-17 03:09:37,288 - root - INFO - Chain 4: MAP model test - Loss: 0.4546, Acc: 0.9062
2025-09-17 03:09:37,289 - root - INFO - Chain 4: Initial configuration:
2025-09-17 03:09:37,289 - root - INFO -   Initial step size: 2.00e-03
2025-09-17 03:09:37,289 - root - INFO -   Temperature: 2.0
2025-09-17 03:09:37,289 - root - INFO -   Noise scale: 1.00e-04
2025-09-17 03:09:37,289 - root - INFO -   Prior std: 17.000
2025-09-17 03:09:37,289 - root - INFO -   SAM rho: 0.050
2025-09-17 03:09:37,289 - root - INFO -   Decay rate: 0.300
2025-09-17 03:09:37,289 - root - INFO - Chain 4: Burn-in phase (8000 steps)
2025-09-17 03:09:38,491 - root - INFO - Burn-in step 0/8000:
2025-09-17 03:09:38,491 - root - INFO -   Actual drift norm: 1.00e-02
2025-09-17 03:09:38,491 - root - INFO -   Actual noise norm: 3.45e-03
2025-09-17 03:09:38,491 - root - INFO -   Actual drift/noise ratio: 2.900
2025-09-17 03:09:38,491 - root - INFO -   Theoretical step/noise ratio: 55.470
2025-09-17 03:09:38,491 - root - INFO -   Prior/Likelihood ratio: 13.977
2025-09-17 03:09:38,491 - root - INFO -   SAM perturbation norm: 4.90e-01
2025-09-17 03:09:38,491 - root - INFO -   SAM gradient norm: 1.48e+01
2025-09-17 03:09:38,491 - root - INFO -   SAM perturbation/gradient ratio: 0.033
2025-09-17 03:09:38,491 - root - INFO -   Rank-1 noise contribution: 0.091
2025-09-17 03:09:38,492 - root - INFO -   Loss change after SAM perturbation: 1.2998
2025-09-17 03:16:52,302 - root - INFO - Burn-in step 500/8000:
2025-09-17 03:16:52,305 - root - INFO -   Actual drift norm: 5.29e-03
2025-09-17 03:16:52,305 - root - INFO -   Actual noise norm: 3.39e-03
2025-09-17 03:16:52,305 - root - INFO -   Actual drift/noise ratio: 1.557
2025-09-17 03:16:52,305 - root - INFO -   Theoretical step/noise ratio: 54.499
2025-09-17 03:16:52,305 - root - INFO -   Prior/Likelihood ratio: 13.965
2025-09-17 03:16:52,305 - root - INFO -   SAM perturbation norm: 4.90e-01
2025-09-17 03:16:52,306 - root - INFO -   SAM gradient norm: 2.74e+00
2025-09-17 03:16:52,306 - root - INFO -   SAM perturbation/gradient ratio: 0.179
2025-09-17 03:16:52,306 - root - INFO -   Rank-1 noise contribution: 0.096
2025-09-17 03:16:52,306 - root - INFO -   Loss change after SAM perturbation: 0.3256
2025-09-17 03:24:05,832 - root - INFO - Burn-in step 1000/8000:
2025-09-17 03:24:05,835 - root - INFO -   Actual drift norm: 6.03e-03
2025-09-17 03:24:05,835 - root - INFO -   Actual noise norm: 3.34e-03
2025-09-17 03:24:05,835 - root - INFO -   Actual drift/noise ratio: 1.805
2025-09-17 03:24:05,835 - root - INFO -   Theoretical step/noise ratio: 53.644
2025-09-17 03:24:05,836 - root - INFO -   Prior/Likelihood ratio: 2.540
2025-09-17 03:24:05,836 - root - INFO -   SAM perturbation norm: 4.90e-01
2025-09-17 03:24:05,836 - root - INFO -   SAM gradient norm: 3.22e+00
2025-09-17 03:24:05,836 - root - INFO -   SAM perturbation/gradient ratio: 0.152
2025-09-17 03:24:05,836 - root - INFO -   Rank-1 noise contribution: 0.101
2025-09-17 03:24:05,836 - root - INFO -   Loss change after SAM perturbation: 0.2136
2025-09-17 03:31:18,908 - root - INFO - Burn-in step 1500/8000:
2025-09-17 03:31:18,911 - root - INFO -   Actual drift norm: 6.56e-03
2025-09-17 03:31:18,911 - root - INFO -   Actual noise norm: 3.29e-03
2025-09-17 03:31:18,911 - root - INFO -   Actual drift/noise ratio: 1.994
2025-09-17 03:31:18,911 - root - INFO -   Theoretical step/noise ratio: 52.883
2025-09-17 03:31:18,911 - root - INFO -   Prior/Likelihood ratio: 7.693
2025-09-17 03:31:18,911 - root - INFO -   SAM perturbation norm: 4.90e-01
2025-09-17 03:31:18,911 - root - INFO -   SAM gradient norm: 3.61e+00
2025-09-17 03:31:18,912 - root - INFO -   SAM perturbation/gradient ratio: 0.136
2025-09-17 03:31:18,912 - root - INFO -   Rank-1 noise contribution: 0.091
2025-09-17 03:31:18,912 - root - INFO -   Loss change after SAM perturbation: 0.2882
2025-09-17 03:38:31,765 - root - INFO - Burn-in step 2000/8000:
2025-09-17 03:38:31,768 - root - INFO -   Actual drift norm: 2.17e-03
2025-09-17 03:38:31,768 - root - INFO -   Actual noise norm: 3.25e-03
2025-09-17 03:38:31,768 - root - INFO -   Actual drift/noise ratio: 0.666
2025-09-17 03:38:31,768 - root - INFO -   Theoretical step/noise ratio: 52.197
2025-09-17 03:38:31,769 - root - INFO -   Prior/Likelihood ratio: 2.500
2025-09-17 03:38:31,769 - root - INFO -   SAM perturbation norm: 4.90e-01
2025-09-17 03:38:31,769 - root - INFO -   SAM gradient norm: 1.22e+00
2025-09-17 03:38:31,769 - root - INFO -   SAM perturbation/gradient ratio: 0.401
2025-09-17 03:38:31,769 - root - INFO -   Rank-1 noise contribution: 0.099
2025-09-17 03:38:31,769 - root - INFO -   Loss change after SAM perturbation: 0.1796
2025-09-17 03:45:44,931 - root - INFO - Burn-in step 2500/8000:
2025-09-17 03:45:44,934 - root - INFO -   Actual drift norm: 3.47e-03
2025-09-17 03:45:44,934 - root - INFO -   Actual noise norm: 3.21e-03
2025-09-17 03:45:44,934 - root - INFO -   Actual drift/noise ratio: 1.082
2025-09-17 03:45:44,934 - root - INFO -   Theoretical step/noise ratio: 51.574
2025-09-17 03:45:44,934 - root - INFO -   Prior/Likelihood ratio: 2.672
2025-09-17 03:45:44,934 - root - INFO -   SAM perturbation norm: 4.90e-01
2025-09-17 03:45:44,935 - root - INFO -   SAM gradient norm: 2.01e+00
2025-09-17 03:45:44,935 - root - INFO -   SAM perturbation/gradient ratio: 0.244
2025-09-17 03:45:44,935 - root - INFO -   Rank-1 noise contribution: 0.108
2025-09-17 03:45:44,935 - root - INFO -   Loss change after SAM perturbation: 0.2210
2025-09-17 03:52:58,890 - root - INFO - Burn-in step 3000/8000:
2025-09-17 03:52:58,893 - root - INFO -   Actual drift norm: 2.46e-03
2025-09-17 03:52:58,893 - root - INFO -   Actual noise norm: 3.17e-03
2025-09-17 03:52:58,893 - root - INFO -   Actual drift/noise ratio: 0.775
2025-09-17 03:52:58,893 - root - INFO -   Theoretical step/noise ratio: 51.004
2025-09-17 03:52:58,893 - root - INFO -   Prior/Likelihood ratio: 6.906
2025-09-17 03:52:58,893 - root - INFO -   SAM perturbation norm: 4.90e-01
2025-09-17 03:52:58,893 - root - INFO -   SAM gradient norm: 1.46e+00
2025-09-17 03:52:58,893 - root - INFO -   SAM perturbation/gradient ratio: 0.337
2025-09-17 03:52:58,893 - root - INFO -   Rank-1 noise contribution: 0.093
2025-09-17 03:52:58,893 - root - INFO -   Loss change after SAM perturbation: 0.1606
2025-09-17 04:00:13,216 - root - INFO - Burn-in step 3500/8000:
2025-09-17 04:00:13,219 - root - INFO -   Actual drift norm: 4.03e-03
2025-09-17 04:00:13,219 - root - INFO -   Actual noise norm: 3.14e-03
2025-09-17 04:00:13,219 - root - INFO -   Actual drift/noise ratio: 1.281
2025-09-17 04:00:13,219 - root - INFO -   Theoretical step/noise ratio: 50.479
2025-09-17 04:00:13,219 - root - INFO -   Prior/Likelihood ratio: 6.073
2025-09-17 04:00:13,219 - root - INFO -   SAM perturbation norm: 4.90e-01
2025-09-17 04:00:13,219 - root - INFO -   SAM gradient norm: 2.43e+00
2025-09-17 04:00:13,219 - root - INFO -   SAM perturbation/gradient ratio: 0.201
2025-09-17 04:00:13,219 - root - INFO -   Rank-1 noise contribution: 0.079
2025-09-17 04:00:13,220 - root - INFO -   Loss change after SAM perturbation: 0.3448
2025-09-17 04:07:26,958 - root - INFO - Burn-in step 4000/8000:
2025-09-17 04:07:26,960 - root - INFO -   Actual drift norm: 2.52e-03
2025-09-17 04:07:26,960 - root - INFO -   Actual noise norm: 3.12e-03
2025-09-17 04:07:26,960 - root - INFO -   Actual drift/noise ratio: 0.808
2025-09-17 04:07:26,960 - root - INFO -   Theoretical step/noise ratio: 49.992
2025-09-17 04:07:26,961 - root - INFO -   Prior/Likelihood ratio: 6.964
2025-09-17 04:07:26,961 - root - INFO -   SAM perturbation norm: 4.90e-01
2025-09-17 04:07:26,961 - root - INFO -   SAM gradient norm: 1.55e+00
2025-09-17 04:07:26,961 - root - INFO -   SAM perturbation/gradient ratio: 0.316
2025-09-17 04:07:26,961 - root - INFO -   Rank-1 noise contribution: 0.091
2025-09-17 04:07:26,961 - root - INFO -   Loss change after SAM perturbation: 0.1971
2025-09-17 04:14:40,335 - root - INFO - Burn-in step 4500/8000:
2025-09-17 04:14:40,337 - root - INFO -   Actual drift norm: 2.83e-03
2025-09-17 04:14:40,338 - root - INFO -   Actual noise norm: 3.09e-03
2025-09-17 04:14:40,338 - root - INFO -   Actual drift/noise ratio: 0.916
2025-09-17 04:14:40,338 - root - INFO -   Theoretical step/noise ratio: 49.540
2025-09-17 04:14:40,338 - root - INFO -   Prior/Likelihood ratio: 7.033
2025-09-17 04:14:40,338 - root - INFO -   SAM perturbation norm: 4.90e-01
2025-09-17 04:14:40,338 - root - INFO -   SAM gradient norm: 1.77e+00
2025-09-17 04:14:40,338 - root - INFO -   SAM perturbation/gradient ratio: 0.276
2025-09-17 04:14:40,338 - root - INFO -   Rank-1 noise contribution: 0.091
2025-09-17 04:14:40,338 - root - INFO -   Loss change after SAM perturbation: 0.2441
2025-09-17 04:21:52,596 - root - INFO - Burn-in step 5000/8000:
2025-09-17 04:21:52,599 - root - INFO -   Actual drift norm: 5.73e-03
2025-09-17 04:21:52,599 - root - INFO -   Actual noise norm: 3.06e-03
2025-09-17 04:21:52,599 - root - INFO -   Actual drift/noise ratio: 1.874
2025-09-17 04:21:52,599 - root - INFO -   Theoretical step/noise ratio: 49.117
2025-09-17 04:21:52,599 - root - INFO -   Prior/Likelihood ratio: 8.055
2025-09-17 04:21:52,599 - root - INFO -   SAM perturbation norm: 4.90e-01
2025-09-17 04:21:52,599 - root - INFO -   SAM gradient norm: 3.65e+00
2025-09-17 04:21:52,599 - root - INFO -   SAM perturbation/gradient ratio: 0.134
2025-09-17 04:21:52,600 - root - INFO -   Rank-1 noise contribution: 0.100
2025-09-17 04:21:52,600 - root - INFO -   Loss change after SAM perturbation: 0.3170
2025-09-17 04:29:05,668 - root - INFO - Burn-in step 5500/8000:
2025-09-17 04:29:05,671 - root - INFO -   Actual drift norm: 6.54e-03
2025-09-17 04:29:05,671 - root - INFO -   Actual noise norm: 3.03e-03
2025-09-17 04:29:05,671 - root - INFO -   Actual drift/noise ratio: 2.156
2025-09-17 04:29:05,671 - root - INFO -   Theoretical step/noise ratio: 48.720
2025-09-17 04:29:05,671 - root - INFO -   Prior/Likelihood ratio: 15.528
2025-09-17 04:29:05,671 - root - INFO -   SAM perturbation norm: 4.90e-01
2025-09-17 04:29:05,671 - root - INFO -   SAM gradient norm: 4.24e+00
2025-09-17 04:29:05,671 - root - INFO -   SAM perturbation/gradient ratio: 0.116
2025-09-17 04:29:05,671 - root - INFO -   Rank-1 noise contribution: 0.096
2025-09-17 04:29:05,671 - root - INFO -   Loss change after SAM perturbation: 0.2810
2025-09-17 04:36:19,184 - root - INFO - Burn-in step 6000/8000:
2025-09-17 04:36:19,187 - root - INFO -   Actual drift norm: 3.89e-03
2025-09-17 04:36:19,187 - root - INFO -   Actual noise norm: 3.01e-03
2025-09-17 04:36:19,187 - root - INFO -   Actual drift/noise ratio: 1.292
2025-09-17 04:36:19,188 - root - INFO -   Theoretical step/noise ratio: 48.347
2025-09-17 04:36:19,188 - root - INFO -   Prior/Likelihood ratio: 10.851
2025-09-17 04:36:19,188 - root - INFO -   SAM perturbation norm: 4.90e-01
2025-09-17 04:36:19,188 - root - INFO -   SAM gradient norm: 2.56e+00
2025-09-17 04:36:19,188 - root - INFO -   SAM perturbation/gradient ratio: 0.191
2025-09-17 04:36:19,188 - root - INFO -   Rank-1 noise contribution: 0.096
2025-09-17 04:36:19,188 - root - INFO -   Loss change after SAM perturbation: 0.2141
2025-09-17 04:43:32,234 - root - INFO - Burn-in step 6500/8000:
2025-09-17 04:43:32,236 - root - INFO -   Actual drift norm: 3.31e-03
2025-09-17 04:43:32,236 - root - INFO -   Actual noise norm: 3.00e-03
2025-09-17 04:43:32,237 - root - INFO -   Actual drift/noise ratio: 1.104
2025-09-17 04:43:32,237 - root - INFO -   Theoretical step/noise ratio: 47.994
2025-09-17 04:43:32,237 - root - INFO -   Prior/Likelihood ratio: 8.763
2025-09-17 04:43:32,237 - root - INFO -   SAM perturbation norm: 4.90e-01
2025-09-17 04:43:32,237 - root - INFO -   SAM gradient norm: 2.21e+00
2025-09-17 04:43:32,237 - root - INFO -   SAM perturbation/gradient ratio: 0.222
2025-09-17 04:43:32,237 - root - INFO -   Rank-1 noise contribution: 0.087
2025-09-17 04:43:32,237 - root - INFO -   Loss change after SAM perturbation: 0.1590
2025-09-17 04:50:45,815 - root - INFO - Burn-in step 7000/8000:
2025-09-17 04:50:45,817 - root - INFO -   Actual drift norm: 2.50e-03
2025-09-17 04:50:45,817 - root - INFO -   Actual noise norm: 2.97e-03
2025-09-17 04:50:45,817 - root - INFO -   Actual drift/noise ratio: 0.841
2025-09-17 04:50:45,817 - root - INFO -   Theoretical step/noise ratio: 47.660
2025-09-17 04:50:45,817 - root - INFO -   Prior/Likelihood ratio: 8.521
2025-09-17 04:50:45,817 - root - INFO -   SAM perturbation norm: 4.90e-01
2025-09-17 04:50:45,817 - root - INFO -   SAM gradient norm: 1.69e+00
2025-09-17 04:50:45,817 - root - INFO -   SAM perturbation/gradient ratio: 0.290
2025-09-17 04:50:45,818 - root - INFO -   Rank-1 noise contribution: 0.100
2025-09-17 04:50:45,818 - root - INFO -   Loss change after SAM perturbation: 0.1336
2025-09-17 04:57:59,479 - root - INFO - Burn-in step 7500/8000:
2025-09-17 04:57:59,482 - root - INFO -   Actual drift norm: 1.72e-03
2025-09-17 04:57:59,482 - root - INFO -   Actual noise norm: 2.95e-03
2025-09-17 04:57:59,482 - root - INFO -   Actual drift/noise ratio: 0.584
2025-09-17 04:57:59,482 - root - INFO -   Theoretical step/noise ratio: 47.344
2025-09-17 04:57:59,482 - root - INFO -   Prior/Likelihood ratio: 7.514
2025-09-17 04:57:59,482 - root - INFO -   SAM perturbation norm: 4.90e-01
2025-09-17 04:57:59,482 - root - INFO -   SAM gradient norm: 1.18e+00
2025-09-17 04:57:59,482 - root - INFO -   SAM perturbation/gradient ratio: 0.415
2025-09-17 04:57:59,482 - root - INFO -   Rank-1 noise contribution: 0.092
2025-09-17 04:57:59,483 - root - INFO -   Loss change after SAM perturbation: 0.2384
2025-09-17 05:05:12,284 - root - INFO -   DIAGNOSTIC - Burn-in completed:
2025-09-17 05:05:12,287 - root - INFO -     Avg parameter movement: 0.131045
2025-09-17 05:05:12,287 - root - INFO -     Total parameters moved: 96
2025-09-17 05:05:12,287 - root - INFO - Chain 4: Sampling phase (3000 steps)
2025-09-17 05:05:12,439 - root - INFO -   DIAGNOSTIC - Initial state:
2025-09-17 05:05:12,439 - root - INFO -     Initial prediction: [1, 1]
2025-09-17 05:05:12,440 - root - INFO -     Initial confidence: [0.006360191386193037, 0.9936397671699524]
2025-09-17 05:05:12,444 - root - INFO - Chain 4: Step size after burn-in:
2025-09-17 05:05:12,444 - root - INFO -   Initial: 2.00e-03
2025-09-17 05:05:12,444 - root - INFO -   Final: 1.44e-03
2025-09-17 05:05:12,444 - root - INFO -   Reduction: 28.1%
2025-09-17 05:05:13,509 - root - INFO - Chain 4, Step 0:
2025-09-17 05:05:13,509 - root - INFO -   Actual drift norm: 7.19e-03
2025-09-17 05:05:13,509 - root - INFO -   Actual noise norm: 2.93e-03
2025-09-17 05:05:13,509 - root - INFO -   Actual drift/noise ratio: 2.453
2025-09-17 05:05:13,509 - root - INFO -   Theoretical step/noise ratio: 47.042
2025-09-17 05:05:13,509 - root - INFO -   Prior/Likelihood ratio: 4.380
2025-09-17 05:05:13,509 - root - INFO -   SAM rho: 0.050
2025-09-17 05:05:13,510 - root - INFO -   SAM perturbation norm: 4.90e-01
2025-09-17 05:05:13,510 - root - INFO -   SAM gradient norm: 5.87e+00
2025-09-17 05:05:13,510 - root - INFO -   SAM perturbation/gradient ratio: 0.083
2025-09-17 05:05:13,510 - root - INFO -   Rank-1 noise contribution: 0.086
2025-09-17 05:05:13,510 - root - INFO -   Loss change after SAM perturbation: 0.3733
2025-09-17 05:05:13,510 - root - INFO -   Temperature: 2.0
2025-09-17 05:05:13,679 - root - INFO -   DIAGNOSTIC - Sample 1:
2025-09-17 05:05:13,679 - root - INFO -     Avg parameter movement: 0.000682
2025-09-17 05:05:13,679 - root - INFO -     Prediction changed: True
2025-09-17 05:05:13,680 - root - INFO -     Confidence change: 1.318750
2025-09-17 05:05:13,680 - root - INFO -     Current prediction: [0, 1]
2025-09-17 05:05:13,680 - root - INFO -     Current confidence: [0.9388561248779297, 0.06114394590258598]
2025-09-17 05:05:13,680 - root - INFO - Sampling step 0/3000, step_size: 1.44e-03
2025-09-17 05:05:57,373 - root - INFO -   DIAGNOSTIC - Sample 2:
2025-09-17 05:05:57,374 - root - INFO -     Avg parameter movement: 0.003221
2025-09-17 05:05:57,375 - root - INFO -     Prediction changed: True
2025-09-17 05:05:57,375 - root - INFO -     Confidence change: 1.295614
2025-09-17 05:05:57,375 - root - INFO -     Current prediction: [1, 0]
2025-09-17 05:05:57,375 - root - INFO -     Current confidence: [0.010072845034301281, 0.9899271726608276]
2025-09-17 05:06:40,693 - root - INFO -   DIAGNOSTIC - Sample 3:
2025-09-17 05:06:40,693 - root - INFO -     Avg parameter movement: 0.004407
2025-09-17 05:06:40,693 - root - INFO -     Prediction changed: False
2025-09-17 05:06:40,693 - root - INFO -     Confidence change: 0.001812
2025-09-17 05:06:40,693 - root - INFO -     Current prediction: [1, 1]
2025-09-17 05:06:40,694 - root - INFO -     Current confidence: [0.006670023780316114, 0.9933299422264099]
2025-09-17 05:07:24,015 - root - INFO -   DIAGNOSTIC - Sample 4:
2025-09-17 05:07:24,015 - root - INFO -     Avg parameter movement: 0.005578
2025-09-17 05:07:24,015 - root - INFO -     Prediction changed: False
2025-09-17 05:07:24,015 - root - INFO -     Confidence change: 0.037298
2025-09-17 05:07:24,015 - root - INFO -     Current prediction: [1, 1]
2025-09-17 05:07:24,015 - root - INFO -     Current confidence: [0.03269759565591812, 0.9673023819923401]
2025-09-17 05:08:07,360 - root - INFO -   DIAGNOSTIC - Sample 5:
2025-09-17 05:08:07,360 - root - INFO -     Avg parameter movement: 0.006544
2025-09-17 05:08:07,361 - root - INFO -     Prediction changed: True
2025-09-17 05:08:07,361 - root - INFO -     Confidence change: 1.023893
2025-09-17 05:08:07,361 - root - INFO -     Current prediction: [1, 0]
2025-09-17 05:08:07,361 - root - INFO -     Current confidence: [0.006059649866074324, 0.9939403533935547]
2025-09-17 05:11:44,264 - root - INFO -   DIAGNOSTIC - Sample 10:
2025-09-17 05:11:44,266 - root - INFO -     Avg parameter movement: 0.010038
2025-09-17 05:11:44,266 - root - INFO -     Prediction changed: True
2025-09-17 05:11:44,266 - root - INFO -     Confidence change: 1.327786
2025-09-17 05:11:44,267 - root - INFO -     Current prediction: [0, 1]
2025-09-17 05:11:44,267 - root - INFO -     Current confidence: [0.9452463984489441, 0.05475355684757233]
2025-09-17 05:18:56,603 - root - INFO -   DIAGNOSTIC - Sample 20:
2025-09-17 05:18:56,605 - root - INFO -     Avg parameter movement: 0.015479
2025-09-17 05:18:56,605 - root - INFO -     Prediction changed: True
2025-09-17 05:18:56,605 - root - INFO -     Confidence change: 1.300201
2025-09-17 05:18:56,606 - root - INFO -     Current prediction: [1, 0]
2025-09-17 05:18:56,606 - root - INFO -     Current confidence: [0.005445676390081644, 0.9945542812347412]
2025-09-17 05:19:40,010 - root - INFO - Chain 4, Step 1000:
2025-09-17 05:19:40,010 - root - INFO -   Actual drift norm: 4.10e-03
2025-09-17 05:19:40,010 - root - INFO -   Actual noise norm: 2.93e-03
2025-09-17 05:19:40,011 - root - INFO -   Actual drift/noise ratio: 1.396
2025-09-17 05:19:40,011 - root - INFO -   Theoretical step/noise ratio: 47.042
2025-09-17 05:19:40,011 - root - INFO -   Prior/Likelihood ratio: 4.384
2025-09-17 05:19:40,011 - root - INFO -   SAM rho: 0.050
2025-09-17 05:19:40,011 - root - INFO -   SAM perturbation norm: 4.90e-01
2025-09-17 05:19:40,011 - root - INFO -   SAM gradient norm: 2.85e+00
2025-09-17 05:19:40,011 - root - INFO -   SAM perturbation/gradient ratio: 0.172
2025-09-17 05:19:40,011 - root - INFO -   Rank-1 noise contribution: 0.086
2025-09-17 05:19:40,011 - root - INFO -   Loss change after SAM perturbation: 0.3868
2025-09-17 05:19:40,011 - root - INFO -   Temperature: 2.0
2025-09-17 05:19:40,136 - root - INFO - Sampling step 1000/3000, step_size: 1.44e-03
2025-09-17 05:26:09,798 - root - INFO -   DIAGNOSTIC - Sample 30:
2025-09-17 05:26:09,800 - root - INFO -     Avg parameter movement: 0.020471
2025-09-17 05:26:09,800 - root - INFO -     Prediction changed: True
2025-09-17 05:26:09,800 - root - INFO -     Confidence change: 1.885622
2025-09-17 05:26:09,801 - root - INFO -     Current prediction: [0, 0]
2025-09-17 05:26:09,801 - root - INFO -     Current confidence: [0.9520918726921082, 0.047908175736665726]
2025-09-17 05:33:22,847 - root - INFO -   DIAGNOSTIC - Sample 40:
2025-09-17 05:33:22,849 - root - INFO -     Avg parameter movement: 0.025479
2025-09-17 05:33:22,849 - root - INFO -     Prediction changed: False
2025-09-17 05:33:22,849 - root - INFO -     Confidence change: 0.007632
2025-09-17 05:33:22,850 - root - INFO -     Current prediction: [1, 1]
2025-09-17 05:33:22,850 - root - INFO -     Current confidence: [0.005619645118713379, 0.9943804144859314]
2025-09-17 05:34:06,169 - root - INFO - Chain 4, Step 2000:
2025-09-17 05:34:06,169 - root - INFO -   Actual drift norm: 2.76e-03
2025-09-17 05:34:06,170 - root - INFO -   Actual noise norm: 2.94e-03
2025-09-17 05:34:06,170 - root - INFO -   Actual drift/noise ratio: 0.940
2025-09-17 05:34:06,170 - root - INFO -   Theoretical step/noise ratio: 47.042
2025-09-17 05:34:06,170 - root - INFO -   Prior/Likelihood ratio: 8.422
2025-09-17 05:34:06,170 - root - INFO -   SAM rho: 0.050
2025-09-17 05:34:06,170 - root - INFO -   SAM perturbation norm: 4.90e-01
2025-09-17 05:34:06,170 - root - INFO -   SAM gradient norm: 1.92e+00
2025-09-17 05:34:06,170 - root - INFO -   SAM perturbation/gradient ratio: 0.255
2025-09-17 05:34:06,170 - root - INFO -   Rank-1 noise contribution: 0.080
2025-09-17 05:34:06,170 - root - INFO -   Loss change after SAM perturbation: 0.2606
2025-09-17 05:34:06,170 - root - INFO -   Temperature: 2.0
2025-09-17 05:34:06,295 - root - INFO - Sampling step 2000/3000, step_size: 1.44e-03
2025-09-17 05:40:35,862 - root - INFO -   DIAGNOSTIC - Sample 50:
2025-09-17 05:40:35,864 - root - INFO -     Avg parameter movement: 0.030348
2025-09-17 05:40:35,864 - root - INFO -     Prediction changed: False
2025-09-17 05:40:35,864 - root - INFO -     Confidence change: 0.000424
2025-09-17 05:40:35,865 - root - INFO -     Current prediction: [1, 1]
2025-09-17 05:40:35,865 - root - INFO -     Current confidence: [0.006146181374788284, 0.9938538074493408]
2025-09-17 05:47:49,551 - root - INFO -   DIAGNOSTIC - Sample 60:
2025-09-17 05:47:49,553 - root - INFO -     Avg parameter movement: 0.035122
2025-09-17 05:47:49,553 - root - INFO -     Prediction changed: True
2025-09-17 05:47:49,553 - root - INFO -     Confidence change: 1.340933
2025-09-17 05:47:49,554 - root - INFO -     Current prediction: [1, 0]
2025-09-17 05:47:49,554 - root - INFO -     Current confidence: [0.005612510722130537, 0.9943874478340149]
2025-09-17 05:48:31,951 - root - INFO - Chain 4: Collected 60 samples
2025-09-17 05:48:31,995 - root - INFO -   DIAGNOSTIC - Chain 4 summary:
2025-09-17 05:48:31,995 - root - INFO -     Final avg parameter movement: 0.035531
2025-09-17 05:48:31,996 - root - INFO -     Final prediction changed: True
2025-09-17 05:48:31,996 - root - INFO -     Final confidence change: 1.315189
2025-09-17 05:48:31,996 - root - INFO -     Final prediction: [0, 1]
2025-09-17 05:48:31,996 - root - INFO -     Final confidence: [0.9363393187522888, 0.063660629093647]
2025-09-17 05:48:32,104 - root - INFO - Total samples collected: 240
2025-09-17 05:48:32,104 - root - INFO - Computing overall MCMC diagnostics...
2025-09-17 05:48:32,104 - root - INFO - SAM-SGLD sampling completed with 240 total samples
2025-09-17 05:48:32,305 - root - INFO - Final model after sampling - Loss: 0.1680, Acc: 0.9375
2025-09-17 05:48:32,305 - root - INFO - ESS and R-hat will be computed during evaluation phase
2025-09-17 05:48:35,754 - root - INFO - SAM-SGLD samples saved to runs/mrpc_roberta_lora_samsgld_rank1/samsgld_samples.pth
2025-09-17 05:48:35,754 - root - INFO - Training completed successfully!
Total parameters: 125,829,124
Trainable (LoRA) parameters: 589,824
Frozen (base) parameters: 125,239,300
LoRA ratio: 0.47%
✅ SAM-SGLD LoRA training completed successfully!
=== Phase 2: Evaluating SAM-SGLD LoRA Results ===
2025-09-17 05:49:02,881 - root - INFO - Using device: cuda
2025-09-17 05:49:02,883 - root - INFO - Loading MAP model...
Some weights of RobertaForSequenceClassification were not initialized from the model checkpoint at roberta-base and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2025-09-17 05:49:04,354 - root - INFO - Loading samples...
2025-09-17 05:49:04,354 - root - INFO - Loading samples from: runs/mrpc_roberta_lora_samsgld_rank1/samsgld_samples.pth
2025-09-17 05:49:08,747 - root - INFO - Loaded 240 samples from file
2025-09-17 05:49:08,748 - root - WARNING - No diagnostic values found, will recompute from samples
2025-09-17 05:49:10,397 - root - INFO - Evaluating MAP model...
2025-09-17 05:49:13,269 - root - INFO - Config: chains=4, samples_to_retain=240
2025-09-17 05:49:13,269 - root - INFO - Actual: 240 samples loaded
2025-09-17 05:49:13,503 - root - INFO - Evaluating sample 1/240
2025-09-17 05:49:15,911 - root - INFO - Evaluating sample 2/240
2025-09-17 05:49:18,334 - root - INFO - Evaluating sample 3/240
2025-09-17 05:49:20,764 - root - INFO - Evaluating sample 4/240
2025-09-17 05:49:23,207 - root - INFO - Evaluating sample 5/240
2025-09-17 05:49:25,656 - root - INFO - Evaluating sample 6/240
2025-09-17 05:49:28,119 - root - INFO - Evaluating sample 7/240
2025-09-17 05:49:30,577 - root - INFO - Evaluating sample 8/240
2025-09-17 05:49:33,034 - root - INFO - Evaluating sample 9/240
2025-09-17 05:49:35,492 - root - INFO - Evaluating sample 10/240
2025-09-17 05:49:37,949 - root - INFO - Evaluating sample 11/240
2025-09-17 05:49:40,412 - root - INFO - Evaluating sample 12/240
2025-09-17 05:49:42,874 - root - INFO - Evaluating sample 13/240
2025-09-17 05:49:45,330 - root - INFO - Evaluating sample 14/240
2025-09-17 05:49:47,789 - root - INFO - Evaluating sample 15/240
2025-09-17 05:49:50,249 - root - INFO - Evaluating sample 16/240
2025-09-17 05:49:52,708 - root - INFO - Evaluating sample 17/240
2025-09-17 05:49:55,176 - root - INFO - Evaluating sample 18/240
2025-09-17 05:49:57,637 - root - INFO - Evaluating sample 19/240
2025-09-17 05:50:00,094 - root - INFO - Evaluating sample 20/240
2025-09-17 05:50:02,568 - root - INFO - Evaluating sample 21/240
2025-09-17 05:50:05,031 - root - INFO - Evaluating sample 22/240
2025-09-17 05:50:07,501 - root - INFO - Evaluating sample 23/240
2025-09-17 05:50:09,975 - root - INFO - Evaluating sample 24/240
2025-09-17 05:50:12,457 - root - INFO - Evaluating sample 25/240
2025-09-17 05:50:14,937 - root - INFO - Evaluating sample 26/240
2025-09-17 05:50:17,417 - root - INFO - Evaluating sample 27/240
2025-09-17 05:50:19,898 - root - INFO - Evaluating sample 28/240
2025-09-17 05:50:22,375 - root - INFO - Evaluating sample 29/240
2025-09-17 05:50:24,855 - root - INFO - Evaluating sample 30/240
2025-09-17 05:50:27,334 - root - INFO - Evaluating sample 31/240
2025-09-17 05:50:29,820 - root - INFO - Evaluating sample 32/240
2025-09-17 05:50:32,299 - root - INFO - Evaluating sample 33/240
2025-09-17 05:50:34,781 - root - INFO - Evaluating sample 34/240
2025-09-17 05:50:37,262 - root - INFO - Evaluating sample 35/240
2025-09-17 05:50:39,743 - root - INFO - Evaluating sample 36/240
2025-09-17 05:50:42,232 - root - INFO - Evaluating sample 37/240
2025-09-17 05:50:44,718 - root - INFO - Evaluating sample 38/240
2025-09-17 05:50:47,201 - root - INFO - Evaluating sample 39/240
2025-09-17 05:50:49,693 - root - INFO - Evaluating sample 40/240
2025-09-17 05:50:52,181 - root - INFO - Evaluating sample 41/240
2025-09-17 05:50:54,689 - root - INFO - Evaluating sample 42/240
2025-09-17 05:50:57,179 - root - INFO - Evaluating sample 43/240
2025-09-17 05:50:59,684 - root - INFO - Evaluating sample 44/240
2025-09-17 05:51:02,178 - root - INFO - Evaluating sample 45/240
2025-09-17 05:51:04,673 - root - INFO - Evaluating sample 46/240
2025-09-17 05:51:07,161 - root - INFO - Evaluating sample 47/240
2025-09-17 05:51:09,658 - root - INFO - Evaluating sample 48/240
2025-09-17 05:51:12,154 - root - INFO - Evaluating sample 49/240
2025-09-17 05:51:14,653 - root - INFO - Evaluating sample 50/240
2025-09-17 05:51:17,151 - root - INFO - Evaluating sample 51/240
2025-09-17 05:51:19,652 - root - INFO - Evaluating sample 52/240
2025-09-17 05:51:22,157 - root - INFO - Evaluating sample 53/240
2025-09-17 05:51:24,658 - root - INFO - Evaluating sample 54/240
2025-09-17 05:51:27,159 - root - INFO - Evaluating sample 55/240
2025-09-17 05:51:29,661 - root - INFO - Evaluating sample 56/240
2025-09-17 05:51:32,175 - root - INFO - Evaluating sample 57/240
2025-09-17 05:51:34,682 - root - INFO - Evaluating sample 58/240
2025-09-17 05:51:37,192 - root - INFO - Evaluating sample 59/240
2025-09-17 05:51:39,700 - root - INFO - Evaluating sample 60/240
2025-09-17 05:51:42,208 - root - INFO - Evaluating sample 61/240
2025-09-17 05:51:44,717 - root - INFO - Evaluating sample 62/240
2025-09-17 05:51:47,233 - root - INFO - Evaluating sample 63/240
2025-09-17 05:51:49,745 - root - INFO - Evaluating sample 64/240
2025-09-17 05:51:52,249 - root - INFO - Evaluating sample 65/240
2025-09-17 05:51:54,764 - root - INFO - Evaluating sample 66/240
2025-09-17 05:51:57,277 - root - INFO - Evaluating sample 67/240
2025-09-17 05:51:59,786 - root - INFO - Evaluating sample 68/240
2025-09-17 05:52:02,307 - root - INFO - Evaluating sample 69/240
2025-09-17 05:52:04,816 - root - INFO - Evaluating sample 70/240
2025-09-17 05:52:07,326 - root - INFO - Evaluating sample 71/240
2025-09-17 05:52:09,842 - root - INFO - Evaluating sample 72/240
2025-09-17 05:52:12,370 - root - INFO - Evaluating sample 73/240
2025-09-17 05:52:14,883 - root - INFO - Evaluating sample 74/240
2025-09-17 05:52:17,403 - root - INFO - Evaluating sample 75/240
2025-09-17 05:52:19,930 - root - INFO - Evaluating sample 76/240
2025-09-17 05:52:22,462 - root - INFO - Evaluating sample 77/240
2025-09-17 05:52:24,983 - root - INFO - Evaluating sample 78/240
2025-09-17 05:52:27,519 - root - INFO - Evaluating sample 79/240
2025-09-17 05:52:30,043 - root - INFO - Evaluating sample 80/240
2025-09-17 05:52:32,575 - root - INFO - Evaluating sample 81/240
2025-09-17 05:52:35,116 - root - INFO - Evaluating sample 82/240
2025-09-17 05:52:37,658 - root - INFO - Evaluating sample 83/240
2025-09-17 05:52:40,192 - root - INFO - Evaluating sample 84/240
2025-09-17 05:52:42,725 - root - INFO - Evaluating sample 85/240
2025-09-17 05:52:45,254 - root - INFO - Evaluating sample 86/240
2025-09-17 05:52:47,793 - root - INFO - Evaluating sample 87/240
2025-09-17 05:52:50,320 - root - INFO - Evaluating sample 88/240
2025-09-17 05:52:52,850 - root - INFO - Evaluating sample 89/240
2025-09-17 05:52:55,391 - root - INFO - Evaluating sample 90/240
2025-09-17 05:52:57,926 - root - INFO - Evaluating sample 91/240
2025-09-17 05:53:00,449 - root - INFO - Evaluating sample 92/240
2025-09-17 05:53:02,989 - root - INFO - Evaluating sample 93/240
2025-09-17 05:53:05,520 - root - INFO - Evaluating sample 94/240
2025-09-17 05:53:08,050 - root - INFO - Evaluating sample 95/240
2025-09-17 05:53:10,574 - root - INFO - Evaluating sample 96/240
2025-09-17 05:53:13,105 - root - INFO - Evaluating sample 97/240
2025-09-17 05:53:15,643 - root - INFO - Evaluating sample 98/240
2025-09-17 05:53:18,183 - root - INFO - Evaluating sample 99/240
2025-09-17 05:53:20,722 - root - INFO - Evaluating sample 100/240
2025-09-17 05:53:23,264 - root - INFO - Evaluating sample 101/240
2025-09-17 05:53:25,803 - root - INFO - Evaluating sample 102/240
2025-09-17 05:53:28,342 - root - INFO - Evaluating sample 103/240
2025-09-17 05:53:30,879 - root - INFO - Evaluating sample 104/240
2025-09-17 05:53:33,418 - root - INFO - Evaluating sample 105/240
2025-09-17 05:53:35,958 - root - INFO - Evaluating sample 106/240
2025-09-17 05:53:38,498 - root - INFO - Evaluating sample 107/240
2025-09-17 05:53:41,036 - root - INFO - Evaluating sample 108/240
2025-09-17 05:53:43,842 - root - INFO - Evaluating sample 109/240
2025-09-17 05:53:46,394 - root - INFO - Evaluating sample 110/240
2025-09-17 05:53:48,936 - root - INFO - Evaluating sample 111/240
2025-09-17 05:53:51,473 - root - INFO - Evaluating sample 112/240
2025-09-17 05:53:54,013 - root - INFO - Evaluating sample 113/240
2025-09-17 05:53:56,552 - root - INFO - Evaluating sample 114/240
2025-09-17 05:53:59,093 - root - INFO - Evaluating sample 115/240
2025-09-17 05:54:01,648 - root - INFO - Evaluating sample 116/240
2025-09-17 05:54:04,189 - root - INFO - Evaluating sample 117/240
2025-09-17 05:54:06,748 - root - INFO - Evaluating sample 118/240
2025-09-17 05:54:09,289 - root - INFO - Evaluating sample 119/240
2025-09-17 05:54:11,855 - root - INFO - Evaluating sample 120/240
2025-09-17 05:54:14,446 - root - INFO - Evaluating sample 121/240
2025-09-17 05:54:16,986 - root - INFO - Evaluating sample 122/240
2025-09-17 05:54:19,524 - root - INFO - Evaluating sample 123/240
2025-09-17 05:54:22,064 - root - INFO - Evaluating sample 124/240
2025-09-17 05:54:24,604 - root - INFO - Evaluating sample 125/240
2025-09-17 05:54:27,146 - root - INFO - Evaluating sample 126/240
2025-09-17 05:54:29,682 - root - INFO - Evaluating sample 127/240
2025-09-17 05:54:32,216 - root - INFO - Evaluating sample 128/240
2025-09-17 05:54:34,760 - root - INFO - Evaluating sample 129/240
2025-09-17 05:54:37,300 - root - INFO - Evaluating sample 130/240
2025-09-17 05:54:39,840 - root - INFO - Evaluating sample 131/240
2025-09-17 05:54:42,379 - root - INFO - Evaluating sample 132/240
2025-09-17 05:54:44,915 - root - INFO - Evaluating sample 133/240
2025-09-17 05:54:47,457 - root - INFO - Evaluating sample 134/240
2025-09-17 05:54:49,996 - root - INFO - Evaluating sample 135/240
2025-09-17 05:54:52,536 - root - INFO - Evaluating sample 136/240
2025-09-17 05:54:55,074 - root - INFO - Evaluating sample 137/240
2025-09-17 05:54:57,610 - root - INFO - Evaluating sample 138/240
2025-09-17 05:55:00,152 - root - INFO - Evaluating sample 139/240
2025-09-17 05:55:02,691 - root - INFO - Evaluating sample 140/240
2025-09-17 05:55:05,230 - root - INFO - Evaluating sample 141/240
2025-09-17 05:55:07,770 - root - INFO - Evaluating sample 142/240
2025-09-17 05:55:10,311 - root - INFO - Evaluating sample 143/240
2025-09-17 05:55:12,849 - root - INFO - Evaluating sample 144/240
2025-09-17 05:55:15,391 - root - INFO - Evaluating sample 145/240
2025-09-17 05:55:17,925 - root - INFO - Evaluating sample 146/240
2025-09-17 05:55:20,467 - root - INFO - Evaluating sample 147/240
2025-09-17 05:55:23,006 - root - INFO - Evaluating sample 148/240
2025-09-17 05:55:25,543 - root - INFO - Evaluating sample 149/240
2025-09-17 05:55:28,082 - root - INFO - Evaluating sample 150/240
2025-09-17 05:55:30,624 - root - INFO - Evaluating sample 151/240
2025-09-17 05:55:33,161 - root - INFO - Evaluating sample 152/240
2025-09-17 05:55:35,700 - root - INFO - Evaluating sample 153/240
2025-09-17 05:55:38,238 - root - INFO - Evaluating sample 154/240
2025-09-17 05:55:40,777 - root - INFO - Evaluating sample 155/240
2025-09-17 05:55:43,317 - root - INFO - Evaluating sample 156/240
2025-09-17 05:55:45,857 - root - INFO - Evaluating sample 157/240
2025-09-17 05:55:48,394 - root - INFO - Evaluating sample 158/240
2025-09-17 05:55:50,933 - root - INFO - Evaluating sample 159/240
2025-09-17 05:55:53,474 - root - INFO - Evaluating sample 160/240
2025-09-17 05:55:56,017 - root - INFO - Evaluating sample 161/240
2025-09-17 05:55:58,552 - root - INFO - Evaluating sample 162/240
2025-09-17 05:56:01,093 - root - INFO - Evaluating sample 163/240
2025-09-17 05:56:03,630 - root - INFO - Evaluating sample 164/240
2025-09-17 05:56:06,170 - root - INFO - Evaluating sample 165/240
2025-09-17 05:56:08,710 - root - INFO - Evaluating sample 166/240
2025-09-17 05:56:11,251 - root - INFO - Evaluating sample 167/240
2025-09-17 05:56:13,773 - root - INFO - Evaluating sample 168/240
2025-09-17 05:56:16,295 - root - INFO - Evaluating sample 169/240
2025-09-17 05:56:18,823 - root - INFO - Evaluating sample 170/240
2025-09-17 05:56:21,364 - root - INFO - Evaluating sample 171/240
2025-09-17 05:56:23,907 - root - INFO - Evaluating sample 172/240
2025-09-17 05:56:26,445 - root - INFO - Evaluating sample 173/240
2025-09-17 05:56:28,983 - root - INFO - Evaluating sample 174/240
2025-09-17 05:56:31,524 - root - INFO - Evaluating sample 175/240
2025-09-17 05:56:34,062 - root - INFO - Evaluating sample 176/240
2025-09-17 05:56:36,600 - root - INFO - Evaluating sample 177/240
2025-09-17 05:56:39,141 - root - INFO - Evaluating sample 178/240
2025-09-17 05:56:41,683 - root - INFO - Evaluating sample 179/240
2025-09-17 05:56:44,217 - root - INFO - Evaluating sample 180/240
2025-09-17 05:56:46,759 - root - INFO - Evaluating sample 181/240
2025-09-17 05:56:49,298 - root - INFO - Evaluating sample 182/240
2025-09-17 05:56:51,839 - root - INFO - Evaluating sample 183/240
2025-09-17 05:56:54,374 - root - INFO - Evaluating sample 184/240
2025-09-17 05:56:56,917 - root - INFO - Evaluating sample 185/240
2025-09-17 05:56:59,454 - root - INFO - Evaluating sample 186/240
2025-09-17 05:57:01,993 - root - INFO - Evaluating sample 187/240
2025-09-17 05:57:04,533 - root - INFO - Evaluating sample 188/240
2025-09-17 05:57:07,072 - root - INFO - Evaluating sample 189/240
2025-09-17 05:57:09,609 - root - INFO - Evaluating sample 190/240
2025-09-17 05:57:12,150 - root - INFO - Evaluating sample 191/240
2025-09-17 05:57:14,690 - root - INFO - Evaluating sample 192/240
2025-09-17 05:57:17,227 - root - INFO - Evaluating sample 193/240
2025-09-17 05:57:19,769 - root - INFO - Evaluating sample 194/240
2025-09-17 05:57:22,310 - root - INFO - Evaluating sample 195/240
2025-09-17 05:57:24,830 - root - INFO - Evaluating sample 196/240
2025-09-17 05:57:27,366 - root - INFO - Evaluating sample 197/240
2025-09-17 05:57:29,904 - root - INFO - Evaluating sample 198/240
2025-09-17 05:57:32,439 - root - INFO - Evaluating sample 199/240
2025-09-17 05:57:34,987 - root - INFO - Evaluating sample 200/240
2025-09-17 05:57:37,519 - root - INFO - Evaluating sample 201/240
2025-09-17 05:57:40,060 - root - INFO - Evaluating sample 202/240
2025-09-17 05:57:42,599 - root - INFO - Evaluating sample 203/240
2025-09-17 05:57:45,139 - root - INFO - Evaluating sample 204/240
2025-09-17 05:57:47,679 - root - INFO - Evaluating sample 205/240
2025-09-17 05:57:50,219 - root - INFO - Evaluating sample 206/240
2025-09-17 05:57:52,755 - root - INFO - Evaluating sample 207/240
2025-09-17 05:57:55,295 - root - INFO - Evaluating sample 208/240
2025-09-17 05:57:57,836 - root - INFO - Evaluating sample 209/240
2025-09-17 05:58:00,375 - root - INFO - Evaluating sample 210/240
2025-09-17 05:58:02,915 - root - INFO - Evaluating sample 211/240
2025-09-17 05:58:05,454 - root - INFO - Evaluating sample 212/240
2025-09-17 05:58:07,992 - root - INFO - Evaluating sample 213/240
2025-09-17 05:58:10,529 - root - INFO - Evaluating sample 214/240
2025-09-17 05:58:13,069 - root - INFO - Evaluating sample 215/240
2025-09-17 05:58:15,612 - root - INFO - Evaluating sample 216/240
2025-09-17 05:58:18,153 - root - INFO - Evaluating sample 217/240
2025-09-17 05:58:20,686 - root - INFO - Evaluating sample 218/240
2025-09-17 05:58:23,226 - root - INFO - Evaluating sample 219/240
2025-09-17 05:58:25,766 - root - INFO - Evaluating sample 220/240
2025-09-17 05:58:28,305 - root - INFO - Evaluating sample 221/240
2025-09-17 05:58:30,847 - root - INFO - Evaluating sample 222/240
2025-09-17 05:58:33,385 - root - INFO - Evaluating sample 223/240
2025-09-17 05:58:35,922 - root - INFO - Evaluating sample 224/240
2025-09-17 05:58:38,464 - root - INFO - Evaluating sample 225/240
2025-09-17 05:58:41,001 - root - INFO - Evaluating sample 226/240
2025-09-17 05:58:43,586 - root - INFO - Evaluating sample 227/240
2025-09-17 05:58:46,390 - root - INFO - Evaluating sample 228/240
2025-09-17 05:58:48,935 - root - INFO - Evaluating sample 229/240
2025-09-17 05:58:51,480 - root - INFO - Evaluating sample 230/240
2025-09-17 05:58:54,015 - root - INFO - Evaluating sample 231/240
2025-09-17 05:58:56,558 - root - INFO - Evaluating sample 232/240
2025-09-17 05:58:59,094 - root - INFO - Evaluating sample 233/240
2025-09-17 05:59:01,636 - root - INFO - Evaluating sample 234/240
2025-09-17 05:59:04,173 - root - INFO - Evaluating sample 235/240
2025-09-17 05:59:06,711 - root - INFO - Evaluating sample 236/240
2025-09-17 05:59:09,252 - root - INFO - Evaluating sample 237/240
2025-09-17 05:59:11,793 - root - INFO - Evaluating sample 238/240
2025-09-17 05:59:14,325 - root - INFO - Evaluating sample 239/240
2025-09-17 05:59:16,908 - root - INFO - Evaluating sample 240/240
2025-09-17 05:59:19,567 - root - INFO - Recomputing diagnostic values from samples
2025-09-17 05:59:20,386 - root - INFO - 
==================================================
2025-09-17 05:59:20,386 - root - INFO - EVALUATION RESULTS
2025-09-17 05:59:20,386 - root - INFO - ==================================================
2025-09-17 05:59:20,386 - root - INFO - Method          Accuracy   NLL        ECE       
2025-09-17 05:59:20,386 - root - INFO - --------------------------------------------------
2025-09-17 05:59:20,386 - root - INFO - MAP-LoRA        0.8676     0.5835     0.1167    
2025-09-17 05:59:20,386 - root - INFO - SAM-SGLD-LoRA   0.8897     0.3366     0.0638    
2025-09-17 05:59:20,386 - root - INFO - 
MCMC Diagnostics:
2025-09-17 05:59:20,386 - root - INFO - R-hat (log posterior): 1.0596
2025-09-17 05:59:20,387 - root - INFO - R-hat (L2 norm): 1.7676
2025-09-17 05:59:20,387 - root - INFO - ESS (log posterior): 10
2025-09-17 05:59:20,387 - root - INFO - ESS (L2 norm): 3
2025-09-17 05:59:20,387 - root - INFO - Min ESS: 3
2025-09-17 05:59:20,387 - root - INFO - 
Multimodal MCMC Quality Assessment:
2025-09-17 05:59:20,387 - root - INFO - R-hat (log posterior): 1.060
2025-09-17 05:59:20,387 - root - INFO - R-hat (L2 norm): 1.768
2025-09-17 05:59:20,387 - root - INFO - Multimodal R-hat (1.1 < R-hat < 3.0): ⚠️  CHECK
2025-09-17 05:59:20,387 - root - INFO - 
Within-mode mixing:
2025-09-17 05:59:20,387 - root - INFO - Avg ESS (log posterior): 21.5 ± 9.0
2025-09-17 05:59:20,387 - root - INFO - Avg ESS (L2 norm): 3.0 ± 0.0
2025-09-17 05:59:20,387 - root - INFO - Within-mode mixing (ESS ≥ 10.0): ⚠️  NEEDS IMPROVEMENT
2025-09-17 05:59:20,387 - root - INFO - 
ESS Statistics Summary:
2025-09-17 05:59:20,387 - root - INFO -   Log Posterior ESS: 10 (min), 21.5 ± 9.0 (mean ± std)
2025-09-17 05:59:20,388 - root - INFO -   L2 Norm ESS: 3 (min), 3.0 ± 0.0 (mean ± std)
2025-09-17 05:59:20,388 - root - INFO - 
ESS Variability Interpretation:
2025-09-17 05:59:20,388 - root - INFO -   • Log posterior ESS is consistent across modes (std=9.0) - uniform mixing quality
2025-09-17 05:59:20,388 - root - INFO -   • L2 norm ESS is consistent across modes (std=0.0) - uniform parameter space mixing
2025-09-17 05:59:20,388 - root - INFO - 
Per-chain ESS details:
2025-09-17 05:59:20,388 - root - INFO -   Chain 1: ESS(log_posterior)=35, ESS(l2_norm)=3
2025-09-17 05:59:20,388 - root - INFO -   Chain 2: ESS(log_posterior)=22, ESS(l2_norm)=3
2025-09-17 05:59:20,388 - root - INFO -   Chain 3: ESS(log_posterior)=10, ESS(l2_norm)=3
2025-09-17 05:59:20,388 - root - INFO -   Chain 4: ESS(log_posterior)=19, ESS(l2_norm)=3
2025-09-17 05:59:20,388 - root - INFO - 
Overall Multimodal Quality: ⚠️  NEEDS IMPROVEMENT
2025-09-17 05:59:20,388 - root - WARNING - R-hat values suggest chains may be in the same mode (not multimodal)
2025-09-17 05:59:20,388 - root - WARNING - Within-mode ESS is low - samples within each mode are too correlated
2025-09-17 05:59:20,388 - root - INFO - 
Multimodal Pass/Fail Criteria Assessment:
2025-09-17 05:59:20,388 - root - INFO -   Multimodal R-hat (1.1 < R-hat < 3.0): ❌ FAIL
2025-09-17 05:59:20,389 - root - INFO -   Within-mode ESS ≥ 10.0: ❌ FAIL
2025-09-17 05:59:20,389 - root - INFO -   Accuracy within ±0.3% of MAP: ❌ FAIL (diff: 0.0221)
2025-09-17 05:59:20,389 - root - INFO -   NLL lower than MAP: ✅ PASS (SAM-SGLD-LoRA: 0.3366, MAP: 0.5835)
2025-09-17 05:59:20,389 - root - INFO -   ECE lower than MAP: ✅ PASS (SAM-SGLD-LoRA: 0.0638, MAP: 0.1167)
2025-09-17 05:59:20,389 - root - INFO - 
Overall Multimodal Convergence Assessment: ⚠️  FAIL
2025-09-17 05:59:20,389 - root - WARNING - Multimodal convergence criteria not met. Consider:
2025-09-17 05:59:20,389 - root - WARNING -   - Chains are in same mode - increase step size or reduce prior strength
2025-09-17 05:59:20,389 - root - WARNING -   - Within-mode mixing is poor - reduce step size or increase sampling steps
2025-09-17 05:59:20,390 - root - WARNING -   - Check if SAM-SGLD-LoRA is learning properly
2025-09-17 05:59:20,395 - root - INFO - 
Results saved to runs/mrpc_roberta_lora_samsgld_rank1/evaluation_results.yaml
Total parameters: 125,829,124
Trainable (LoRA) parameters: 589,824
Frozen (base) parameters: 125,239,300
LoRA ratio: 0.47%
✅ SAM-SGLD LoRA evaluation completed successfully!
=== SAM-SGLD LoRA experiment completed successfully! ===
Results saved to: runs/mrpc_roberta_lora_samsgld_rank1/
Job completed at: Wed Sep 17 05:59:22 CDT 2025
