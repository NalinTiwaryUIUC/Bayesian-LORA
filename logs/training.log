2025-09-07 01:42:22,450 - root - INFO - Using device: cuda
2025-09-07 01:42:25,234 - root - INFO - Starting MAP LoRA training...
2025-09-07 01:43:10,975 - root - INFO - Epoch 1: Train Loss: 0.7402, Val Loss: 0.7333, Val Acc: 0.3162
2025-09-07 01:43:56,522 - root - INFO - Epoch 2: Train Loss: 0.7248, Val Loss: 0.7116, Val Acc: 0.3162
2025-09-07 01:44:43,595 - root - INFO - Epoch 3: Train Loss: 0.6915, Val Loss: 0.6634, Val Acc: 0.6838
2025-09-07 01:45:31,886 - root - INFO - Epoch 4: Train Loss: 0.6503, Val Loss: 0.6296, Val Acc: 0.6838
2025-09-07 01:46:21,131 - root - INFO - Epoch 5: Train Loss: 0.6427, Val Loss: 0.6251, Val Acc: 0.6838
2025-09-07 01:47:11,059 - root - INFO - Epoch 6: Train Loss: 0.6411, Val Loss: 0.6232, Val Acc: 0.6838
2025-09-07 01:48:01,524 - root - INFO - Epoch 7: Train Loss: 0.6398, Val Loss: 0.6238, Val Acc: 0.6838
2025-09-07 01:48:51,850 - root - INFO - Epoch 8: Train Loss: 0.6389, Val Loss: 0.6246, Val Acc: 0.6838
2025-09-07 01:49:42,213 - root - INFO - Epoch 9: Train Loss: 0.6346, Val Loss: 0.6232, Val Acc: 0.6838
2025-09-07 01:50:32,597 - root - INFO - Epoch 10: Train Loss: 0.6388, Val Loss: 0.6220, Val Acc: 0.6838
2025-09-07 01:51:23,022 - root - INFO - Epoch 11: Train Loss: 0.6372, Val Loss: 0.6236, Val Acc: 0.6838
2025-09-07 01:52:13,447 - root - INFO - Epoch 12: Train Loss: 0.6345, Val Loss: 0.6217, Val Acc: 0.6838
2025-09-07 01:53:04,307 - root - INFO - Epoch 13: Train Loss: 0.6359, Val Loss: 0.6226, Val Acc: 0.6838
2025-09-07 01:53:54,771 - root - INFO - Epoch 14: Train Loss: 0.6315, Val Loss: 0.6195, Val Acc: 0.6838
2025-09-07 01:54:45,253 - root - INFO - Epoch 15: Train Loss: 0.6323, Val Loss: 0.6211, Val Acc: 0.6838
2025-09-07 01:55:35,696 - root - INFO - Epoch 16: Train Loss: 0.6310, Val Loss: 0.6201, Val Acc: 0.6838
2025-09-07 01:56:26,138 - root - INFO - Epoch 17: Train Loss: 0.6323, Val Loss: 0.6177, Val Acc: 0.6838
2025-09-07 01:57:16,543 - root - INFO - Epoch 18: Train Loss: 0.6295, Val Loss: 0.6171, Val Acc: 0.6838
2025-09-07 01:58:07,245 - root - INFO - Epoch 19: Train Loss: 0.6315, Val Loss: 0.6175, Val Acc: 0.6838
2025-09-07 01:58:57,550 - root - INFO - Epoch 20: Train Loss: 0.6262, Val Loss: 0.6150, Val Acc: 0.6838
2025-09-07 01:58:58,367 - root - INFO - MAP model saved to runs/mrpc_roberta_lora_sgld/map_model.pth
2025-09-07 01:58:58,486 - root - INFO - Starting SGLD LoRA training...
2025-09-07 01:58:58,486 - root - INFO - Running chain 1/4
2025-09-07 01:58:58,820 - root - INFO - Chain 1: Burn-in phase (8000 steps)
2025-09-07 01:58:59,371 - root - INFO - Burn-in step 0/8000, step_size: 3.20e-03
2025-09-07 02:02:25,400 - root - INFO - Burn-in step 500/8000, step_size: 3.06e-03
2025-09-07 02:05:51,984 - root - INFO - Burn-in step 1000/8000, step_size: 2.94e-03
2025-09-07 02:09:18,197 - root - INFO - Burn-in step 1500/8000, step_size: 2.83e-03
2025-09-07 02:12:44,852 - root - INFO - Burn-in step 2000/8000, step_size: 2.75e-03
2025-09-07 02:16:11,607 - root - INFO - Burn-in step 2500/8000, step_size: 2.67e-03
2025-09-07 02:19:37,995 - root - INFO - Burn-in step 3000/8000, step_size: 2.60e-03
2025-09-07 02:23:04,425 - root - INFO - Burn-in step 3500/8000, step_size: 2.54e-03
2025-09-07 02:26:30,893 - root - INFO - Burn-in step 4000/8000, step_size: 2.48e-03
2025-09-07 02:29:57,356 - root - INFO - Burn-in step 4500/8000, step_size: 2.43e-03
2025-09-07 02:33:23,767 - root - INFO - Burn-in step 5000/8000, step_size: 2.38e-03
2025-09-07 02:36:50,043 - root - INFO - Burn-in step 5500/8000, step_size: 2.34e-03
2025-09-07 02:40:16,301 - root - INFO - Burn-in step 6000/8000, step_size: 2.30e-03
2025-09-07 02:43:41,924 - root - INFO - Burn-in step 6500/8000, step_size: 2.26e-03
2025-09-07 02:47:07,520 - root - INFO - Burn-in step 7000/8000, step_size: 2.23e-03
2025-09-07 02:50:33,212 - root - INFO - Burn-in step 7500/8000, step_size: 2.20e-03
2025-09-07 02:53:58,400 - root - INFO - Chain 1: Sampling phase (3000 steps)
2025-09-07 02:53:59,245 - root - INFO - Sampling step 0/3000, step_size: 2.17e-03
2025-09-07 03:00:54,965 - root - INFO - Sampling step 1000/3000, step_size: 2.17e-03
2025-09-07 03:07:51,264 - root - INFO - Sampling step 2000/3000, step_size: 2.17e-03
2025-09-07 03:14:47,334 - root - INFO - Chain 1: Collected 60 samples
2025-09-07 03:14:47,336 - root - INFO - Chain 1: ESS (log_posterior) = 80
2025-09-07 03:14:47,336 - root - INFO - Chain 1: ESS (l2_norm) = 6
2025-09-07 03:14:47,336 - root - INFO - Chain 1: Min ESS = 6
2025-09-07 03:14:47,490 - root - INFO - Running chain 2/4
2025-09-07 03:14:48,127 - root - INFO - Chain 2: Burn-in phase (8000 steps)
2025-09-07 03:14:48,653 - root - INFO - Burn-in step 0/8000, step_size: 3.20e-03
2025-09-07 03:18:15,063 - root - INFO - Burn-in step 500/8000, step_size: 3.06e-03
2025-09-07 03:21:41,463 - root - INFO - Burn-in step 1000/8000, step_size: 2.94e-03
2025-09-07 03:25:07,958 - root - INFO - Burn-in step 1500/8000, step_size: 2.83e-03
2025-09-07 03:28:34,216 - root - INFO - Burn-in step 2000/8000, step_size: 2.75e-03
2025-09-07 03:32:01,029 - root - INFO - Burn-in step 2500/8000, step_size: 2.67e-03
2025-09-07 03:35:27,286 - root - INFO - Burn-in step 3000/8000, step_size: 2.60e-03
2025-09-07 03:38:52,815 - root - INFO - Burn-in step 3500/8000, step_size: 2.54e-03
2025-09-07 03:42:18,710 - root - INFO - Burn-in step 4000/8000, step_size: 2.48e-03
2025-09-07 03:45:44,427 - root - INFO - Burn-in step 4500/8000, step_size: 2.43e-03
2025-09-07 03:49:10,643 - root - INFO - Burn-in step 5000/8000, step_size: 2.38e-03
2025-09-07 03:52:36,718 - root - INFO - Burn-in step 5500/8000, step_size: 2.34e-03
2025-09-07 03:56:03,416 - root - INFO - Burn-in step 6000/8000, step_size: 2.30e-03
2025-09-07 03:59:30,016 - root - INFO - Burn-in step 6500/8000, step_size: 2.26e-03
2025-09-07 04:02:56,405 - root - INFO - Burn-in step 7000/8000, step_size: 2.23e-03
2025-09-07 04:06:22,948 - root - INFO - Burn-in step 7500/8000, step_size: 2.20e-03
2025-09-07 04:09:48,652 - root - INFO - Chain 2: Sampling phase (3000 steps)
2025-09-07 04:09:49,494 - root - INFO - Sampling step 0/3000, step_size: 2.17e-03
2025-09-07 04:16:45,461 - root - INFO - Sampling step 1000/3000, step_size: 2.17e-03
2025-09-07 04:23:40,419 - root - INFO - Sampling step 2000/3000, step_size: 2.17e-03
2025-09-07 04:30:35,268 - root - INFO - Chain 2: Collected 60 samples
2025-09-07 04:30:35,270 - root - INFO - Chain 2: ESS (log_posterior) = 59
2025-09-07 04:30:35,270 - root - INFO - Chain 2: ESS (l2_norm) = 7
2025-09-07 04:30:35,270 - root - INFO - Chain 2: Min ESS = 7
2025-09-07 04:30:35,423 - root - INFO - Running chain 3/4
2025-09-07 04:30:36,034 - root - INFO - Chain 3: Burn-in phase (8000 steps)
2025-09-07 04:30:36,557 - root - INFO - Burn-in step 0/8000, step_size: 3.20e-03
2025-09-07 04:34:02,458 - root - INFO - Burn-in step 500/8000, step_size: 3.06e-03
2025-09-07 04:37:28,743 - root - INFO - Burn-in step 1000/8000, step_size: 2.94e-03
2025-09-07 04:40:54,908 - root - INFO - Burn-in step 1500/8000, step_size: 2.83e-03
2025-09-07 04:44:21,462 - root - INFO - Burn-in step 2000/8000, step_size: 2.75e-03
2025-09-07 04:47:47,995 - root - INFO - Burn-in step 2500/8000, step_size: 2.67e-03
2025-09-07 04:51:14,655 - root - INFO - Burn-in step 3000/8000, step_size: 2.60e-03
2025-09-07 04:54:40,914 - root - INFO - Burn-in step 3500/8000, step_size: 2.54e-03
2025-09-07 04:58:07,509 - root - INFO - Burn-in step 4000/8000, step_size: 2.48e-03
2025-09-07 05:01:33,679 - root - INFO - Burn-in step 4500/8000, step_size: 2.43e-03
2025-09-07 05:04:59,682 - root - INFO - Burn-in step 5000/8000, step_size: 2.38e-03
2025-09-07 05:08:25,871 - root - INFO - Burn-in step 5500/8000, step_size: 2.34e-03
2025-09-07 05:11:51,746 - root - INFO - Burn-in step 6000/8000, step_size: 2.30e-03
2025-09-07 05:15:17,306 - root - INFO - Burn-in step 6500/8000, step_size: 2.26e-03
2025-09-07 05:18:43,029 - root - INFO - Burn-in step 7000/8000, step_size: 2.23e-03
2025-09-07 05:22:09,025 - root - INFO - Burn-in step 7500/8000, step_size: 2.20e-03
2025-09-07 05:25:34,041 - root - INFO - Chain 3: Sampling phase (3000 steps)
2025-09-07 05:25:34,874 - root - INFO - Sampling step 0/3000, step_size: 2.17e-03
2025-09-07 05:32:31,032 - root - INFO - Sampling step 1000/3000, step_size: 2.17e-03
2025-09-07 05:39:28,115 - root - INFO - Sampling step 2000/3000, step_size: 2.17e-03
2025-09-07 05:46:24,104 - root - INFO - Chain 3: Collected 60 samples
2025-09-07 05:46:24,106 - root - INFO - Chain 3: ESS (log_posterior) = 223
2025-09-07 05:46:24,106 - root - INFO - Chain 3: ESS (l2_norm) = 6
2025-09-07 05:46:24,106 - root - INFO - Chain 3: Min ESS = 6
2025-09-07 05:46:24,257 - root - INFO - Running chain 4/4
2025-09-07 05:46:24,868 - root - INFO - Chain 4: Burn-in phase (8000 steps)
2025-09-07 05:46:25,392 - root - INFO - Burn-in step 0/8000, step_size: 3.20e-03
2025-09-07 05:49:51,482 - root - INFO - Burn-in step 500/8000, step_size: 3.06e-03
2025-09-07 05:53:17,876 - root - INFO - Burn-in step 1000/8000, step_size: 2.94e-03
2025-09-07 05:56:44,342 - root - INFO - Burn-in step 1500/8000, step_size: 2.83e-03
2025-09-07 06:00:10,890 - root - INFO - Burn-in step 2000/8000, step_size: 2.75e-03
2025-09-07 06:03:37,112 - root - INFO - Burn-in step 2500/8000, step_size: 2.67e-03
2025-09-07 06:07:02,766 - root - INFO - Burn-in step 3000/8000, step_size: 2.60e-03
2025-09-07 06:10:28,609 - root - INFO - Burn-in step 3500/8000, step_size: 2.54e-03
2025-09-07 06:13:54,603 - root - INFO - Burn-in step 4000/8000, step_size: 2.48e-03
2025-09-07 06:17:20,340 - root - INFO - Burn-in step 4500/8000, step_size: 2.43e-03
2025-09-07 06:20:46,164 - root - INFO - Burn-in step 5000/8000, step_size: 2.38e-03
2025-09-07 06:24:12,477 - root - INFO - Burn-in step 5500/8000, step_size: 2.34e-03
2025-09-07 06:27:39,125 - root - INFO - Burn-in step 6000/8000, step_size: 2.30e-03
2025-09-07 06:31:05,637 - root - INFO - Burn-in step 6500/8000, step_size: 2.26e-03
2025-09-07 06:34:32,035 - root - INFO - Burn-in step 7000/8000, step_size: 2.23e-03
2025-09-07 06:37:58,440 - root - INFO - Burn-in step 7500/8000, step_size: 2.20e-03
2025-09-07 06:41:24,282 - root - INFO - Chain 4: Sampling phase (3000 steps)
2025-09-07 06:41:25,128 - root - INFO - Sampling step 0/3000, step_size: 2.17e-03
2025-09-07 06:48:21,686 - root - INFO - Sampling step 1000/3000, step_size: 2.17e-03
2025-09-07 06:55:17,964 - root - INFO - Sampling step 2000/3000, step_size: 2.17e-03
2025-09-07 07:02:12,503 - root - INFO - Chain 4: Collected 60 samples
2025-09-07 07:02:12,505 - root - INFO - Chain 4: ESS (log_posterior) = 233
2025-09-07 07:02:12,505 - root - INFO - Chain 4: ESS (l2_norm) = 7
2025-09-07 07:02:12,505 - root - INFO - Chain 4: Min ESS = 7
2025-09-07 07:02:12,655 - root - INFO - Total samples collected: 240
2025-09-07 07:02:12,655 - root - INFO - Computing overall MCMC diagnostics...
2025-09-07 07:02:12,655 - root - INFO - SGLD sampling completed with 240 total samples
2025-09-07 07:02:12,655 - root - INFO - ESS and R-hat will be computed during evaluation phase
2025-09-07 07:02:16,110 - root - INFO - SGLD samples saved to runs/mrpc_roberta_lora_sgld/sgld_samples.pth
2025-09-07 07:02:16,110 - root - INFO - Training completed successfully!
